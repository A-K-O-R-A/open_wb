var Ma=Object.defineProperty;var Ca=(t,e,a)=>e in t?Ma(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var p=(t,e,a)=>(Ca(t,typeof e!="symbol"?e+"":e,a),a);import{m as Jt,r as H,a as le,c as f,s as fe,d as I,p as Qt,b as Yt,w as Ia,o as i,e as h,t as $,f as n,n as z,g as B,h as w,i as ae,j as v,k as j,u as d,l as m,F as W,q as F,v as Ve,x as mt,y as Zt,z as ft,A as Mt,B as rt,C as We,D as Wt,E as Ba,G as lt,H as Va,I as R,J as Ta,K as ze,L as K,M as ee,N as La,O as Le,P as Xt,Q as _t,R as Oa,S as Aa,T as Qe,U as Da,V as Wa,W as Ea,X as Ga}from"./vendor-73164592.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function a(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=a(o);fetch(o.href,r)}})();const ja=0,Kt={host:location.hostname,port:location.protocol=="https:"?443:80,endpoint:"/ws",protocol:location.protocol=="https:"?"wss":"ws",connectTimeout:4e3,reconnectPeriod:4e3,clientId:Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,6)},it={topic:"",qos:ja};let Se;const{host:Ua,port:za,endpoint:Na,...ea}=Kt,qa=`${ea.protocol}://${Ua}:${za}${Na}`;try{Se=Jt.connect(qa,ea),Se.on("connect",()=>{console.info("MQTT connection successful")}),Se.on("error",t=>{console.error("MQTT connection failed: ",t)})}catch(t){console.error("MQTT connect error: ",t)}function Fa(t){Se?Se.on("message",t):console.error("MqttRegister: MQTT client not available")}function Ce(t){it.topic=t;const{topic:e,qos:a}=it;Se.subscribe(e,{qos:a},s=>{if(s){console.error("MQTT Subscription error: "+s);return}})}function Ee(t){it.topic=t;const{topic:e}=it;Se.unsubscribe(e,a=>{if(a){console.error("MQTT Unsubscribe from "+t+" failed: "+a);return}})}function ct(t,e){Se.publish(t,e,{qos:0},s=>{s&&console.warn("MQTT publish error: ",s),console.info("Message sent: ["+t+"]("+e+")")})}function Ra(){return Kt.clientId}class Ha{constructor(e){p(this,"id");p(this,"name","Ladepunkt");p(this,"icon","Ladepunkt");p(this,"type","");p(this,"ev",0);p(this,"template",0);p(this,"connectedPhases",0);p(this,"phase_1",0);p(this,"autoPhaseSwitchHw",!1);p(this,"controlPilotInterruptionHw",!1);p(this,"isEnabled",!0);p(this,"isPluggedIn",!1);p(this,"isCharging",!1);p(this,"_isLocked",!1);p(this,"_connectedVehicle",0);p(this,"chargeTemplate",0);p(this,"evTemplate",0);p(this,"_chargeMode","pv_charging");p(this,"_hasPriority",!1);p(this,"currentPlan","");p(this,"averageConsumption",0);p(this,"vehicleName","");p(this,"rangeCharged",0);p(this,"rangeUnit","");p(this,"counter",0);p(this,"dailyYield",0);p(this,"energyPv",0);p(this,"energyBat",0);p(this,"pvPercentage",0);p(this,"faultState",0);p(this,"faultStr","");p(this,"phasesInUse",0);p(this,"power",0);p(this,"chargedSincePlugged",0);p(this,"stateStr","");p(this,"current",0);p(this,"phasesToUse",0);p(this,"soc",0);p(this,"isSocConfigured",!0);p(this,"isSocManual",!1);p(this,"color","white");p(this,"_scheduledCharging",!1);p(this,"_instantChargeLimitMode","");p(this,"_instantTargetCurrent",0);p(this,"_instantTargetSoc",0);p(this,"_instantMaxEnergy",0);p(this,"_pvFeedInLimit",!1);p(this,"_pvMinCurrent",0);p(this,"_pvMaxSoc",0);p(this,"_pvMinSoc",0);p(this,"_pvMinSocCurrent",0);this.id=e}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked=e,Z("cpLock",e,this.id)}updateIsLocked(e){this._isLocked=e}get connectedVehicle(){return this._connectedVehicle}set connectedVehicle(e){this._connectedVehicle=e,Z("cpVehicle",e,this.id)}updateConnectedVehicle(e){this._connectedVehicle=e}get chargeMode(){return this._chargeMode}set chargeMode(e){this._chargeMode=e,Z("chargeMode",e,this.id)}updateChargeMode(e){this._chargeMode=e}get hasPriority(){return this._hasPriority}set hasPriority(e){this._hasPriority=e,Z("cpPriority",e,this.id)}updateCpPriority(e){this._hasPriority=e}get scheduledCharging(){return this._scheduledCharging}set scheduledCharging(e){this._scheduledCharging=e,Z("cpScheduledCharging",e,this.id)}updateScheduledCharging(e){this._scheduledCharging=e}get instantTargetCurrent(){return this._instantTargetCurrent}set instantTargetCurrent(e){this._instantTargetCurrent=e,Z("cpInstantTargetCurrent",e,this.id)}updateInstantTargetCurrent(e){this._instantTargetCurrent=e}get instantChargeLimitMode(){return this._instantChargeLimitMode}set instantChargeLimitMode(e){this._instantChargeLimitMode=e,Z("cpInstantChargeLimitMode",e,this.id)}updateInstantChargeLimitMode(e){this._instantChargeLimitMode=e}get instantTargetSoc(){return this._instantTargetSoc}set instantTargetSoc(e){this._instantTargetSoc=e,Z("cpInstantTargetSoc",e,this.id)}updateInstantTargetSoc(e){this._instantTargetSoc=e}get instantMaxEnergy(){return this._instantMaxEnergy}set instantMaxEnergy(e){this._instantMaxEnergy=e,Z("cpInstantMaxEnergy",e,this.id)}updateInstantMaxEnergy(e){this._instantMaxEnergy=e}get pvFeedInLimit(){return this._pvFeedInLimit}set pvFeedInLimit(e){this._pvFeedInLimit=e,Z("cpPvFeedInLimit",e,this.id)}updatePvFeedInLimit(e){this._pvFeedInLimit=e}get pvMinCurrent(){return this._pvMinCurrent}set pvMinCurrent(e){this._pvMinCurrent=e,Z("cpPvMinCurrent",e,this.id)}updatePvMinCurrent(e){this._pvMinCurrent=e}get pvMaxSoc(){return this._pvMaxSoc}set pvMaxSoc(e){this._pvMaxSoc=e,Z("cpPvMaxSoc",e,this.id)}updatePvMaxSoc(e){this._pvMaxSoc=e}get pvMinSoc(){return this._pvMinSoc}set pvMinSoc(e){this._pvMinSoc=e,Z("cpPvMinSoc",e,this.id)}updatePvMinSoc(e){this._pvMinSoc=e}get pvMinSocCurrent(){return this._pvMinSocCurrent}set pvMinSocCurrent(e){this._pvMinSocCurrent=e,Z("cpPvMinSocCurrent",e,this.id)}updatePvMinSocCurrent(e){this._pvMinSocCurrent=e}toPowerItem(){return{name:this.name,power:this.power,energy:this.dailyYield,energyPv:this.energyPv,energyBat:this.energyBat,pvPercentage:this.pvPercentage,color:this.color,icon:this.icon}}}class Ja{constructor(e){p(this,"id");p(this,"name","");p(this,"_chargeTemplateId",0);p(this,"_evTemplateId",0);p(this,"tags",[]);p(this,"soc",0);p(this,"range",0);this.id=e}get chargeTemplateId(){return this._chargeTemplateId}set chargeTemplateId(e){this._chargeTemplateId=e,Z("vhChargeTemplateId",e,this.id)}updateChargeTemplateId(e){this._chargeTemplateId=e}get evTemplateId(){return this._evTemplateId}set evTemplateId(e){this._evTemplateId=e,Z("vhEvTemplateId",e,this.id)}updateEvTemplateId(e){this._evTemplateId=e}}var de=(t=>(t.instant_charging="instant_charging",t.pv_charging="pv_charging",t.scheduled_charging="scheduled_charging",t.standby="standby",t.stop="stop",t))(de||{});function ta(){return{frequency:{once:[new Date("2022-02-02"),new Date("2022-02-22")],selected:"daily",weekly:[!1,!1,!1,!1,!1,!1,!1]},name:"Neuer Plan",time:["10:00","16:00"],current:16}}function aa(){return{name:"Neuer Plan",timed:!1,time:"12:00",soc:80,frequency:{once:[new Date("2022-02-02"),new Date("2022-02-22")],selected:"daily",weekly:[!1,!1,!1,!1,!1,!1,!1]}}}const T=H({}),X=H({}),ue=H({}),xt=H({});function Qa(t){t in T||(T[t]=new Ha(t),T[t].color="var(--color-cp"+Object.values(T).length+")")}function Ya(){Object.keys(T).forEach(t=>{delete T[parseInt(t)]})}const Za={cpLock:"openWB/set/chargepoint/%/set/manual_lock",chargeMode:"openWB/set/vehicle/template/charge_template/%/chargemode/selected",cpPriority:"openWB/set/vehicle/template/charge_template/%/prio",cpScheduledCharging:"openWB/set/vehicle/template/charge_template/%/time_charging/active",pvBatteryPriority:"openWB/set/general/chargemode_config/pv_charging/bat_prio",chargeTemplate:"openWB/set/vehicle/template/charge_template/%",cpVehicle:"openWB/set/chargepoint/%/config/ev",cpInstantChargeLimitMode:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/selected",cpInstantTargetCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/current",cpInstantTargetSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/soc",cpInstantMaxEnergy:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/amount",cpPvFeedInLimit:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/feed_in_limit",cpPvMinCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_current",cpPvMaxSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/max_soc",cpPvMinSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_soc",cpPvMinSocCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_soc_current",etMaxPrice:"openWB/set/optional/et/max_price",vhChargeTemplateId:"openWB/set/vehicle/%/charge_template",vhEvTemplateId:"openWB/set/vehicle/%/ev_template",shSetManual:"openWB/set/LegacySmartHome/config/set/Devices/%/mode",shSwitchOn:"openWB/set/LegacySmartHome/config/set/Devices/%/device_manual_control"};function Z(t,e,a=0){if(isNaN(a)){console.warn("Invalid index");return}let s=Za[t];if(!s){console.warn("No topic for update type "+t);return}switch(t){case"chargeMode":case"cpPriority":case"cpScheduledCharging":case"cpInstantTargetCurrent":case"cpInstantChargeLimitMode":case"cpInstantTargetSoc":case"cpInstantMaxEnergy":case"cpPvFeedInLimit":case"cpPvMinCurrent":case"cpPvMaxSoc":case"cpPvMinSoc":case"cpPvMinSocCurrent":s=s.replace("%",T[a].chargeTemplate.toString());break;default:s=s.replace("%",String(a))}switch(typeof e){case"number":ct(s,JSON.stringify(+e));break;default:ct(s,JSON.stringify(e))}}function na(t){const e=ue[t];if(e){const a="openWB/set/vehicle/template/charge_template/"+t;ct(a,JSON.stringify(e))}}function Ct(t){ct("openWB/set/command/"+Ra()+"/todo",JSON.stringify(t))}let Xa=class{constructor(e){p(this,"id");p(this,"name","");p(this,"power",0);p(this,"energy",0);p(this,"energyPv",0);p(this,"energyBat",0);p(this,"pvPercentage",0);p(this,"configured",!0);p(this,"showInGraph",!0);p(this,"color","white");p(this,"icon","");p(this,"countAsHouse",!1);this.id=e}};class Ka{constructor(){p(this,"batterySoc",0);p(this,"isBatteryConfigured",!0);p(this,"chargeMode","0");p(this,"_pvBatteryPriority",!1);p(this,"displayLiveGraph",!0);p(this,"isEtEnabled",!0);p(this,"etMaxPrice",0);p(this,"etCurrentPrice",0);p(this,"cpDailyExported",0);p(this,"evuId",0);p(this,"etProvider","")}get pvBatteryPriority(){return this._pvBatteryPriority}set pvBatteryPriority(e){this._pvBatteryPriority=e,Z("pvBatteryPriority",e)}updatePvBatteryPriority(e){this._pvBatteryPriority=e}}const Ge=H({evuIn:{name:"Netz",color:"var(--color-evu)",icon:""},pv:{name:"PV",color:"var(--color-pv",icon:""},batOut:{name:"Bat >",color:"var(--color-battery)",icon:""},evuOut:{name:"Export",color:"var(--color-export)",icon:""},charging:{name:"Laden",color:"var(--color-charging)",icon:""},devices:{name:"Geräte",color:"var(--color-devices)",icon:""},batIn:{name:"> Bat",color:"var(--color-battery)",icon:""},house:{name:"Haus",color:"var(--color-house)",icon:""}}),k=H({evuIn:ce("evuIn"),pv:ce("pv"),batOut:ce("batOut"),evuOut:ce("evuOut"),charging:ce("charging"),devices:ce("devices"),batIn:ce("batIn"),house:ce("house")}),N=H({evuIn:ce("evuIn"),pv:ce("pv"),batOut:ce("batOut")}),A=H({evuOut:ce("evuOut"),charging:ce("charging"),devices:ce("devices"),batIn:ce("batIn"),house:ce("house")}),Ye=H([]),re=H(new Ka);le("");Array.from({length:9},(t,e)=>Ye[e]=new Xa(e));Object.values(Ye).forEach(t=>{t.color="var(--color-sh"+(t.id+1)+")"});function ce(t){return{name:Ge[t].name,power:0,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:Ge[t].color,icon:Ge[t].icon}}class en{constructor(){p(this,"etPriceList","");p(this,"_etMaxPrice",20);p(this,"etCurrentPrice",0);p(this,"isEtEnabled",!1);p(this,"etProvider","")}get etMaxPrice(){return this._etMaxPrice}set etMaxPrice(e){this._etMaxPrice=e,Z("etMaxPrice",e)}updateEtMaxPrice(e){this._etMaxPrice=e}}const De=H(new en);class tn{constructor(e){p(this,"id");p(this,"name","Gerät");p(this,"power",0);p(this,"status","off");p(this,"energy",0);p(this,"runningTime",0);p(this,"configured",!1);p(this,"_showInGraph",!0);p(this,"color","white");p(this,"canSwitch",!1);p(this,"countAsHouse",!1);p(this,"energyPv",0);p(this,"energyBat",0);p(this,"pvPercentage",0);p(this,"tempConfigured",0);p(this,"temp",[300,300,300]);p(this,"on",!1);p(this,"isAutomatic",!0);p(this,"icon","");this.id=e}get showInGraph(){return this._showInGraph}set showInGraph(e){this._showInGraph=e,he()}}const q=H({});function It(t){t in q?console.info("Duplicate sh device message: "+t):(q[t]=new tn(t),q[t].color="var(--color-sh"+Object.values(q).length+")")}class an{constructor(){p(this,"_showRelativeArcs",!1);p(this,"showTodayGraph",!0);p(this,"_graphPreference","today");p(this,"_usageStackOrder",0);p(this,"_displayMode","dark");p(this,"_showGrid",!1);p(this,"_smartHomeColors","normal");p(this,"_decimalPlaces",1);p(this,"_showQuickAccess",!0);p(this,"_simpleCpList",!1);p(this,"_showAnimations",!0);p(this,"_preferWideBoxes",!1);p(this,"_maxPower",4e3);p(this,"isEtEnabled",!1);p(this,"etPrice",20.5);p(this,"showRightButton",!0);p(this,"showLeftButton",!0);p(this,"animationDuration",300);p(this,"animationDelay",100)}get showRelativeArcs(){return this._showRelativeArcs}set showRelativeArcs(e){this._showRelativeArcs=e,he()}setShowRelativeArcs(e){this._showRelativeArcs=e}get graphPreference(){return this._graphPreference}set graphPreference(e){this._graphPreference=e,he()}setGraphPreference(e){this._graphPreference=e}get usageStackOrder(){return this._usageStackOrder}set usageStackOrder(e){this._usageStackOrder=e,he()}setUsageStackOrder(e){this._usageStackOrder=e}get displayMode(){return this._displayMode}set displayMode(e){this._displayMode=e,sn(e)}setDisplayMode(e){this._displayMode=e}get showGrid(){return this._showGrid}set showGrid(e){this._showGrid=e,he()}setShowGrid(e){this._showGrid=e}get decimalPlaces(){return this._decimalPlaces}set decimalPlaces(e){this._decimalPlaces=e,he()}setDecimalPlaces(e){this._decimalPlaces=e}get smartHomeColors(){return this._smartHomeColors}set smartHomeColors(e){this._smartHomeColors=e,Et(e),he()}setSmartHomeColors(e){this._smartHomeColors=e,Et(e)}get showQuickAccess(){return this._showQuickAccess}set showQuickAccess(e){this._showQuickAccess=e,he()}setShowQuickAccess(e){this._showQuickAccess=e}get simpleCpList(){return this._simpleCpList}set simpleCpList(e){this._simpleCpList=e,he()}setSimpleCpList(e){this._simpleCpList=e}get showAnimations(){return this._showAnimations}set showAnimations(e){this._showAnimations=e,he()}setShowAnimations(e){this._showAnimations=e}get preferWideBoxes(){return this._preferWideBoxes}set preferWideBoxes(e){this._preferWideBoxes=e,he()}setPreferWideBoxes(e){this._preferWideBoxes=e}get maxPower(){return this._maxPower}set maxPower(e){this._maxPower=e,he()}setMaxPower(e){this._maxPower=e}}const _=H(new an);function oa(){ln();const t=fe("html");t.classed("theme-dark",_.displayMode=="dark"),t.classed("theme-light",_.displayMode=="light"),t.classed("theme-blue",_.displayMode=="blue"),t.classed("shcolors-standard",_.smartHomeColors=="standard"),t.classed("shcolors-advanced",_.smartHomeColors=="advanced"),t.classed("shcolors-normal",_.smartHomeColors=="normal")}const nn=992,dt=H({x:document.documentElement.clientWidth,y:document.documentElement.clientHeight});function on(){dt.x=document.documentElement.clientWidth,dt.y=document.documentElement.clientHeight,oa()}const Ie=f(()=>dt.x>=nn),se={stop:{mode:de.stop,name:"Stop",color:"var(--color-fg)",icon:"fa-power-off"},standby:{mode:de.standby,name:"Standby",color:"var(--color-axis",icon:"fa-pause"},pv_charging:{mode:de.pv_charging,name:"PV",color:"var(--color-pv",icon:"fa-solar-panel"},scheduled_charging:{mode:de.scheduled_charging,name:"Zielladen",color:"var(--color-battery)",icon:"fa-bullseye"},instant_charging:{mode:de.instant_charging,name:"Sofort",color:"var(--color-charging)",icon:"fa-bolt"}};function he(){rn()}function sn(t){const e=fe("html");e.classed("theme-dark",t=="dark"),e.classed("theme-light",t=="light"),e.classed("theme-blue",t=="blue"),he()}function Et(t){const e=fe("html");e.classed("shcolors-normal",t=="normal"),e.classed("shcolors-standard",t=="standard"),e.classed("shcolors-advanced",t=="advanced")}const $e={chargemode:"Der Lademodus für diesen Ladepunkt",vehicle:"Das Fahrzeug, das an diesem Ladepounkt geladen wird",locked:"Diesen Ladepunkt sperren",priority:"Diesen Ladepunkt auf hohe Priorität setzen",timeplan:"An diesem Ladepunkt nach dem konfigurierten Zeitplan laden",minsoc:"Immer mindestens bis zum eingestellten Ladestand laden. Wenn notwendig mit Netzstrom.",minpv:"Durchgehend mit mindestens dem eingestellten Strom laden. Wenn notwendig mit Netzstrom."};function rn(){const t={};t.hideSH=Object.values(q).filter(e=>!e.showInGraph).map(e=>e.id),t.showLG=_.graphPreference=="live",t.displayM=_.displayMode,t.stackO=_.usageStackOrder,t.showGr=_.showGrid,t.decimalP=_.decimalPlaces,t.smartHomeC=_.smartHomeColors,t.relPM=_.showRelativeArcs,t.maxPow=_.maxPower,t.showQA=_.showQuickAccess,t.simpleCP=_.simpleCpList,t.animation=_.showAnimations,t.wideB=_.preferWideBoxes,document.cookie="openWBColorTheme="+JSON.stringify(t)+"; max-age=16000000"}function ln(){const e=document.cookie.split(";").filter(a=>a.split("=")[0]==="openWBColorTheme");if(e.length>0){const a=JSON.parse(e[0].split("=")[1]);a.decimalP!==void 0&&_.setDecimalPlaces(a.decimalP),a.smartHomeC!==void 0&&_.setSmartHomeColors(a.smartHomeC),a.hideSH!==void 0&&a.hideSH.map(s=>{q[s]==null&&It(s),q[s].showInGraph=!1}),a.showLG!==void 0&&_.setGraphPreference(a.showLG?"live":"today"),a.maxPow!==void 0&&_.setMaxPower(+a.maxPow),a.relPM!==void 0&&_.setShowRelativeArcs(a.relPM),a.displayM!==void 0&&_.setDisplayMode(a.displayM),a.stackO!==void 0&&_.setUsageStackOrder(a.stackO),a.showGr!==void 0&&_.setShowGrid(a.showGr),a.showQA!==void 0&&_.setShowQuickAccess(a.showQA),a.simpleCP!==void 0&&_.setSimpleCpList(a.simpleCP),a.animation!=null&&_.setShowAnimations(a.animation),a.wideB!=null&&_.setPreferWideBoxes(a.wideB)}}const cn=["origin"],dn=I({__name:"PMSourceArc",props:{radius:{},cornerRadius:{},circleGapSize:{},emptyPower:{}},setup(t){const e=t,a=f(()=>{const s=Object.values(N).length;let o={name:"",power:e.emptyPower,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:"var(--color-bg)",icon:""},r=N;r["zz-empty"]=o;const l=Qt().value(g=>g.power).startAngle(-Math.PI/2+e.circleGapSize).endAngle(Math.PI/2-e.circleGapSize).sort(null),c=Yt().innerRadius(e.radius/6*5).outerRadius(e.radius).cornerRadius(e.cornerRadius).padAngle(0),u=fe("g#pmSourceArc");return u.selectAll("*").remove(),u.selectAll("sources").data(l(Object.values(r))).enter().append("path").attr("d",c).attr("fill",g=>g.data.color).attr("stroke",(g,y)=>y==s?g.data.power>0?"var(--color-scale)":"null":g.data.color),"pmSourceArc.vue"});return Ia(()=>{let s=N.pv.power+N.evuIn.power+N.batOut.power;s>_.maxPower&&(_.maxPower=s)}),(s,o)=>(i(),h("g",{id:"pmSourceArc",origin:a.value},null,8,cn))}}),un=["origin"],hn=I({__name:"PMUsageArc",props:{radius:{},cornerRadius:{},circleGapSize:{},emptyPower:{}},setup(t){const e=t,a=f(()=>{let s={name:"",power:e.emptyPower,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:"var(--color-bg)",icon:""};const o=[A.evuOut,A.charging].concat(Object.values(q).filter(g=>g.configured&&!g.countAsHouse).sort((g,y)=>y.power-g.power)).concat([A.batIn,A.house]).concat(s),r=o.length-1,l=Qt().value(g=>g.power).startAngle(Math.PI*1.5-e.circleGapSize).endAngle(Math.PI/2+e.circleGapSize).sort(null),c=Yt().innerRadius(e.radius/6*5).outerRadius(e.radius).cornerRadius(e.cornerRadius),u=fe("g#pmUsageArc");return u.selectAll("*").remove(),u.selectAll("consumers").data(l(o)).enter().append("path").attr("d",c).attr("fill",g=>g.data.color).attr("stroke",(g,y)=>y==r?g.data.power>0?"var(--color-scale)":"null":g.data.color),"pmUsageArc.vue"});return(s,o)=>(i(),h("g",{id:"pmUsageArc",origin:a.value},null,8,un))}});function Be(t,e=1){let a;if(t>=1e3&&e<4){switch(e){case 0:a=Math.round(t/1e3);break;case 1:a=Math.round(t/100)/10;break;case 2:a=Math.round(t/10)/100;break;case 3:a=Math.round(t)/1e3;break;default:a=Math.round(t/100)/10;break}return(a==null?void 0:a.toLocaleString(void 0,{minimumFractionDigits:e}))+" kW"}else return Math.round(t).toLocaleString(void 0)+" W"}function Ze(t,e=1,a=!1){let s;if(t>=1e3&&e<4){switch(e){case 0:s=Math.round(t/1e3);break;case 1:s=(Math.round(t/100)/10).toFixed(1);break;case 2:s=(Math.round(t/10)/100).toFixed(2);break;case 3:s=(Math.round(t)/1e3).toFixed(3);break;default:s=Math.round(t/100)/10;break}return s.toLocaleString(void 0,{minimumFractionDigits:e})+(a?" MWh":" kWh")}else return Math.round(t).toLocaleString(void 0)+(a?" kWh":" Wh")}function pn(t){const e=Math.floor(t/3600),a=(t%3600/60).toFixed(0);return e>0?e+"h "+a+" min":a+" min"}function gn(t,e){return["Jan","Feb","März","April","Mai","Juni","Juli","Aug","Sep","Okt","Nov","Dez"][t]+" "+e}function mn(t){return(Math.round(t*10)/10).toLocaleString(void 0,{minimumFractionDigits:1})+"°"}const Bt=I({__name:"FormatWatt",props:{watt:{}},setup(t){const e=t,a=f(()=>Be(e.watt,_.decimalPlaces));return(s,o)=>$(a.value)}}),fn={key:0,id:"pmLabel"},_n=["x","y","fill","text-anchor"],vn=22,be=I({__name:"PMLabel",props:{x:{},y:{},data:{},props:{},anchor:{},labeltext:{},labelicon:{},labelcolor:{}},setup(t){const e=t,a=f(()=>e.labeltext?e.labeltext:e.props?e.props.icon+" ":e.labelicon?e.labelicon+" ":""),s=f(()=>e.labelcolor?e.labelcolor:e.props?e.props.color:""),o=f(()=>!e.data||e.data.power>0),r=f(()=>e.labeltext?"":"fas");return(l,c)=>o.value?(i(),h("g",fn,[n("text",{x:l.x,y:l.y,fill:s.value,"text-anchor":l.anchor,"font-size":vn,class:"pmLabel"},[n("tspan",{class:z(r.value)},$(a.value),3),n("tspan",null,[l.data!==void 0?(i(),B(Bt,{key:0,watt:l.data.power},null,8,["watt"])):w("",!0)])],8,_n)])):w("",!0)}}),bn={class:"wb-widget p-0 m-0 shadow"},yn={class:"d-flex justify-content-between"},wn={class:"m-4 me-0 mb-0"},kn=n("div",{class:"p-0"},"(title goes here)",-1),$n={class:"p-4 pb-0 ps-0 m-0",style:{"text-align":"right"}},Sn={class:"px-4 pt-4 pb-2 wb-subwidget"},xn={class:"row"},Pn={class:"col"},Mn={class:"container-fluid m-0 p-0"},Cn={key:0},In=n("hr",null,null,-1),Bn={class:"px-4 py-2 wb-subwidget"},Vn={class:"row"},Tn={class:"col"},Ln={class:"container-fluid m-0 p-0"},xe=I({__name:"WBWidget",props:{variableWidth:{type:Boolean},fullWidth:{type:Boolean}},setup(t){const e=t,a=f(()=>e.fullWidth?"col-12":e.variableWidth&&_.preferWideBoxes?"col-lg-6":"col-lg-4");return(s,o)=>(i(),h("div",{class:z(["p-2 m-0 d-flex flex-fill",a.value])},[n("div",bn,[n("div",yn,[n("h3",wn,[ae(s.$slots,"title",{},()=>[kn]),ae(s.$slots,"subtitle")]),n("div",$n,[ae(s.$slots,"buttons")])]),n("div",Sn,[n("div",xn,[n("div",Pn,[n("div",Mn,[ae(s.$slots,"default")])])])]),s.$slots.footer!=null?(i(),h("div",Cn,[In,n("div",Bn,[n("div",Vn,[n("div",Tn,[n("div",Ln,[ae(s.$slots,"footer")])])])])])):w("",!0)])],2))}}),On={id:"powermeter",class:"p-0 m-0"},An=["viewBox"],Dn=["transform"],Wn=["x"],ye=500,Me=20,Gt=1,En=I({__name:"PowerMeter",setup(t){const e=ye,a=Math.PI/40,s=[[4],[4,6],[1,4,6],[0,2,4,6],[0,2,3,5,6]],o=[{x:-85,y:e/2*1/5},{x:0,y:e/2*1/5},{x:85,y:e/2*1/5},{x:-85,y:e/2*2/5},{x:0,y:e/2*2/5},{x:85,y:e/2*2/5},{x:0,y:e/2*3/5}],r=f(()=>ye/2-Me),l=f(()=>{let x="",U=Object.values(N).filter(Q=>Q.power>0);return U.length==1&&U[0].name=="PV"?x="Aktueller Verbrauch: ":x="Bezug/Verbrauch: ",x+Be(A.house.power+A.charging.power+A.devices.power+A.batIn.power,_.decimalPlaces)}),c=f(()=>{let x=N.pv.power+N.evuIn.power+N.batOut.power;return _.maxPower>x?Be(_.maxPower,_.decimalPlaces):Be(x,_.decimalPlaces)}),u=f(()=>Object.values(T)),g=f(()=>{let x=0;return _.showRelativeArcs&&(x=_.maxPower-(N.pv.power+N.evuIn.power+N.batOut.power)),x<0?0:x}),y=f(()=>[A.evuOut,A.charging,A.devices,A.batIn,A.house].filter(x=>x.power>0)),M=f(()=>s[y.value.length-1]);function C(x){return o[M.value[x]]}function S(x){return u.value[x].soc}function P(x){return x.length>12?x.slice(0,12-1)+".":x}return(x,U)=>(i(),B(xe,{"full-width":!0},{title:v(()=>[j(" Aktuelle Leistung ")]),default:v(()=>[n("figure",On,[(i(),h("svg",{viewBox:"0 0 "+ye+" "+d(e)},[n("g",{transform:"translate("+ye/2+","+d(e)/2+")"},[m(dn,{radius:r.value,"corner-radius":Gt,"circle-gap-size":a,"empty-power":g.value},null,8,["radius","empty-power"]),m(hn,{"sh-device":d(Ye),radius:r.value,"corner-radius":Gt,"circle-gap-size":a,"empty-power":g.value},null,8,["sh-device","radius","empty-power"]),m(be,{x:0,y:-d(e)/10*2,data:d(N).pv,props:d(Ge).pv,anchor:"middle",config:d(_)},null,8,["y","data","props","config"]),m(be,{x:0,y:-d(e)/10*3,data:d(N).evuIn,props:d(Ge).evuIn,anchor:"middle",config:d(_)},null,8,["y","data","props","config"]),m(be,{x:0,y:-d(e)/10,data:d(N).batOut,props:d(Ge).batOut,anchor:"middle",config:d(_)},null,8,["y","data","props","config"]),(i(!0),h(W,null,F(y.value,(Q,Y)=>(i(),B(be,{key:Y,x:C(Y).x,y:C(Y).y,data:Q,labelicon:Q.icon,labelcolor:Q.color,anchor:"middle",config:d(_)},null,8,["x","y","data","labelicon","labelcolor","config"]))),128)),u.value.length>0&&u.value[0].isSocConfigured?(i(),B(be,{key:0,x:-ye/2-Me/4+10,y:-d(e)/2+Me+5,labeltext:P(u.value[0].vehicleName)+": "+S(0)+"%",labelcolor:u.value[0].color,anchor:"start",config:d(_)},null,8,["x","y","labeltext","labelcolor","config"])):w("",!0),u.value.length>1&&u.value[1].isSocConfigured?(i(),B(be,{key:1,x:ye/2+Me/4-10,y:-d(e)/2+Me+5,labeltext:P(u.value[1].vehicleName)+": "+S(1)+"%",labelcolor:u.value[1].color,anchor:"end",config:d(_)},null,8,["x","y","labeltext","labelcolor","config"])):w("",!0),d(re).batterySoc>0?(i(),B(be,{key:2,x:-ye/2-Me/4+10,y:d(e)/2-Me+15,labeltext:"Speicher: "+d(re).batterySoc+"%",labelcolor:d(A).batIn.color,anchor:"start",config:d(_)},null,8,["x","y","labeltext","labelcolor","config"])):w("",!0),m(be,{x:0,y:0,labeltext:l.value,labelcolor:"var(--color-fg)",anchor:"middle",config:d(_)},null,8,["labeltext","config"]),d(_).showRelativeArcs?(i(),h("text",{key:3,x:ye/2-44,y:"2","text-anchor":"middle",fill:"var(--color-axis)","font-size":"12"}," Peak: "+$(c.value),9,Wn)):w("",!0)],8,Dn)],8,An))])]),_:1}))}});class Gn{constructor(){p(this,"data",[]);p(this,"_graphMode","")}get graphMode(){return this._graphMode}set graphMode(e){this._graphMode=e}}const b=H(new Gn);let ut=!0,Xe=!0;function jt(){ut=!1}function Ut(){Xe=!1}function jn(t){Xe=t}function at(t){b.data=t}const te=H({refreshTopicPrefix:"openWB/graph/alllivevaluesJson",updateTopic:"openWB/graph/lastlivevaluesJson",configTopic:"openWB/graph/config/#",initialized:!1,initCounter:0,graphRefreshCounter:0,rawDataPacks:[],duration:0,activate(){b.data=[],this.unsubscribeUpdates(),this.subscribeRefresh(),Ce(this.configTopic),this.initialized=!1,this.initCounter=0,this.graphRefreshCounter=0,this.rawDataPacks=[]},deactivate(){this.unsubscribeRefresh(),this.unsubscribeUpdates(),Ee(this.configTopic)},subscribeRefresh(){for(let t=1;t<17;t++)Ce(this.refreshTopicPrefix+t)},unsubscribeRefresh(){for(let t=1;t<17;t++)Ee(this.refreshTopicPrefix+t)},subscribeUpdates(){Ce(this.updateTopic)},unsubscribeUpdates(){Ee(this.updateTopic)}}),J=H({topic:"openWB/log/daily/#",date:new Date,activate(){const t=this.date.getFullYear().toString()+(this.date.getMonth()+1).toString().padStart(2,"0")+this.date.getDate().toString().padStart(2,"0");b.data=[],Ce(this.topic),Ct({command:"getDailyLog",data:{day:t}})},deactivate(){Ee(this.topic)},back(){this.date=new Date(this.date.setTime(this.date.getTime()-864e5))},forward(){this.date=new Date(this.date.setTime(this.date.getTime()+864e5))},setDate(t){this.date=t},getDate(){return this.date}}),_e=H({topic:"openWB/log/monthly/#",month:new Date().getMonth()+1,year:new Date().getFullYear(),activate(){const t=this.year.toString()+this.month.toString().padStart(2,"0");b.data=[],Ce(this.topic),Ct({command:"getMonthlyLog",data:{month:t}})},deactivate(){Ee(this.topic)},back(){this.month-=1,this.month<1&&(this.month=12,this.year-=1),this.activate()},forward(){this.month-1<new Date().getMonth()&&(this.month=this.month+1,this.month>12&&(this.month=1,this.year+=1),this.activate())},getDate(){return new Date(this.year,this.month)}}),Ae=H({topic:"openWB/log/yearly/#",month:new Date().getMonth()+1,year:new Date().getFullYear(),activate(){const t=this.year.toString();b.data=[],Ce(this.topic),Ct({command:"getYearlyLog",data:{year:t}})},deactivate(){Ee(this.topic)},back(){this.month-=1,this.month<1&&(this.month=12,this.year-=1),this.activate()},forward(){this.month-1<new Date().getMonth()&&(this.month=this.month+1,this.month>12&&(this.month=1,this.year+=1),this.activate())},getDate(){return new Date(this.year,this.month)}});function ie(){switch(b.graphMode==""?Un(_.graphPreference):b.graphMode=="live"?_.graphPreference="live":_.graphPreference="today",ut=!0,Xe=!0,b.graphMode){case"live":J.deactivate(),_e.deactivate(),Ae.deactivate(),te.activate();break;case"today":te.deactivate(),_e.deactivate(),Ae.deactivate(),J.activate();break;case"day":te.deactivate(),_e.deactivate(),Ae.deactivate(),J.activate();break;case"month":te.deactivate(),J.deactivate(),Ae.deactivate(),_e.activate();break;case"year":te.deactivate(),J.deactivate(),_e.deactivate(),Ae.activate();break}}function Un(t){b.graphMode=t}function sa(t,e){e[t+"Pv"]=e[t]*(e.solarPower-e.gridPush)/(e.solarPower-e.gridPush+e.gridPull+e.batOut),e[t+"Bat"]=e[t]*e.batOut/(e.solarPower-e.gridPush+e.gridPull+e.batOut)}function Vt(){switch(b.graphMode){case"live":b.graphMode="today",_.showRightButton=!0,ie();break;case"today":b.graphMode="day",J.date=new Date,J.back(),ie();break;case"day":J.back(),ie();break;case"month":_e.back();break}}function ra(){const t=new Date;switch(b.graphMode){case"live":break;case"today":b.graphMode="live",_.showRightButton=!1,ie();break;case"day":J.forward(),J.date.getDate()==t.getDate()&&J.date.getMonth()==t.getMonth()&&J.date.getFullYear()==t.getFullYear()&&(b.graphMode="today"),ie();break;case"month":_e.forward();break}}function la(){switch(b.graphMode){case"live":Vt();break;case"day":case"today":b.graphMode="month",ie();break;case"month":b.graphMode="year",ie();break}}function ia(){switch(b.graphMode){case"year":b.graphMode="month",ie();break;case"month":b.graphMode="day",ie();break;case"today":case"day":b.graphMode="live",ie();break}}function zt(t){if(b.graphMode=="day"||b.graphMode=="today"){J.setDate(t);const e=new Date;J.date.getDate()==e.getDate()&&J.date.getMonth()==e.getMonth()&&J.date.getFullYear()==e.getFullYear()?b.graphMode="today":b.graphMode="day",ie()}}const zn=["origin","transform"],Nn=I({__name:"PGSourceGraph",props:{width:{},height:{},margin:{}},setup(t){const e=t,a={house:"var(--color-house)",batIn:"var(--color-battery)",inverter:"var(--color-pv)",batOut:"var(--color-battery)",selfUsage:"var(--color-pv)",gridPush:"var(--color-export)",gridPull:"var(--color-evu)"};var s,o;const r=_.showAnimations?_.animationDuration:0,l=_.showAnimations?_.animationDelay:0,c=f(()=>{if(b.data.length>0){const G=fe("g#pgSourceGraph");b.graphMode=="month"||b.graphMode=="year"?L(G):D(G);const V=G.append("g").attr("class","axis");V.call(U.value),V.selectAll(".tick").attr("font-size",12),V.selectAll(".tick line").attr("stroke",Y.value).attr("stroke-width",Q.value),V.select(".domain").attr("stroke","var(--color-bg)")}return"pgSourceGraph.vue"}),u=f(()=>b.graphMode=="month"||b.graphMode=="year"?["gridPull","batOut","selfUsage","gridPush"]:["selfUsage","gridPush","batOut","gridPull"]),g=f(()=>Ve().domain([0,b.data.length-1]).range([0,e.width])),y=f(()=>mt().domain(Array.from({length:b.data.length},(G,V)=>V)).range([0,e.width+e.margin.right]).paddingInner(.4)),M=f(()=>Zt().keys(u.value)),C=f(()=>M.value(b.data)),S=f(()=>Ve().range([e.height-10,0]).domain(b.graphMode=="year"?[0,Math.ceil(P.value[1]*10)/10]:[0,Math.ceil(P.value[1])])),P=f(()=>{let G=ft(b.data,V=>Math.max(V.solarPower+V.gridPull+V.batOut,V.selfUsage+V.gridPush));return G[0]!=null&&G[1]!=null?G:[0,0]}),x=f(()=>b.graphMode=="month"||b.graphMode=="year")?-e.width-e.margin.right:-e.width,U=f(()=>Mt(S.value).tickSizeInner(x).ticks(4).tickFormat(G=>(G==0?"":Math.round(G*10)/10).toLocaleString(void 0))),Q=f(()=>_.showGrid?"0.5":"1"),Y=f(()=>_.showGrid?"var(--color-grid)":"var(--color-bg)");function D(G){const V=rt().x((ge,Fe)=>g.value(Fe)).y(S.value(0)),ne=rt().x((ge,Fe)=>g.value(Fe)).y0(ge=>S.value(ge[0])).y1(ge=>S.value(ge[1]));ut?(G.selectAll("*").remove(),s=G.selectAll(".sourceareas").data(C.value).enter().append("path").attr("fill",(ge,Fe)=>a[u.value[Fe]]).attr("d",ge=>V(ge)),s.transition().duration(r).delay(l).ease(We).attr("d",ge=>ne(ge)),jt()):s.data(C.value).transition().duration(0).ease(We).attr("d",ge=>ne(ge))}function L(G){ut?(G.selectAll("*").remove(),o=G.selectAll(".sourcebar").data(C.value).enter().append("g").attr("fill",(V,ne)=>a[u.value[ne]]).selectAll("rect").data(V=>V).enter().append("rect").attr("x",(V,ne)=>y.value(ne)??0).attr("y",()=>S.value(0)).attr("height",0).attr("width",y.value.bandwidth()),o.transition().duration(r).delay(l).ease(We).attr("height",V=>S.value(V[0])-S.value(V[1])).attr("y",V=>S.value(V[1])),jt()):(G.selectAll("*").remove(),o=G.selectAll(".sourcebar").data(C.value).enter().append("g").attr("fill",(V,ne)=>a[u.value[ne]]).selectAll("rect").data(V=>V).enter().append("rect").attr("x",(V,ne)=>y.value(ne)??0).attr("y",V=>S.value(V[1])).attr("width",y.value.bandwidth()).attr("height",V=>S.value(V[0])-S.value(V[1])))}return(G,V)=>(i(),h("g",{id:"pgSourceGraph",origin:c.value,transform:"translate("+G.margin.left+","+G.margin.top+")"},null,8,zn))}}),qn=["origin","transform"],Fn=I({__name:"PGUsageGraph",props:{width:{},height:{},margin:{},stackOrder:{}},setup(t){const e=t,a=[["house","charging","devices","batIn","inverter"],["charging","devices","house","batIn","inverter"],["devices","house","charging","batIn","inverter"]],s={house:"var(--color-house)",charging:"var(--color-charging)",batIn:"var(--color-battery)",inverter:"var(--color-pv)",batOut:"var(--color-battery)",selfUsage:"var(--color-pv)",gridPush:"var(--color-export)",gridPull:"var(--color-evu)",cp0:"var(--color-cp0)",cp1:"var(--color-cp1)",cp2:"var(--color-cp2)",cp3:"var(--color-cp3)",sh1:"var(--color-sh1)",sh2:"var(--color-sh2)",sh3:"var(--color-sh3)",sh4:"var(--color-sh4)",devices:"var(--color-devices)"};var o,r;const l=_.showAnimations?_.animationDuration:0,c=_.showAnimations?_.animationDelay:0,u=f(()=>{if(b.data.length>0){const D=fe("g#pgUsageGraph");b.graphMode=="month"||b.graphMode=="year"?Y(D):Q(D);const L=D.append("g").attr("class","axis");L.call(U.value),L.selectAll(".tick").attr("font-size",12).attr("color","var(--color-axis)"),_.showGrid?L.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):L.selectAll(".tick line").attr("stroke","var(--color-bg)"),L.select(".domain").attr("stroke","var(--color-bg)")}return"pgUsageGraph.vue"}),g=f(()=>Zt().keys(a[e.stackOrder])),y=f(()=>g.value(b.data)),M=f(()=>Ve().domain([0,b.data.length-1]).range([0,e.width])),C=f(()=>mt().domain(Array.from({length:b.data.length},(D,L)=>L)).range([0,e.width+e.margin.right]).paddingInner(.4)),S=f(()=>Ve().range([e.height+10,2*e.height]).domain(b.graphMode=="year"?[0,Math.ceil(P.value[1]*10)/10]:[0,Math.ceil(P.value[1])])),P=f(()=>{let D=ft(b.data,L=>L.house+L.charging+L.batIn+L.inverter+L.devices);return D[0]!=null&&D[1]!=null?D:[0,0]}),x=f(()=>b.graphMode=="month"||b.graphMode=="year")?-e.width-e.margin.right:-e.width,U=f(()=>Mt(S.value).tickSizeInner(x).ticks(4).tickFormat(D=>(D==0?"":Math.round(D*10)/10).toLocaleString(void 0)));function Q(D){const L=rt().x((V,ne)=>M.value(ne)).y(S.value(0)),G=rt().x((V,ne)=>M.value(ne)).y0(V=>S.value(V[0])).y1(V=>S.value(V[1]));_.showAnimations?Xe?(D.selectAll("*").remove(),o=D.selectAll(".usageareas").data(y.value).enter().append("path").attr("d",V=>L(V)).attr("fill",(V,ne)=>s[a[e.stackOrder][ne]]),o.transition().duration(300).delay(100).ease(We).attr("d",V=>G(V)),Ut()):o.data(y.value).transition().duration(100).ease(We).attr("d",V=>G(V)):(D.selectAll("*").remove(),D.selectAll(".usageareas").data(y.value).enter().append("path").attr("d",V=>G(V)).attr("fill",(V,ne)=>s[a[e.stackOrder][ne]]))}function Y(D){Xe?(D.selectAll("*").remove(),r=D.selectAll(".usagebar").data(y.value).enter().append("g").attr("fill",(L,G)=>s[a[e.stackOrder][G]]).selectAll("rect").data(L=>L).enter().append("rect").attr("x",(L,G)=>C.value(G)??0).attr("y",()=>S.value(0)).attr("height",0).attr("width",C.value.bandwidth()),r.transition().duration(l).delay(c).ease(We).attr("y",L=>S.value(L[0])).attr("height",L=>S.value(L[1])-S.value(L[0])),Ut()):(D.selectAll("*").remove(),r=D.selectAll(".usagebar").data(y.value).enter().append("g").attr("fill",(L,G)=>s[a[e.stackOrder][G]]).selectAll("rect").data(L=>L).enter().append("rect").attr("x",(L,G)=>C.value(G)??0).attr("y",L=>S.value(L[0])).attr("height",L=>S.value(L[1])-S.value(L[0])).attr("width",C.value.bandwidth()))}return(D,L)=>(i(),h("g",{id:"pgUsageGraph",origin:u.value,transform:"translate("+D.margin.left+","+D.margin.top+")"},null,8,qn))}}),Rn=["transform"],Hn=["origin","transform"],Jn=["origin","transform"],Qn={key:0},Yn=["width","height"],Zn={key:1},Xn=["y","width","height"],bt=12,Kn=I({__name:"PGXAxis",props:{width:{},height:{},margin:{}},setup(t){const e=t,a=f(()=>Wt(r.value).ticks(4).tickSizeInner(o.value).tickFormat(Ba("%H:%M"))),s=f(()=>Wt(l.value).ticks(4).tickSizeInner(o.value).tickFormat((g,y)=>(y+1).toString())),o=f(()=>b.graphMode!=="month"&&b.graphMode!=="year"?_.showGrid?-(e.height/2-7):-10:0),r=f(()=>{let g=ft(b.data,y=>y.date);return g[0]&&g[1]?lt().domain(g).range([0,e.width]):lt().range([0,0])}),l=f(()=>mt().domain(Array.from({length:b.data.length},(g,y)=>y)).paddingInner(.4).range([0,e.width+e.margin.right])),c=f(()=>{let g=fe("g#PGXAxis");return g.selectAll("*").remove(),b.graphMode=="month"||b.graphMode=="year"?g.call(s.value):g.call(a.value),g.selectAll(".tick").attr("color","var(--color-axis)").attr("font-size",bt),_.showGrid?g.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):g.selectAll(".tick line").attr("stroke","var(--color-bg)"),g.select(".domain").attr("stroke","var(--color-bg)"),g.append("text").attr("x",-e.margin.left).attr("y",12).attr("fill","var(--color-axis)").attr("font-size",bt).text(b.graphMode=="year"?"MWh":"kWh").attr("text-anchor","start"),"PGXAxis.vue"}),u=f(()=>{let g=fe("g#PGXAxis2");return g.selectAll("*").remove(),_.showGrid&&(g.selectAll(".tick").attr("color","var(--color-axis)").attr("font-size",bt),g.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"),g.select(".domain").attr("stroke","var(--color-bg)")),"PGXAxis.vue"});return(g,y)=>(i(),h("g",{transform:"translate("+g.margin.left+","+g.margin.top+")"},[n("g",{id:"PGXAxis",class:"axis",origin:c.value,transform:"translate(0,"+(g.height/2-6)+")"},null,8,Hn),n("g",{id:"PGXAxis2",class:"axis",origin:u.value,transform:"translate(0,"+(g.height/2+10)+")"},null,8,Jn),d(_).showGrid?(i(),h("g",Qn,[n("rect",{x:"0",y:"0",width:g.width,height:g.height/2-10,fill:"none",stroke:"var(--color-grid)","stroke-width":"0.5"},null,8,Yn)])):w("",!0),d(_).showGrid?(i(),h("g",Zn,[n("rect",{x:"0",y:g.height/2+10,width:g.width,height:g.height/2-10,fill:"none",stroke:"var(--color-grid)","stroke-width":"0.5"},null,8,Xn)])):w("",!0)],8,Rn))}}),eo=["d"],to=["d","stroke"],ao=["x","y","text-anchor"],Nt=I({__name:"PgSoc",props:{width:{},height:{},margin:{},order:{}},setup(t){const e=t,a=f(()=>Object.values(X)),s=f(()=>{let M=ft(b.data,C=>C.date);return M[0]&&M[1]?lt().domain(M).range([0,e.width]):lt().range([0,0])}),o=f(()=>Ve().range([e.height-10,0]).domain([0,100])),r=f(()=>{let C=Va().x(S=>s.value(S.date)).y(S=>o.value(S["soc"+e.order])!=null?o.value(S["soc"+e.order]):o.value(0))(b.data);return C||""}),l=f(()=>a.value[e.order].name??""),c=f(()=>e.order==0?"var(--color-cp1)":"var(--color-cp2)"),u=f(()=>e.order==0?e.width-3:3),g=f(()=>b.data.length>0?e.order==0?o.value(b.data[b.data.length-1].soc0+2):o.value(b.data[0].soc1+2):0),y=f(()=>e.order==0?"end":"start");return(M,C)=>(i(),h(W,null,[n("path",{class:"soc-baseline",d:r.value,stroke:"var(--color-bg)","stroke-width":"1",fill:"none"},null,8,eo),n("path",{class:"soc-dashes",d:r.value,stroke:c.value,"stroke-width":"1",style:{strokeDasharray:"3,3"},fill:"none"},null,8,to),n("text",{class:"cpname",x:u.value,y:g.value,style:R({fill:c.value,fontSize:10}),"text-anchor":y.value},$(l.value),13,ao)],64))}}),no=["transform"],oo=I({__name:"PgSocAxis",props:{width:{},height:{},margin:{}},setup(t){const e=t,a=f(()=>Ve().range([e.height-10,0]).domain([0,100])),s=f(()=>Ta(a.value).ticks(5).tickFormat(r=>r.toString()+"%"));function o(){let r=fe("g#PGSocAxis");r.call(s.value),r.selectAll(".tick").attr("font-size",12),r.selectAll(".tick line").attr("stroke","var(--color-bg)"),r.select(".domain").attr("stroke","var(--color-bg)")}return ze(()=>{o()}),(r,l)=>(i(),h("g",{id:"PGSocAxis",class:"axis",transform:"translate("+(r.width-20)+",0)"},null,8,no))}}),so=t=>(K("data-v-73750280"),t=t(),ee(),t),ro={class:"d-flex align-self-top justify-content-center align-items-center"},lo={class:"input-group input-group-xs"},io={class:"btn dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},co={class:"dropdown-menu"},uo={class:"table optiontable"},ho=["onClick"],po={class:"btn dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},go={class:"dropdown-menu"},mo={class:"table optiontable"},fo=["onClick"],_o={class:"btn dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},vo={class:"dropdown-menu"},bo={class:"table optiontable"},yo=["onClick"],wo=so(()=>n("span",{class:"fa-solid fa-circle-check"},null,-1)),ko=[wo],$o=I({__name:"DateInput",props:{modelValue:{type:Date,required:!0},mode:{type:String,default:"day"}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,s=new Date().getFullYear();let o=Array.from({length:10},(C,S)=>s-S);const r=le(!0),l=[[0,1,2,3],[4,5,6,7],[8,9,10,11]],c=le(a.modelValue.getDate()),u=le(a.modelValue.getMonth()),g=le(a.modelValue.getFullYear()),y=f(()=>{const S=new Date(g.value,u.value,1).getDay();let P=0;switch(u.value){case 1:case 3:case 5:case 7:case 8:case 10:case 12:P=31;break;case 4:case 6:case 9:case 11:P=30;break;case 2:Math.trunc(g.value/4)*4==g.value&&(P=29)}let x=[],U=[0,0,0,0,0,0,0],Q=S;for(let Y=0;Y<P;Y++)U[Q]=Y+1,Q==6?(x.push(U),U=[0,0,0,0,0,0,0],Q=0):Q++;return Q<8&&x.push(U),x});function M(){e("update:modelValue",new Date(g.value,u.value,c.value)),r.value=!1}return(C,S)=>(i(),h("span",ro,[n("div",lo,[n("button",io,$(c.value),1),n("div",co,[n("table",uo,[(i(!0),h(W,null,F(y.value,(P,x)=>(i(),h("tr",{key:x,class:""},[(i(!0),h(W,null,F(P,(U,Q)=>(i(),h("td",{key:Q},[c.value!=0?(i(),h("span",{key:0,type:"button",class:"btn optionbutton",onClick:Y=>c.value=U},$(U),9,ho)):w("",!0)]))),128))]))),128))])]),n("button",po,$(u.value+1),1),n("div",go,[n("table",mo,[(i(),h(W,null,F(l,(P,x)=>n("tr",{key:x,class:""},[(i(!0),h(W,null,F(P,(U,Q)=>(i(),h("td",{key:Q,class:"p-0 m-0"},[n("span",{type:"button",class:"btn btn-sm optionbutton",onClick:Y=>u.value=U},$(U+1),9,fo)]))),128))])),64))])]),n("button",_o,$(g.value),1),n("div",vo,[n("table",bo,[(i(!0),h(W,null,F(d(o),(P,x)=>(i(),h("tr",{key:x,class:""},[n("td",null,[n("span",{type:"button",class:"btn optionbutton",onClick:U=>g.value=P},$(P),9,yo)])]))),128))])]),n("button",{class:"button-outline-secondary",type:"button",onClick:M},ko)])]))}});const E=(t,e)=>{const a=t.__vccOpts||t;for(const[s,o]of e)a[s]=o;return a},Ke=E($o,[["__scopeId","data-v-73750280"]]),So={class:"btn-group m-0",role:"group","aria-label":"radiobar"},xo=["id","value"],Po=I({__name:"RadioBarInput",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,s=f({get(){return a.modelValue},set(l){e("update:modelValue",l)}});function o(l){let c=a.options[l].color?a.options[l].color:"var(--color-fg)";return a.options[l].active?{color:"var(--color-bg)",background:c}:{color:c}}function r(l){let c=l.target;for(;c&&!c.value&&c.parentElement;)c=c.parentElement;c.value&&(s.value=c.value)}return(l,c)=>(i(),h("div",null,[n("div",So,[(i(!0),h(W,null,F(l.options,(u,g)=>(i(),h("button",{id:"radio-"+u.value,key:g,class:z(["btn btn-outline-secondary btn-sm radiobutton mx-0 mb-0 px-2",u.value==s.value?"active":""]),value:u.value,style:R(o(g)),onClick:r},[n("span",{style:R(o(g))},[u.icon?(i(),h("i",{key:0,class:z(["fa-solid",u.icon])},null,2)):w("",!0),j(" "+$(u.text),1)],4)],14,xo))),128))])]))}});const ca=E(Po,[["__scopeId","data-v-82ab6829"]]),vt=t=>(K("data-v-708803a4"),t=t(),ee(),t),Mo=vt(()=>n("i",{class:"fa-solid fa-xl fa-chevron-circle-up"},null,-1)),Co=[Mo],Io=vt(()=>n("span",{class:"fa-solid fa-xl fa-chevron-circle-left arrowButton"},null,-1)),Bo=[Io],Vo=vt(()=>n("span",{class:"fa-solid fa-xl fa-gear"},null,-1)),To=[Vo],Lo=vt(()=>n("span",{class:"fa-solid fa-xl fa-circle-check"},null,-1)),Oo=[Lo],Ao=I({__name:"PgSelector",props:{widgetid:{},showLeftButton:{type:Boolean},showRightButton:{type:Boolean}},emits:["shiftLeft","shiftRight","shiftUp","shiftDown"],setup(t){const e=t,a=le(0),s=f(()=>{switch(b.graphMode){case"live":return`${te.duration} min`;case"today":return"heute";case"day":return J.date.getDate()+"."+(J.date.getMonth()+1)+".";case"month":return gn(_e.month-1,_e.year);case"year":return Ae.year.toString();default:return"???"}}),o=["live","today","day","month","year"],r=["Live","Heute","Tag","Monat","Jahr"],l=f({get(){return b.graphMode},set(Y){switch(Y){case"day":M();break;case"today":C();break;case"live":y();break;case"month":S();break;case"year":P()}}}),c=f(()=>{switch(b.graphMode){case"live":case"today":return J.getDate();case"month":return _e.getDate();default:return J.getDate()}});function u(Y){zt(Y)}function g(){a.value+=1,a.value>2&&(a.value=0)}function y(){b.graphMode!="live"&&(b.graphMode="live",ie())}function M(){b.graphMode!="day"&&b.graphMode!="today"&&(b.graphMode="day",ie())}function C(){b.graphMode!="today"&&(b.graphMode="today",zt(new Date))}function S(){b.graphMode!="month"&&(b.graphMode="month",ie())}function P(){b.graphMode!="year"&&(b.graphMode="year",ie())}const x=f(()=>a.value>0?{border:"1px solid var(--color-frame)"}:""),U=f(()=>a.value==1?"justify-content-between":"justify-content-end"),Q=f(()=>a.value==1?"justify-content-between":"justify-content-center");return(Y,D)=>(i(),h("div",{class:"d-flex flex-column justify-content-center pgselector rounded",style:R(x.value)},[a.value==2?(i(),B(ca,{key:0,id:"pgm2",modelValue:l.value,"onUpdate:modelValue":D[0]||(D[0]=L=>l.value=L),class:"m-2",options:o.map((L,G)=>({text:r[G],value:L,color:"var(--color-menu)",active:L==d(b).graphMode}))},null,8,["modelValue","options"])):w("",!0),a.value==1?(i(),h("span",{key:1,type:"button",class:z(["arrowButton d-flex align-self-center mb-3 mt-3",{disabled:!e.showLeftButton}]),onClick:D[1]||(D[1]=L=>Y.$emit("shiftUp"))},Co,2)):w("",!0),n("div",{class:z(["d-flex align-items-center",Q.value])},[a.value==1?(i(),h("span",{key:0,type:"button",class:z(["p-1",{disabled:!e.showLeftButton}]),onClick:D[2]||(D[2]=L=>Y.$emit("shiftLeft"))},Bo,2)):w("",!0),a.value<2?(i(),h("span",{key:1,type:"button",class:"p-2 px-3 badge rounded-pill datebadge",onClick:g},$(s.value),1)):w("",!0),a.value==2?(i(),B(Ke,{key:2,"model-value":c.value,mode:d(b).graphMode,"onUpdate:modelValue":u},null,8,["model-value","mode"])):w("",!0),a.value==1?(i(),h("span",{key:3,id:"graphRightButton",type:"button",class:z(["arrowButton fa-solid fa-xl fa-chevron-circle-right p-1",{disabled:!e.showRightButton}]),onClick:D[3]||(D[3]=L=>Y.$emit("shiftRight"))},null,2)):w("",!0)],2),n("div",{class:z(["d-flex align-items-center",U.value])},[a.value==1?(i(),h("span",{key:0,type:"button",class:"p-1",onClick:g},To)):w("",!0),a.value==1?(i(),h("span",{key:1,id:"graphLeftButton",type:"button",class:z(["arrowButton fa-solid fa-xl fa-chevron-circle-down p-1",{disabled:!e.showLeftButton}]),onClick:D[4]||(D[4]=L=>Y.$emit("shiftDown"))},null,2)):w("",!0),a.value>0?(i(),h("span",{key:2,type:"button",class:"p-1",onClick:D[5]||(D[5]=L=>a.value=0)},Oo)):w("",!0)],2)],4))}});const da=E(Ao,[["__scopeId","data-v-708803a4"]]),Do=t=>(K("data-v-2ce1d1f1"),t=t(),ee(),t),Wo=["viewBox"],Eo=["transform"],Go={id:"button"},jo=["y"],Uo=Do(()=>n("tspan",{fill:"var(--color-menu)",class:"fas fa-lg"},$(""),-1)),zo=[Uo],we=500,ke=500,No=2,qo="Leistung / Ladestand ",Fo=I({__name:"PowerGraph",setup(t){const e={top:10,right:20,bottom:10,left:25};function a(){let s=_.usageStackOrder+1;s>No&&(s=0),_.usageStackOrder=s,jn(!0)}return(s,o)=>(i(),B(xe,{"full-width":!0},{title:v(()=>[j($(qo))]),buttons:v(()=>[m(da,{widgetid:"graphsettings","show-left-button":!0,"show-right-button":!0,onShiftLeft:d(Vt),onShiftRight:d(ra),onShiftUp:d(la),onShiftDown:d(ia)},null,8,["onShiftLeft","onShiftRight","onShiftUp","onShiftDown"])]),default:v(()=>[n("figure",{id:"powergraph",class:"p-0 m-0",onClick:a},[(i(),h("svg",{viewBox:"0 0 "+we+" "+ke},[m(Nn,{width:we-e.left-2*e.right,height:(ke-e.top-e.bottom)/2,margin:e},null,8,["width","height"]),m(Fn,{width:we-e.left-2*e.right,height:(ke-e.top-e.bottom)/2,margin:e,"stack-order":d(_).usageStackOrder},null,8,["width","height","stack-order"]),m(Kn,{width:we-e.left-2*e.right,height:ke-e.top-e.bottom,margin:e,"graph-data":d(b)},null,8,["width","height","graph-data"]),n("g",{transform:"translate("+e.left+","+e.top+")"},[(d(b).graphMode=="day"||d(b).graphMode=="today")&&Object.values(d(X)).length>0?(i(),B(Nt,{key:0,width:we-e.left-2*e.right,height:(ke-e.top-e.bottom)/2,margin:e,order:0},null,8,["width","height"])):w("",!0),(d(b).graphMode=="day"||d(b).graphMode=="today")&&Object.values(d(X)).length>1?(i(),B(Nt,{key:1,width:we-e.left-2*e.right,height:(ke-e.top-e.bottom)/2,margin:e,order:1},null,8,["width","height"])):w("",!0),d(b).graphMode=="day"||d(b).graphMode=="today"?(i(),B(oo,{key:2,width:we-e.left-e.right,height:(ke-e.top-e.bottom)/2,margin:e},null,8,["width","height"])):w("",!0)],8,Eo),n("g",Go,[n("text",{x:we,y:ke-10,color:"var(--color-menu)","text-anchor":"end"},zo,8,jo)])],8,Wo))])]),_:1}))}});const Ro=E(Fo,[["__scopeId","data-v-2ce1d1f1"]]),Ho=["id"],Jo=["x","width","height","fill"],Qo=["x","width","height"],Yo=["x","width","height"],Zo=I({__name:"EmBar",props:{item:{},xScale:{},yScale:{},margin:{},height:{},barcount:{},autarchy:{},autText:{}},setup(t){const e=t,a=f(()=>e.height-e.yScale(e.item.energy)-e.margin.top-e.margin.bottom),s=f(()=>e.item.energyPv>0?e.height-e.yScale(e.item.energyPv)-e.margin.top-e.margin.bottom:0),o=f(()=>e.item.energyPv>0?e.height-e.yScale(e.item.energyBat)-e.margin.top-e.margin.bottom:0);return(r,l)=>(i(),h("g",{id:"bar-"+e.item.name,transform:"scale(1,-1) translate (0,-445)"},[n("rect",{class:"bar",x:e.xScale(r.item.name),y:"0",width:e.xScale.bandwidth(),height:a.value,fill:r.item.color},null,8,Jo),n("rect",{class:"bar",x:e.xScale(r.item.name)+e.xScale.bandwidth()/6,y:"0",width:e.xScale.bandwidth()*2/3,height:s.value,fill:"var(--color-pv)","fill-opacity":"66%"},null,8,Qo),n("rect",{class:"bar",x:e.xScale(r.item.name)+e.xScale.bandwidth()/6,y:"0",width:e.xScale.bandwidth()*2/3,height:o.value,fill:"var(--color-pv)","fill-opacity":"66%"},null,8,Yo)],8,Ho))}}),Xo={id:"emBargraph"},Ko=n("animateTransform",{"attribute-name":"transform",type:"scale",from:"1 0",to:"1 1",begin:"0s",dur:"2s"},null,-1),es=I({__name:"EMBarGraph",props:{plotdata:{},xScale:{},yScale:{},margin:{},height:{}},setup(t){const e=t;function a(o){if(o.name=="PV"){const r=b.graphMode=="live"||b.graphMode=="day"?N:k,c=(b.graphMode=="live"||b.graphMode=="day"?A:k).evuOut.energy,u=r.pv.energy;return Math.round((u-c)/u*100)}else if(o.name=="Netz"){const r=b.graphMode=="live"||b.graphMode=="day"?N:k,l=b.graphMode=="live"||b.graphMode=="day"?A:k,c=l.evuOut.energy,u=r.evuIn.energy,g=r.pv.energy,y=r.batOut.energy,M=l.batIn.energy;return Math.round((g+y-c-M)/(g+y+u-c-M)*100)}else return o.pvPercentage}function s(o){return o.name=="PV"?"Eigen":"Aut"}return(o,r)=>(i(),h("g",Xo,[(i(!0),h(W,null,F(e.plotdata,(l,c)=>(i(),h("g",{key:c},[m(Zo,{item:l,"x-scale":e.xScale,"y-scale":e.yScale,margin:e.margin,height:e.height,barcount:e.plotdata.length,"aut-text":s(l),autarchy:a(l)},null,8,["item","x-scale","y-scale","margin","height","barcount","aut-text","autarchy"])]))),128)),Ko]))}}),ts=["origin"],as=I({__name:"EMYAxis",props:{yScale:{},width:{},fontsize:{}},setup(t){const e=t,a=f(()=>Mt(e.yScale).tickFormat(o=>o>0?o.toString():"").ticks(6).tickSizeInner(-e.width)),s=f(()=>{const o=fe("g#emYAxis");return o.attr("class","axis").call(a.value),o.append("text").attr("y",6).attr("dy","0.71em").attr("text-anchor","end").text("energy"),o.selectAll(".tick").attr("font-size",e.fontsize),_.showGrid?o.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):o.selectAll(".tick line").attr("stroke","var(--color-bg)"),o.select(".domain").attr("stroke","var(--color-bg)"),"emYAxis.vue"});return(o,r)=>(i(),h("g",{id:"emYAxis",class:"axis",origin:s.value},null,8,ts))}}),ns=["id"],os=["x","y","font-size"],ss=["x","y","font-size","fill"],rs=["x","y","font-size","fill"],ls=I({__name:"EmLabel",props:{item:{},xScale:{},yScale:{},margin:{},height:{},barcount:{},autarchy:{},autText:{}},setup(t){const e=t,a=f(()=>e.autarchy?e.yScale(e.item.energy)-25:e.yScale(e.item.energy)-10),s=f(()=>{let u=16,g=e.barcount;return g<=5?u=16:g==6?u=14:g>6&&g<=8?u=13:g==9?u=11:g==10?u=10:u=9,u}),o=f(()=>{let u=12,g=e.barcount;return g<=5?u=12:g==6?u=11:g>6&&g<=8||g==9?u=8:g==10?u=7:u=6,u});function r(u,g){return g.length>o.value?g.substring(0,o.value)+".":g}function l(){return e.autarchy?e.autText+": "+e.autarchy.toLocaleString(void 0)+" %":""}function c(){return"var(--color-pv)"}return(u,g)=>(i(),h("g",{id:"barlabel-"+e.item.name},[n("text",{x:e.xScale(u.item.name)+e.xScale.bandwidth()/2,y:a.value,"font-size":s.value,"text-anchor":"middle",fill:"var(--color-menu)"},$(d(Ze)(u.item.energy*1e3,d(_).decimalPlaces,d(b).graphMode=="year")),9,os),n("text",{x:e.xScale(u.item.name)+e.xScale.bandwidth()/2,y:e.yScale(u.item.energy)-10,"font-size":s.value-2,"text-anchor":"middle",fill:c()},$(l()),9,ss),n("text",{x:e.xScale(u.item.name)+e.xScale.bandwidth()/2,y:e.height-e.margin.bottom-5,"font-size":s.value,"text-anchor":"middle",fill:u.item.color,class:z(u.item.icon.length<=2?"fas":"")},$(r(u.item.name,u.item.icon)),11,rs)],8,ns))}}),is={id:"emBarLabels"},cs=I({__name:"EMLabels",props:{plotdata:{},xScale:{},yScale:{},height:{},margin:{}},setup(t){const e=t;function a(o){if(o.name=="PV"){const r=b.graphMode=="live"||b.graphMode=="day"?N:k,c=(b.graphMode=="live"||b.graphMode=="day"?A:k).evuOut.energy,u=r.pv.energy;return Math.round((u-c)/u*100)}else if(o.name=="Netz"){const r=b.graphMode=="live"||b.graphMode=="day"?N:k,l=b.graphMode=="live"||b.graphMode=="day"?A:k,c=l.evuOut.energy,u=r.evuIn.energy,g=r.pv.energy,y=r.batOut.energy,M=l.batIn.energy;return Math.round((g+y-c-M)/(g+y+u-c-M)*100)}else return o.pvPercentage}function s(o){return o.name=="PV"?"Eigen":"Aut"}return(o,r)=>(i(),h("g",is,[(i(!0),h(W,null,F(e.plotdata,(l,c)=>(i(),h("g",{key:c},[m(ls,{item:l,"x-scale":e.xScale,"y-scale":e.yScale,margin:e.margin,height:e.height,barcount:e.plotdata.length,"aut-text":s(l),autarchy:a(l)},null,8,["item","x-scale","y-scale","margin","height","barcount","aut-text","autarchy"])]))),128))]))}}),ds={id:"energymeter",class:"p-0 m-0"},us={viewBox:"0 0 500 500"},hs=["transform"],ps=["x"],qt=500,yt=500,Ft=12,gs="Energie",ms=I({__name:"EnergyMeter",props:{usageDetails:{}},setup(t){const e=t,a={top:25,bottom:30,left:25,right:0},s=f(()=>{let l=Object.values(N),c=e.usageDetails,u=Object.values(k),g=[];switch(b.graphMode){default:case"live":case"today":g=l.concat(c).filter(y=>y.energy>0);break;case"day":case"month":case"year":g=u.filter(y=>y.energy>0)}return g}),o=f(()=>mt().range([0,qt-a.left-a.right]).domain(s.value.map(l=>l.name)).padding(.4)),r=f(()=>Ve().range([yt-a.bottom-a.top,15]).domain([0,La(s.value,l=>l.energy)]));return(l,c)=>(i(),B(xe,{"full-width":!0},{title:v(()=>[j($(gs))]),buttons:v(()=>[m(da,{widgetid:"graphsettings","show-left-button":!0,"show-right-button":!0,onShiftLeft:d(Vt),onShiftRight:d(ra),onShiftUp:d(la),onShiftDown:d(ia)},null,8,["onShiftLeft","onShiftRight","onShiftUp","onShiftDown"])]),default:v(()=>[n("figure",ds,[(i(),h("svg",us,[n("g",{transform:"translate("+a.left+","+a.top+")"},[m(es,{plotdata:s.value,"x-scale":o.value,"y-scale":r.value,height:yt,margin:a},null,8,["plotdata","x-scale","y-scale"]),m(as,{"y-scale":r.value,width:qt,fontsize:Ft,config:d(_)},null,8,["y-scale","config"]),n("text",{x:-a.left,y:"-15",fill:"var(--color-axis)","font-size":Ft},$(d(b).graphMode=="year"?"MWh":"kWh"),9,ps),m(cs,{plotdata:s.value,"x-scale":o.value,"y-scale":r.value,height:yt,margin:a,config:d(_)},null,8,["plotdata","x-scale","y-scale","config"])],8,hs)]))])]),_:1}))}}),fs={class:"d-flex flex-column align-items-center"},_s={class:"heading mt-1"},vs={class:"mx-1"},bs={class:"d-flex my-0 align-items-center content"},ys=I({__name:"InfoItem",props:{heading:{}},setup(t){const e=t;return(a,s)=>(i(),h("span",fs,[n("span",_s,$(e.heading),1),n("span",vs,[n("span",bs,[ae(a.$slots,"default",{},void 0,!0)])])]))}});const oe=E(ys,[["__scopeId","data-v-5512398e"]]),ws={class:"row p-0 m-0"},ks={class:"col p-0 m-0"},$s={class:"d-flex justify-content-between"},Ss={class:"col p-0 m-0",style:{"text-align":"right"}},xs={class:"container-fluid m-0 p-0"},Ps=I({__name:"WbSubwidget",props:{titlecolor:{},fullwidth:{type:Boolean}},setup(t){const e=t,a=f(()=>e.titlecolor?{color:e.titlecolor}:{color:"var(--color-fg)"}),s=f(()=>e.fullwidth?"col-lg-12":"col-lg-4");return(o,r)=>(i(),h("div",{class:z(["px-4 pt-3 mb-2 wb-subwidget m-0",s.value])},[n("div",ws,[n("div",ks,[n("div",$s,[n("h3",{class:"m-0 mb-2",style:R(a.value)},[ae(o.$slots,"title",{},void 0,!0)],4),n("div",Ss,[ae(o.$slots,"buttons",{},void 0,!0)])])])]),n("div",xs,[ae(o.$slots,"default",{},void 0,!0)])],2))}});const ua=E(Ps,[["__scopeId","data-v-263a58f0"]]),Ms=t=>(K("data-v-85517e3c"),t=t(),ee(),t),Cs={class:"col-12 m-0 mb-0 px-0 py-0 configitem"},Is={class:"titlecolumn m-0 p-0 d-flex align-items-center"},Bs=Ms(()=>n("i",{class:"me-1 fa-solid fa-sm fa-circle-info"},null,-1)),Vs={class:"row ms-1 mb-2 p-0 pt-2 d-flex align-items-center"},Ts={class:"col me-1 p-0 ps-4 selectors"},Ls={class:"d-flex justify-content-stretch align-items-center"},Os=I({__name:"ConfigItem",props:{title:{},infotext:{},icon:{},fullwidth:{type:Boolean}},setup(t){const e=t,a=le(!1);function s(){a.value=!a.value}const o=f(()=>{let r={color:"var(--color-charging)"};return a.value&&(r.color="var(--color-battery)"),r});return(r,l)=>(i(),B(ua,{fullwidth:!!r.fullwidth},{default:v(()=>[n("div",Cs,[n("div",Is,[n("span",{class:"d-flex align-items-baseline m-0 p-0",onClick:s},[e.icon?(i(),h("i",{key:0,class:z(["fa-solid fa-sm m-0 p-0 me-2 item-icon",e.icon])},null,2)):w("",!0),j(" "+$(r.title),1)]),n("span",null,[e.infotext?(i(),h("i",{key:0,class:"fa-solid fa-sm fa-circle-question ms-4 me-2",style:R(o.value),onClick:s},null,4)):w("",!0)])]),a.value?(i(),h("p",{key:0,class:"infotext shadow m-0 ps-2 mb-1 p-1",onClick:s},[Bs,j(" "+$(r.infotext),1)])):w("",!0),n("div",Vs,[n("div",Ts,[n("span",Ls,[n("span",null,[ae(r.$slots,"default",{},void 0,!0)])])])])])]),_:3},8,["fullwidth"]))}});const O=E(Os,[["__scopeId","data-v-85517e3c"]]),ha=t=>(K("data-v-d228e49b"),t=t(),ee(),t),As={class:"d-flex flex-fill justify-content-between"},Ds=ha(()=>n("i",{class:"fa fa-xl fa-minus-square me-2"},null,-1)),Ws=[Ds],Es=["id","min","max","step"],Gs=ha(()=>n("i",{class:"fa fa-xl fa-plus-square ms-2"},null,-1)),js=[Gs],Us={class:"d-flex justify-content-between align-items-start"},zs={class:"minlabel ps-4"},Ns={class:"valuelabel"},qs={class:"maxlabel pe-4"},Fs=I({__name:"RangeInput",props:{id:{},min:{},max:{},step:{},unit:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,s=f({get(){return a.modelValue},set(l){e("update:modelValue",l)}});function o(){s.value>a.min&&(s.value=s.value-a.step)}function r(){s.value<a.max&&(s.value=s.value+a.step)}return(l,c)=>(i(),h(W,null,[n("span",As,[n("span",{class:"minusButton",onClick:o},Ws),Le(n("input",{id:l.id,"onUpdate:modelValue":c[0]||(c[0]=u=>s.value=u),type:"range",class:"form-range flex-fill",min:l.min,max:l.max,step:l.step},null,8,Es),[[Xt,s.value,void 0,{number:!0}]]),n("span",{class:"plusButton",onClick:r},js)]),n("span",Us,[n("span",zs,$(l.min),1),n("span",Ns,$(s.value)+" "+$(l.unit),1),n("span",qs,$(l.max),1)])],64))}});const ve=E(Fs,[["__scopeId","data-v-d228e49b"]]),Rs=["id","value"],Hs=I({__name:"RadioInput",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,s=f({get(){return a.modelValue},set(l){e("update:modelValue",l)}});function o(l){return a.options[l][2]?{color:a.options[l][2]}:{color:"var(--color-fg)"}}function r(l){let c=l.target;for(;c&&!c.value&&c.parentElement;)c=c.parentElement;c.value&&(s.value=c.value)}return(l,c)=>(i(),h("div",null,[(i(!0),h(W,null,F(l.options,(u,g)=>(i(),h("button",{id:"radio-"+u[1],key:g,class:z(["btn btn-outline-secondary radiobutton me-2 mb-0 px-2",u[1]==s.value?"active":""]),value:u[1],style:R(o(g)),onClick:r},[n("span",{style:R(o(g))},[u[3]?(i(),h("i",{key:0,class:z(["fa-solid",u[3]])},null,2)):w("",!0),j(" "+$(u[0]),1)],4)],14,Rs))),128))]))}});const Te=E(Hs,[["__scopeId","data-v-df222cbe"]]),Js=t=>(K("data-v-ccd11e7e"),t=t(),ee(),t),Qs={class:"mt-2"},Ys=Js(()=>n("p",{class:"heading ms-1"},"Sofortladen:",-1)),Zs={key:0},Xs=I({__name:"CPConfigInstant",props:{chargepoint:{}},setup(t){const a=le(t.chargepoint),s=[{name:"keine",id:"none"},{name:"EV-SoC",id:"soc"},{name:"Energiemenge",id:"amount"}];return(o,r)=>(i(),h("div",Qs,[Ys,m(O,{title:"Stromstärke",icon:"fa-bolt",fullwidth:!0},{default:v(()=>[m(ve,{id:"targetCurrent",modelValue:a.value.instantTargetCurrent,"onUpdate:modelValue":r[0]||(r[0]=l=>a.value.instantTargetCurrent=l),min:6,max:32,step:1,unit:"A"},null,8,["modelValue"])]),_:1}),a.value.instantChargeLimitMode!="none"?(i(),h("hr",Zs)):w("",!0),m(O,{title:"Begrenzung",icon:"fa-hand"},{default:v(()=>[m(Te,{modelValue:a.value.instantChargeLimitMode,"onUpdate:modelValue":r[1]||(r[1]=l=>a.value.instantChargeLimitMode=l),options:s.map(l=>[l.name,l.id])},null,8,["modelValue","options"])]),_:1}),a.value.instantChargeLimitMode=="soc"?(i(),B(O,{key:1,title:"Maximaler SoC",icon:"fa-sliders"},{default:v(()=>[m(ve,{id:"maxSoc",modelValue:a.value.instantTargetSoc,"onUpdate:modelValue":r[2]||(r[2]=l=>a.value.instantTargetSoc=l),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])]),_:1})):w("",!0),a.value.instantChargeLimitMode=="amount"?(i(),B(O,{key:2,title:"Zu ladende Energie",icon:"fa-sliders"},{default:v(()=>[m(ve,{id:"maxEnergy",modelValue:a.value.instantMaxEnergy,"onUpdate:modelValue":r[3]||(r[3]=l=>a.value.instantMaxEnergy=l),min:0,max:100,step:1,unit:"kWh"},null,8,["modelValue"])]),_:1})):w("",!0)]))}});const Ks=E(Xs,[["__scopeId","data-v-ccd11e7e"]]),er={class:"form-check form-switch"},me=I({__name:"SwitchInput",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,s=f({get(){return a.modelValue},set(o){e("update:modelValue",o)}});return(o,r)=>(i(),h("div",er,[Le(n("input",{"onUpdate:modelValue":r[0]||(r[0]=l=>s.value=l),class:"form-check-input",type:"checkbox",role:"switch"},null,512),[[_t,s.value]])]))}}),pa=t=>(K("data-v-daf11c39"),t=t(),ee(),t),tr={class:"pt-2"},ar=pa(()=>n("p",{class:"heading ms-1"},"PV-Laden:",-1)),nr={class:"form-check form-switch"},or=pa(()=>n("hr",null,null,-1)),sr={key:2},rr=I({__name:"CPConfigPv",props:{chargepoint:{}},setup(t){const a=le(t.chargepoint),s=f({get(){return a.value.pvMinCurrent>5},set(r){r?a.value.pvMinCurrent=6:a.value.pvMinCurrent=0}}),o=f({get(){return a.value.pvMinSoc>0},set(r){r?a.value.pvMinSoc=50:a.value.pvMinSoc=0}});return(r,l)=>(i(),h("div",tr,[ar,m(O,{title:"Maximaler Ladestand",icon:"fa-battery-three-quarters",fullwidth:!0},{default:v(()=>[m(ve,{id:"maxSoc",modelValue:a.value.pvMaxSoc,"onUpdate:modelValue":l[0]||(l[0]=c=>a.value.pvMaxSoc=c),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])]),_:1}),m(O,{title:"Einspeisegrenze beachten",icon:"fa-hand",fullwidth:!0},{default:v(()=>[n("div",nr,[Le(n("input",{id:"feedInLimitSwitch","onUpdate:modelValue":l[1]||(l[1]=c=>a.value.pvFeedInLimit=c),class:"form-check-input",type:"checkbox",role:"switch"},null,512),[[_t,a.value.pvFeedInLimit]])])]),_:1}),or,m(O,{title:"Min-SoC-Laden",icon:"fa-battery-half",infotext:d($e).minsoc,fullwidth:!0},{default:v(()=>[m(me,{modelValue:o.value,"onUpdate:modelValue":l[2]||(l[2]=c=>o.value=c)},null,8,["modelValue"])]),_:1},8,["infotext"]),o.value?(i(),B(O,{key:0,title:"...bis SoC",fullwidth:!0},{info:v(()=>[j($(d($e).minsoc),1)]),default:v(()=>[m(ve,{id:"minSoc",modelValue:a.value.pvMinSoc,"onUpdate:modelValue":l[3]||(l[3]=c=>a.value.pvMinSoc=c),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])]),_:1})):w("",!0),o.value?(i(),B(O,{key:1,title:"...mit Ladestrom",fullwidth:!0},{default:v(()=>[m(ve,{id:"minSocCurrent",modelValue:a.value.pvMinSocCurrent,"onUpdate:modelValue":l[4]||(l[4]=c=>a.value.pvMinSocCurrent=c),min:6,max:32,step:1,unit:"A"},null,8,["modelValue"])]),_:1})):w("",!0),s.value||o.value?(i(),h("hr",sr)):w("",!0),m(O,{title:"Min+PV-Laden",icon:"fa-bolt",infotext:d($e).minpv,fullwidth:!0},{default:v(()=>[m(me,{modelValue:s.value,"onUpdate:modelValue":l[5]||(l[5]=c=>s.value=c)},null,8,["modelValue"])]),_:1},8,["infotext"]),s.value?(i(),B(O,{key:3,title:"...bei Ladestrom (minimal)",fullwidth:!0},{default:v(()=>[m(ve,{id:"minCurrent",modelValue:a.value.pvMinCurrent,"onUpdate:modelValue":l[6]||(l[6]=c=>a.value.pvMinCurrent=c),min:6,max:32,step:1,unit:"A"},null,8,["modelValue"])]),_:1})):w("",!0)]))}});const lr=E(rr,[["__scopeId","data-v-daf11c39"]]),ga=t=>(K("data-v-1a32bb24"),t=t(),ee(),t),ir=["id"],cr={class:"modal-dialog modal-lg modal-fullscreen-lg-down"},dr={class:"modal-content"},ur={class:"modal-header"},hr={class:"modal-title"},pr=ga(()=>n("button",{type:"button",class:"btn-close buttonTextSize d-flex justify-content-center pt-3 pb-0","data-bs-dismiss":"modal"},[n("i",{class:"fa-solid fa-lg fa-rectangle-xmark m-0 p-0"})],-1)),gr={class:"modal-body",style:{"background-color":"var(--color-bg)"}},mr=ga(()=>n("button",{class:"btn btn-secondary float-end mt-3 ms-1","data-bs-dismiss":"modal"}," Schließen ",-1)),fr=I({__name:"ModalComponent",props:{modalId:{}},setup(t){const e=t;return ze(()=>{}),(a,s)=>(i(),h("div",{id:e.modalId,class:"modal fade"},[n("div",cr,[n("div",dr,[n("div",ur,[n("h3",hr,[ae(a.$slots,"title",{},void 0,!0)]),pr]),n("div",gr,[ae(a.$slots,"default",{},void 0,!0),mr])])])],8,ir))}});const Tt=E(fr,[["__scopeId","data-v-1a32bb24"]]),_r=["value"],vr=I({__name:"SelectInput",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,s=f({get(){return a.modelValue},set(o){e("update:modelValue",o)}});return(o,r)=>Le((i(),h("select",{id:"selectme","onUpdate:modelValue":r[0]||(r[0]=l=>s.value=l),class:"form-select"},[(i(!0),h(W,null,F(o.options,(l,c)=>(i(),h("option",{key:c,value:l[1]},$(l[0]),9,_r))),128))],512)),[[Oa,s.value]])}});const Lt=E(vr,[["__scopeId","data-v-5e33ce1f"]]),br=["id","onUpdate:modelValue","value"],yr=["for"],wr=I({__name:"CheckBoxInput",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,s=f({get(){return a.modelValue},set(r){console.log("SET CHECKBOX"),e("update:modelValue",r)}});function o(r){return s.value[r]?{color:"var(--color-pv)"}:{color:"var(--color-menu)"}}return(r,l)=>(i(!0),h(W,null,F(r.options,(c,u)=>(i(),h("div",{key:u},[Le(n("input",{id:"check"+u,"onUpdate:modelValue":g=>s.value[u]=g,class:"form-check-input",type:"checkbox",value:c},null,8,br),[[_t,s.value[u]]]),n("label",{class:"form-check-label px-2",for:"check"+u,style:R(o(u))},$(r.options[u]),13,yr)]))),128))}});const ma=E(wr,[["__scopeId","data-v-534700e0"]]),kr=I({__name:"TimeInput",props:{modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,s=f({get(){return a.modelValue},set(o){e("update:modelValue",o)}});return(o,r)=>Le((i(),h("input",{"onUpdate:modelValue":r[0]||(r[0]=l=>s.value=l),type:"time",class:"form-control",name:"t"},null,512)),[[Xt,s.value]])}});const Pt=E(kr,[["__scopeId","data-v-51c81cc3"]]),$r={class:"container-fluid p-0 m-0"},Sr={class:"row mt-2"},xr={class:"col d-flex justify-content-end"},Pr=I({__name:"CPEditSchedule",props:{chargeTemplateId:{},planId:{}},emits:["deletePlan","abort","savePlan"],setup(t){const e=t,a=[["Einmalig","once"],["Täglich","daily"],["Wöchentlich","weekly"]],s=["Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"],o=f(()=>ue[e.chargeTemplateId]),r=f(()=>{let l=o.value.chargemode.scheduled_charging.plans[e.planId];return l||aa()});return(l,c)=>(i(),h("div",$r,[m(O,{title:"Ladestand",fullwidth:!0},{default:v(()=>[m(ve,{id:"soc",modelValue:r.value.soc,"onUpdate:modelValue":c[0]||(c[0]=u=>r.value.soc=u),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])]),_:1}),m(O,{title:"Zielzeit beachten",fullwidth:!0},{default:v(()=>[m(me,{modelValue:r.value.timed,"onUpdate:modelValue":c[1]||(c[1]=u=>r.value.timed=u)},null,8,["modelValue"])]),_:1}),m(O,{title:"Uhrzeit",fullwidth:!0},{default:v(()=>[m(Pt,{modelValue:r.value.time,"onUpdate:modelValue":c[2]||(c[2]=u=>r.value.time=u)},null,8,["modelValue"])]),_:1}),m(O,{title:"Wiederholungen",fullwidth:!0},{default:v(()=>[m(Lt,{modelValue:r.value.frequency.selected,"onUpdate:modelValue":c[3]||(c[3]=u=>r.value.frequency.selected=u),options:a},null,8,["modelValue"])]),_:1}),r.value.frequency.selected=="once"?(i(),B(O,{key:0,title:"Gültig ab",fullwidth:!0},{default:v(()=>[m(Ke,{modelValue:r.value.frequency.once[0],"onUpdate:modelValue":c[4]||(c[4]=u=>r.value.frequency.once[0]=u)},null,8,["modelValue"])]),_:1})):w("",!0),r.value.frequency.selected=="once"?(i(),B(O,{key:1,title:"Gültig bis",fullwidth:!0},{default:v(()=>[m(Ke,{modelValue:r.value.frequency.once[1],"onUpdate:modelValue":c[5]||(c[5]=u=>r.value.frequency.once[1]=u)},null,8,["modelValue"])]),_:1})):w("",!0),r.value.frequency.selected=="weekly"?(i(),B(O,{key:2,title:"Wochentage",fullwidth:!0},{default:v(()=>[m(ma,{modelValue:r.value.frequency.weekly,"onUpdate:modelValue":c[6]||(c[6]=u=>r.value.frequency.weekly=u),options:s},null,8,["modelValue"])]),_:1})):w("",!0),n("div",Sr,[n("div",xr,[n("button",{class:"btn btn-danger","data-bs-dismiss":"modal",onClick:c[7]||(c[7]=u=>l.$emit("deletePlan",l.planId))}," Löschen "),n("button",{class:"btn btn-warning ms-1","data-bs-dismiss":"modal",onClick:c[8]||(c[8]=u=>l.$emit("abort"))}," Abbrechen "),n("button",{class:"btn btn-success float-end ms-1","data-bs-dismiss":"modal",onClick:c[9]||(c[9]=u=>l.$emit("savePlan",l.planId))}," Speichern ")])])]))}});const Mr=E(Pr,[["__scopeId","data-v-119e0317"]]),Oe=t=>(K("data-v-399182a8"),t=t(),ee(),t),Cr=Oe(()=>n("p",{class:"heading ms-1 pt-2"},"Zielladen:",-1)),Ir={class:"table table-borderless"},Br=Oe(()=>n("thead",null,[n("tr",null,[n("th",{class:"tableheader"},"Ziel-SoC"),n("th",{class:"tableheader"},"Zeit"),n("th",{class:"tableheader"},"Wiederholung"),n("th",{class:"tableheader"})])],-1)),Vr={class:"tablecell"},Tr={class:"tablecell"},Lr={class:"tablecell"},Or={class:"tablecell left"},Ar=["data-bs-target","onClick"],Dr=Oe(()=>n("i",{class:"fas fa-lg fa-pen ms-2"},null,-1)),Wr=[Dr],Er=Oe(()=>n("td",{class:"emptycell"},null,-1)),Gr=Oe(()=>n("td",{class:"emptycell"},null,-1)),jr=Oe(()=>n("td",{class:"emptycell"},null,-1)),Ur={class:"right"},zr=["data-bs-target"],Nr=Oe(()=>n("i",{class:"fa-solid fa-xl fa-square-plus ms-2"},null,-1)),qr=[Nr],Fr=I({__name:"CPConfigScheduled",props:{chargeTemplate:{},chargeTemplateId:{}},setup(t){const e=t,a={daily:"Täglich",once:"Einmal",weekly:"Wöchentlich"},s="schedulesettingmodal"+e.chargeTemplateId,o=H(["0"]),r=f(()=>{let P=e.chargeTemplate.chargemode.scheduled_charging.plans;return P||{}});function l(P){return r.value[P].timed?r.value[P].time:"-"}function c(P){o[0]=P}function u(){na(e.chargeTemplateId)}function g(){u()}function y(){console.log("abort edit")}function M(P){delete ue[e.chargeTemplateId].chargemode.scheduled_charging.plans[P],u()}function C(){let P=aa();e.chargeTemplate.chargemode.scheduled_charging.plans||(ue[e.chargeTemplateId].chargemode.scheduled_charging.plans={});let x=0;Object.keys(r.value).forEach(U=>{+U>x&&(x=+U)}),x=x+1,ue[e.chargeTemplateId].chargemode.scheduled_charging.plans[x.toString()]=P,c(x.toString()),console.log(r.value),S()}function S(){let P=document.getElementById(s);P?new Aa(P).show():console.log("NO MODAL ELEMENT")}return(P,x)=>(i(),h(W,null,[Cr,n("table",Ir,[Br,n("tbody",null,[(i(!0),h(W,null,F(Object.keys(r.value),U=>(i(),h("tr",{key:U},[n("td",Vr,$(r.value[U].soc)+" %",1),n("td",Tr,$(l(U)),1),n("td",Lr,$(a[r.value[U].frequency.selected]),1),n("td",Or,[n("span",{class:"editButton","data-bs-toggle":"modal","data-bs-target":"#"+s,onClick:Q=>c(U)},Wr,8,Ar)])]))),128)),n("tr",null,[Er,Gr,jr,n("td",Ur,[n("span",{class:"addButton","data-bs-target":"#"+s,onClick:C},qr,8,zr)])])])]),(i(!0),h(W,null,F(o,U=>(i(),B(Tt,{key:U,"modal-id":s},{title:v(()=>[j(" Zielladen - Parameter ")]),default:v(()=>[m(Mr,{"charge-template-id":P.chargeTemplateId,"plan-id":U,onSavePlan:g,onDeletePlan:M,onAbort:y},null,8,["charge-template-id","plan-id"])]),_:2},1024))),128))],64))}});const Rr=E(Fr,[["__scopeId","data-v-399182a8"]]),Hr={class:"container-fluid p-0 m-0"},Jr={class:"row"},Qr={class:"col d-flex justify-content-end"},Yr=I({__name:"CPEditTimeplan",props:{chargeTemplateId:{},planId:{}},emits:["deletePlan","abort","savePlan"],setup(t){const e=t,a=[["Einmalig","once"],["Täglich","daily"],["Wöchentlich","weekly"]],s=["Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"],o=f(()=>ue[e.chargeTemplateId]),r=f(()=>{let l=o.value.time_charging.plans[e.planId];return l||ta()});return(l,c)=>(i(),h("div",Hr,[m(O,{title:"Beginn",fullwidth:!0},{default:v(()=>[m(Pt,{modelValue:r.value.time[0],"onUpdate:modelValue":c[0]||(c[0]=u=>r.value.time[0]=u)},null,8,["modelValue"])]),_:1}),m(O,{title:"Ende",fullwidth:!0},{default:v(()=>[m(Pt,{modelValue:r.value.time[1],"onUpdate:modelValue":c[1]||(c[1]=u=>r.value.time[1]=u)},null,8,["modelValue"])]),_:1}),m(O,{title:"Ladestrom",fullwidth:!0},{default:v(()=>[m(ve,{id:"current",modelValue:r.value.current,"onUpdate:modelValue":c[2]||(c[2]=u=>r.value.current=u),min:6,max:32,step:1,unit:"A"},null,8,["modelValue"])]),_:1}),m(O,{title:"Wiederholungen",fullwidth:!0},{default:v(()=>[m(Lt,{modelValue:r.value.frequency.selected,"onUpdate:modelValue":c[3]||(c[3]=u=>r.value.frequency.selected=u),options:a},null,8,["modelValue"])]),_:1}),r.value.frequency.selected=="once"?(i(),B(O,{key:0,title:"Gültig ab",fullwidth:!0},{default:v(()=>[m(Ke,{modelValue:r.value.frequency.once[0],"onUpdate:modelValue":c[4]||(c[4]=u=>r.value.frequency.once[0]=u)},null,8,["modelValue"])]),_:1})):w("",!0),r.value.frequency.selected=="once"?(i(),B(O,{key:1,title:"Gültig bis",fullwidth:!0},{default:v(()=>[m(Ke,{modelValue:r.value.frequency.once[1],"onUpdate:modelValue":c[5]||(c[5]=u=>r.value.frequency.once[1]=u)},null,8,["modelValue"])]),_:1})):w("",!0),r.value.frequency.selected=="weekly"?(i(),B(O,{key:2,title:"Wochentage",fullwidth:!0},{default:v(()=>[m(ma,{modelValue:r.value.frequency.weekly,"onUpdate:modelValue":c[6]||(c[6]=u=>r.value.frequency.weekly=u),options:s},null,8,["modelValue"])]),_:1})):w("",!0),n("div",Jr,[n("div",Qr,[n("button",{class:"btn btn-danger",onClick:c[7]||(c[7]=u=>l.$emit("deletePlan",l.planId))}," Löschen "),n("button",{class:"btn btn-warning ms-1",onClick:c[8]||(c[8]=u=>l.$emit("abort"))}," Abbrechen "),n("button",{class:"btn btn-success float-end ms-1",onClick:c[9]||(c[9]=u=>l.$emit("savePlan",l.planId))}," Speichern ")])])]))}});const Zr=E(Yr,[["__scopeId","data-v-dbb0f7ee"]]),Pe=t=>(K("data-v-674bed04"),t=t(),ee(),t),Xr=Pe(()=>n("p",{class:"heading ms-1 pt-2"},"Zeitpläne:",-1)),Kr={class:"table table-borderless"},el=Pe(()=>n("thead",null,[n("tr",null,[n("th",{class:"tableheader"},"Von"),n("th",{class:"tableheader"},"Bis"),n("th",{class:"tableheader"},"Ladestrom"),n("th",{class:"tableheader"},"Wiederholung"),n("th",{class:"tableheader right"})])],-1)),tl={class:"tablecell"},al={class:"tablecell"},nl={class:"tablecell"},ol={class:"tablecell"},sl={class:"tablecell left"},rl=["onClick"],ll=Pe(()=>n("i",{class:"fas fa-lg fa-pen ms-2"},null,-1)),il=[ll],cl=Pe(()=>n("td",{class:"emptycell"},null,-1)),dl=Pe(()=>n("td",{class:"emptycell"},null,-1)),ul=Pe(()=>n("td",{class:"emptycell"},null,-1)),hl=Pe(()=>n("td",{class:"emptycell"},null,-1)),pl=Pe(()=>n("i",{class:"fa-solid fa-xl fa-square-plus ms-2"},null,-1)),gl=[pl],ml=I({__name:"CPConfigTimed",props:{chargeTemplate:{},chargeTemplateId:{}},setup(t){const e=t,a={daily:"Täglich",once:"Einmal",weekly:"Wöchentlich"},s=H(["0"]);function o(C){s[0]=C}const r=le(!1);function l(){na(e.chargeTemplateId)}function c(){l(),r.value=!1}function u(){console.log("abort edit"),r.value=!1}function g(C){delete ue[e.chargeTemplateId].time_charging.plans[C],l(),r.value=!1}function y(){let C=ta();e.chargeTemplate.time_charging.plans||(ue[e.chargeTemplateId].time_charging.plans={});let S=0;Object.keys(M.value).forEach(P=>{+P>S&&(S=+P)}),S=S+1,ue[e.chargeTemplateId].time_charging.plans[S.toString()]=C,o(S.toString()),r.value=!0}const M=f(()=>{let C=e.chargeTemplate.time_charging.plans;return C||{}});return(C,S)=>(i(),h(W,null,[Xr,n("table",Kr,[el,n("tbody",null,[(i(!0),h(W,null,F(Object.keys(M.value),P=>(i(),h("tr",{key:P},[n("td",tl,$(M.value[P].time[0]),1),n("td",al,$(M.value[P].time[1]),1),n("td",nl,$(M.value[P].current)+" A",1),n("td",ol,$(a[M.value[P].frequency.selected]),1),n("td",sl,[n("span",{class:"editButton",editPlan:"true",onClick:x=>o(P)},il,8,rl)])]))),128)),n("tr",null,[cl,dl,ul,hl,n("td",{class:"tablecell right"},[n("span",{class:"addButton",onClick:y},gl)])])])]),r.value?(i(),B(xe,{key:0,"full-width":!0},{title:v(()=>[j(" Zeitplan bearbeiten ")]),default:v(()=>[m(Zr,{"charge-template-id":C.chargeTemplateId,"plan-id":s[0],onSavePlan:c,onDeletePlan:g,onAbort:u},null,8,["charge-template-id","plan-id"])]),_:1})):w("",!0)],64))}});const fl=E(ml,[["__scopeId","data-v-674bed04"]]),_l={class:"settingsheader mt-2 ms-1"},vl=I({__name:"CPConfigVehicle",props:{vehicleId:{}},setup(t){const e=t;return(a,s)=>(i(),h(W,null,[n("p",_l," Profile für "+$(d(X)[e.vehicleId].name)+": ",1),m(O,{title:"Ladeprofil",icon:"fa-sliders",fullwidth:!0},{default:v(()=>[m(Te,{modelValue:d(X)[e.vehicleId].chargeTemplateId,"onUpdate:modelValue":s[0]||(s[0]=o=>d(X)[e.vehicleId].chargeTemplateId=o),modelModifiers:{number:!0},options:Object.keys(d(ue)).map(o=>[d(ue)[+o].name,o])},null,8,["modelValue","options"])]),_:1}),m(O,{title:"Fahrzeug-Vorlage",icon:"fa-sliders",fullwidth:!0},{default:v(()=>[m(Te,{modelValue:d(X)[e.vehicleId].evTemplateId,"onUpdate:modelValue":s[1]||(s[1]=o=>d(X)[e.vehicleId].evTemplateId=o),modelModifiers:{number:!0},options:Object.keys(d(xt)).map(o=>[d(xt)[+o].name,o])},null,8,["modelValue","options"])]),_:1})],64))}});const bl=E(vl,[["__scopeId","data-v-fcb57a44"]]),yl=t=>(K("data-v-29abd227"),t=t(),ee(),t),wl=yl(()=>n("p",{class:"settingsheader mt-2 ms-1"},"Ladepunkt:",-1)),kl=I({__name:"CPChargeConfig",props:{chargepoint:{}},emits:["closeConfig"],setup(t){const a=t.chargepoint;return(s,o)=>(i(),h(W,null,[wl,m(O,{title:"Lademodus",icon:"fa-charging-station",infotext:d($e).chargemode,fullwidth:!0},{default:v(()=>[m(Te,{modelValue:d(a).chargeMode,"onUpdate:modelValue":o[0]||(o[0]=r=>d(a).chargeMode=r),options:Object.keys(d(se)).map(r=>[d(se)[r].name,r,d(se)[r].color,d(se)[r].icon])},null,8,["modelValue","options"])]),_:1},8,["infotext"]),m(O,{title:"Fahrzeug",icon:"fa-car",infotext:d($e).vehicle,fullwidth:!0},{default:v(()=>[m(Te,{modelValue:d(a).connectedVehicle,"onUpdate:modelValue":o[1]||(o[1]=r=>d(a).connectedVehicle=r),modelModifiers:{number:!0},options:Object.values(d(X)).map(r=>[r.name,r.id])},null,8,["modelValue","options"])]),_:1},8,["infotext"]),m(O,{title:"Sperren",icon:"fa-lock",infotext:d($e).locked,fullwidth:!0},{default:v(()=>[m(me,{modelValue:d(a).isLocked,"onUpdate:modelValue":o[2]||(o[2]=r=>d(a).isLocked=r)},null,8,["modelValue"])]),_:1},8,["infotext"]),m(O,{title:"Priorität",icon:"fa-star",infotext:d($e).priority,fullwidth:!0},{default:v(()=>[m(me,{modelValue:d(a).hasPriority,"onUpdate:modelValue":o[3]||(o[3]=r=>d(a).hasPriority=r)},null,8,["modelValue"])]),_:1},8,["infotext"]),m(O,{title:"Zeitplan",icon:"fa-clock",infotext:d($e).timeplan,fullwidth:!0},{default:v(()=>[m(me,{modelValue:d(a).scheduledCharging,"onUpdate:modelValue":o[4]||(o[4]=r=>d(a).scheduledCharging=r)},null,8,["modelValue"])]),_:1},8,["infotext"])],64))}});const $l=E(kl,[["__scopeId","data-v-29abd227"]]),Ne=t=>(K("data-v-963883cd"),t=t(),ee(),t),Sl={class:"status-string"},xl={style:{color:"red"}},Pl={class:"m-0 mt-4 p-0"},Ml={class:"nav nav-tabs nav-justified mx-1 mt-1",role:"tablist"},Cl=["data-bs-target"],Il=Ne(()=>n("i",{class:"fa-solid fa-charging-station"},null,-1)),Bl=[Il],Vl=["data-bs-target"],Tl=Ne(()=>n("i",{class:"fa-solid fa-lg fa-bolt"},null,-1)),Ll=[Tl],Ol=["data-bs-target"],Al=Ne(()=>n("i",{class:"fa-solid fa-solar-panel me-1"},null,-1)),Dl=[Al],Wl=["data-bs-target"],El=Ne(()=>n("i",{class:"fa-solid fa-bullseye me-1"},null,-1)),Gl=[El],jl=["data-bs-target"],Ul=Ne(()=>n("i",{class:"fa-solid fa-clock"},null,-1)),zl=[Ul],Nl=["data-bs-target"],ql=Ne(()=>n("i",{class:"fa-solid fa-rectangle-list"},null,-1)),Fl=[ql],Rl={id:"settingsPanes",class:"tab-content mx-1 p-1 pb-3"},Hl=["id"],Jl=["id"],Ql=["id"],Yl=["id"],Zl=["id"],Xl=["id"],Kl=I({__name:"CPChargeConfigPanel",props:{chargepoint:{}},emits:["closeConfig"],setup(t){const a=t.chargepoint,s=f(()=>ue[a.chargeTemplate]),o=f(()=>a.id);return ze(()=>{}),(r,l)=>(i(),h(W,null,[m(O,{title:"Status",icon:"fa-info-circle",fullwidth:!0},{default:v(()=>[n("span",Sl,$(d(a).stateStr),1)]),_:1}),d(a).faultState!=0?(i(),B(O,{key:0,title:"Fehler"},{default:v(()=>[n("span",xl,$(d(a).faultStr),1)]),_:1})):w("",!0),n("div",Pl,[n("nav",Ml,[n("a",{class:"nav-link active","data-bs-toggle":"tab","data-bs-target":"#chargeSettings"+o.value},Bl,8,Cl),r.chargepoint.chargeMode=="instant_charging"?(i(),h("a",{key:0,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#instantSettings"+o.value},Ll,8,Vl)):w("",!0),r.chargepoint.chargeMode=="pv_charging"?(i(),h("a",{key:1,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#pvSettings"+o.value},Dl,8,Ol)):w("",!0),r.chargepoint.chargeMode=="scheduled_charging"?(i(),h("a",{key:2,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#scheduledSettings"+o.value},Gl,8,Wl)):w("",!0),r.chargepoint.scheduledCharging?(i(),h("a",{key:3,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#timeSettings"+o.value},zl,8,jl)):w("",!0),n("a",{class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#carSettings"+o.value},Fl,8,Nl)]),n("div",Rl,[n("div",{id:"chargeSettings"+o.value,class:"tab-pane active",role:"tabpanel","aria-labelledby":"instant-tab"},[m($l,{chargepoint:r.chargepoint},null,8,["chargepoint"])],8,Hl),n("div",{id:"instantSettings"+o.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"instant-tab"},[m(Ks,{chargepoint:d(a),vehicles:d(X),"charge-templates":d(ue)},null,8,["chargepoint","vehicles","charge-templates"])],8,Jl),n("div",{id:"pvSettings"+o.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"pv-tab"},[m(lr,{chargepoint:d(a),vehicles:d(X),"charge-templates":d(ue)},null,8,["chargepoint","vehicles","charge-templates"])],8,Ql),n("div",{id:"scheduledSettings"+o.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"scheduled-tab"},[s.value!=null?(i(),B(Rr,{key:0,"charge-template":s.value,"charge-template-id":d(a).chargeTemplate},null,8,["charge-template","charge-template-id"])):w("",!0)],8,Yl),n("div",{id:"timeSettings"+o.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"time-tab"},[s.value!=null?(i(),B(fl,{key:0,"charge-template":s.value,"charge-template-id":d(a).chargeTemplate},null,8,["charge-template","charge-template-id"])):w("",!0)],8,Zl),n("div",{id:"carSettings"+o.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"car-tab"},[d(X)[d(a).connectedVehicle]!=null?(i(),B(bl,{key:0,"vehicle-id":d(a).connectedVehicle},null,8,["vehicle-id"])):w("",!0)],8,Xl)])])],64))}});const ht=E(Kl,[["__scopeId","data-v-963883cd"]]),ei=I({__name:"BatterySymbol",props:{soc:{}},setup(t){const e=t,a=f(()=>e.soc<=10?"fa-battery-empty":e.soc<50?"fa-battery-quarter":e.soc<75?"fa-battery-half":e.soc<95?"fa-battery-three-quarters":"fa-battery-full");return(s,o)=>(i(),h("span",null,[n("i",{class:z(["fa batIcon",a.value])},null,2),j(" "+$(s.soc+"%"),1)]))}});const Ot=E(ei,[["__scopeId","data-v-49be699a"]]),fa=I({__name:"FormatWattH",props:{wattH:{}},setup(t){const e=t,a=f(()=>Ze(e.wattH,_.decimalPlaces));return(s,o)=>(i(),h("span",null,$(a.value),1))}}),ti=t=>(K("data-v-349e7414"),t=t(),ee(),t),ai={class:"wb-widget p-0 m-0 shadow"},ni={class:"d-flex justify-content-between"},oi={class:"m-4 mb-3"},si=ti(()=>n("div",{class:"p-0"},"(title goes here)",-1)),ri={class:"p-4 pb-0 col-4 m-0",style:{"text-align":"right"}},li={class:"container-fluid p-0"},ii=I({__name:"WbWidgetFlex",props:{variableWidth:{type:Boolean},fullWidth:{type:Boolean}},setup(t){const e=t,a=f(()=>e.fullWidth?"col-12":e.variableWidth&&_.preferWideBoxes?"col-lg-6":"col-lg-4");return(s,o)=>(i(),h("div",{class:z(["p-2 m-0 d-flex",a.value])},[n("div",ai,[n("div",ni,[n("h3",oi,[ae(s.$slots,"title",{},()=>[si],!0),ae(s.$slots,"subtitle",{},void 0,!0)]),n("div",ri,[ae(s.$slots,"buttons",{},void 0,!0)])]),n("div",li,[ae(s.$slots,"default",{},void 0,!0)])])],2))}});const pt=E(ii,[["__scopeId","data-v-349e7414"]]),nt=t=>(K("data-v-c0a34644"),t=t(),ee(),t),ci=nt(()=>n("span",{class:"fas fa-charging-station"}," ",-1)),di=nt(()=>n("span",{class:"fa-solid fa-lg ps-1 fa-ellipsis-vertical"},null,-1)),ui=[di],hi={key:0},pi={class:"col m-0 mb-1 p-0 d-flex justify-content-between"},gi={class:"col m-0 p-0 d-flex justify-content-between"},mi={class:"row m-0 p-0 mt-3 mb-0"},fi={class:"col d-flex justify-content-center p-0 m-0"},_i={key:1,class:"row m-0 mt-0 p-0"},vi={class:"col m-0 p-0"},bi={key:0},yi={class:"col"},wi=nt(()=>n("i",{class:"fa-solid fa-sm fa-car me-2"},null,-1)),ki={key:0,class:"me-1 fa-solid fa-xs fa-star ps-1"},$i={class:"row m-0 p-1 pt-2 mb-3"},Si={class:"m-0 p-0 d-flex justify-content-between"},xi={key:0,class:"me-1 fa-solid fa-xs fa-clock ps-1"},Pi=nt(()=>n("span",{class:"fas fa-gear"}," ",-1)),Mi=nt(()=>n("span",{class:"fa-solid fa-lg ps-1 fa-circle-check"},null,-1)),Ci=[Mi],Ii=I({__name:"CPChargePoint",props:{chargepoint:{},fullWidth:{type:Boolean}},setup(t){const e=t,a=f({get(){return e.chargepoint.chargeMode},set(C){T[e.chargepoint.id].chargeMode=C}}),s=f(()=>(Math.round(e.chargepoint.current*10)/10).toLocaleString(void 0)+" A"),o=f(()=>Math.round(e.chargepoint.rangeCharged).toString()+" "+e.chargepoint.rangeUnit),r=f(()=>e.chargepoint.isLocked?"Gesperrt":e.chargepoint.isCharging?"Lädt":e.chargepoint.isPluggedIn?"Bereit":"Frei"),l=f(()=>e.chargepoint.isLocked?"var(--color-evu)":e.chargepoint.isCharging?"var(--color-charging)":e.chargepoint.isPluggedIn?"var(--color-battery)":"var(--color-axis)"),c=f(()=>{let C="";return e.chargepoint.isLocked?C="fa-lock":e.chargepoint.isCharging?C=" fa-bolt":e.chargepoint.isPluggedIn&&(C="fa-plug"),"fa "+C}),u=f(()=>{switch(e.chargepoint.chargeMode){case"stop":return{color:"var(--fg)"};default:return{color:se[e.chargepoint.chargeMode].color}}}),g=f(()=>e.chargepoint.soc),y=f(()=>({color:e.chargepoint.color})),M=le(!1);return(C,S)=>(i(),h(W,null,[M.value?w("",!0):(i(),B(xe,{key:0,"variable-width":!0,"full-width":e.fullWidth},{title:v(()=>[n("span",{style:R(y.value),onClick:S[0]||(S[0]=P=>M.value=!M.value)},[ci,j(" "+$(e.chargepoint.name),1)],4)]),buttons:v(()=>[n("span",{class:"ms-2 pt-1",style:R(u.value),onClick:S[1]||(S[1]=P=>M.value=!M.value)},ui,4)]),footer:v(()=>[M.value?w("",!0):(i(),h("div",bi,[n("div",{class:"row",onClick:S[5]||(S[5]=P=>M.value=!M.value)},[n("div",yi,[n("h3",null,[wi,j(" "+$(C.chargepoint.vehicleName)+" ",1),C.chargepoint.hasPriority?(i(),h("span",ki)):w("",!0)])])]),n("div",$i,[n("div",Si,[m(oe,{heading:"Ladestand:"},{default:v(()=>[C.chargepoint.isSocConfigured?(i(),B(Ot,{key:0,soc:g.value,class:"me-2"},null,8,["soc"])):w("",!0),C.chargepoint.isSocManual?(i(),h("i",{key:1,class:"fa-solid fa-sm fas fa-edit",style:R({color:"var(--color-menu)"})},null,4)):w("",!0),C.chargepoint.isSocManual?w("",!0):(i(),h("i",{key:2,class:"fa-solid fa-sm fa-sync",style:R({color:"var(--color-menu)"})},null,4))]),_:1}),m(oe,{heading:"Reichweite:"},{default:v(()=>[j($(d(X)[e.chargepoint.connectedVehicle]?Math.round(d(X)[1].range):0)+" km ",1)]),_:1}),m(oe,{heading:"Zeitplan:"},{default:v(()=>[C.chargepoint.scheduledCharging?(i(),h("span",xi)):w("",!0),j(" "+$(e.chargepoint.scheduledCharging?"Ja":"Nein"),1)]),_:1})])])]))]),default:v(()=>[M.value?w("",!0):(i(),h("div",hi,[n("div",{class:"row m-1 mt-0 p-0",onClick:S[2]||(S[2]=P=>M.value=!M.value)},[n("div",pi,[m(oe,{heading:"Status:"},{default:v(()=>[n("span",{style:R({color:l.value})},[n("i",{class:z(c.value)},null,2),j(" "+$(r.value),1)],4)]),_:1}),m(oe,{heading:"Geladen:"},{default:v(()=>[m(fa,{"watt-h":C.chargepoint.chargedSincePlugged},null,8,["watt-h"])]),_:1}),m(oe,{heading:"gel. Reichw.:"},{default:v(()=>[j($(o.value),1)]),_:1})])]),e.chargepoint.power>0?(i(),h("div",{key:0,class:"row m-1 p-0",onClick:S[3]||(S[3]=P=>M.value=!M.value)},[n("div",gi,[m(oe,{heading:"Leistung:"},{default:v(()=>[m(Bt,{watt:e.chargepoint.power},null,8,["watt"])]),_:1}),m(oe,{heading:"Stromstärke:"},{default:v(()=>[j($(s.value),1)]),_:1}),m(oe,{heading:"Phasen:"},{default:v(()=>[j($(e.chargepoint.phasesInUse),1)]),_:1})])])):w("",!0),n("div",mi,[n("div",fi,[m(ca,{id:"chargemode-"+C.chargepoint.name,modelValue:a.value,"onUpdate:modelValue":S[4]||(S[4]=P=>a.value=P),options:Object.keys(d(se)).map(P=>({text:d(se)[P].name,value:P,color:d(se)[P].color,icon:d(se)[P].icon,active:d(se)[P].mode==C.chargepoint.chargeMode}))},null,8,["id","modelValue","options"])])])])),M.value?(i(),h("div",_i,[n("div",vi,[C.chargepoint!=null?(i(),B(ht,{key:0,chargepoint:C.chargepoint},null,8,["chargepoint"])):w("",!0)])])):w("",!0)]),_:1},8,["full-width"])),M.value?(i(),B(pt,{key:1,"full-width":e.fullWidth},{title:v(()=>[n("span",{style:R(y.value),onClick:S[6]||(S[6]=P=>M.value=!M.value)},[Pi,j(" Einstellungen "+$(e.chargepoint.name),1)],4)]),buttons:v(()=>[n("span",{class:"ms-2 pt-1",style:R(u.value),onClick:S[7]||(S[7]=P=>M.value=!M.value)},Ci,4)]),default:v(()=>[C.chargepoint!=null?(i(),B(ht,{key:0,chargepoint:C.chargepoint},null,8,["chargepoint"])):w("",!0)]),_:1},8,["full-width"])):w("",!0)],64))}});const Bi=E(Ii,[["__scopeId","data-v-c0a34644"]]),Vi={class:"tablerow"},Ti={class:"d-flex flex-wrap"},Li={key:0,class:"fa-solid fa-xs fa-star"},Oi={key:1,class:"fa-solid fa-xs fa-clock"},Ai={class:"tablecell left"},Di={class:"d-flex flex-column"},Wi={key:0,class:"flex-wrap"},Ei=["data-bs-target"],Gi={class:"d-flex flex-column"},ji={class:"d-flex align-items-center flex-wrap"},Ui={class:"d-flex align-items-center me-1"},zi={class:"badge phasesInUse rounded-pill"},Ni=["data-bs-target"],qi={class:"d-flex flex-column"},Fi={class:"me-2"},Ri={class:"buttoncell right"},Hi=["data-bs-target"],Ji={key:0},Qi={colspan:"5",class:"px-0"},Yi=I({__name:"CPSListItem",props:{chargepoint:{}},setup(t){const e=t,a=le(!1),s=f(()=>se[e.chargepoint.chargeMode].icon),o=f(()=>{let x="";return e.chargepoint.isLocked?x="fa-lock":e.chargepoint.isCharging?x=" fa-bolt":e.chargepoint.isPluggedIn&&(x="fa-plug"),"fa "+x}),r=f(()=>{let x={color:"var(--color-axis)"};return e.chargepoint.isLocked?x.color="var(--color-evu)":e.chargepoint.isCharging?x.color="var(--color-charging)":e.chargepoint.isPluggedIn&&(x.color="var(--color-battery)"),x}),l=f(()=>{switch(e.chargepoint.chargeMode){case"stop":return{color:"var(--fg)"};default:return{color:se[e.chargepoint.chargeMode].color}}}),c=f(()=>Be(e.chargepoint.power,_.decimalPlaces)),u=f(()=>e.chargepoint.current+" A"),g=f(()=>e.chargepoint.phasesInUse),y=f(()=>e.chargepoint.dailyYield>0?Ze(e.chargepoint.dailyYield,_.decimalPlaces):"0 Wh"),M=f(()=>e.chargepoint.averageConsumption>0&&e.chargepoint.dailyYield>0?"("+Math.round(e.chargepoint.dailyYield/e.chargepoint.averageConsumption/10).toString()+" km)":""),C=f(()=>se[e.chargepoint.chargeMode].name);function S(){return{color:e.chargepoint.color}}function P(){a.value=!a.value}return(x,U)=>(i(),h(W,null,[n("tr",Vi,[n("td",{class:"tablecell left",onClick:P},[n("div",Ti,[n("span",null,[n("i",{class:z([o.value,"me-1"]),style:R(r.value)},null,6),n("span",{class:"me-1",style:R(S())},$(x.chargepoint.name),5)]),n("span",null,[x.chargepoint.hasPriority?(i(),h("i",Li)):w("",!0),x.chargepoint.scheduledCharging?(i(),h("i",Oi)):w("",!0)])])]),n("td",Ai,[n("div",Di,[n("span",null,$(x.chargepoint.vehicleName),1),x.chargepoint.isSocConfigured?(i(),h("span",Wi,[m(Ot,{class:"me-1",soc:x.chargepoint.soc},null,8,["soc"]),x.chargepoint.isSocManual?(i(),h("i",{key:0,class:"fa-solid fa-sm fas fa-edit me-2",style:R({color:"var(--color-menu)"})},null,4)):w("",!0),x.chargepoint.isSocManual?w("",!0):(i(),h("i",{key:1,class:"fa-solid fa-sm fa-sync me-2",style:R({color:"var(--color-menu)"})},null,4))])):w("",!0)])]),n("td",{class:"tablecell left","data-bs-toggle":"modal","data-bs-target":"#cpsconfig-"+x.chargepoint.id},[n("div",Gi,[n("span",ji,[n("span",null,$(c.value),1),n("span",Ui,[n("span",zi,$(g.value),1),n("span",null,$(u.value),1)])]),n("span",{style:R(l.value)},[n("i",{class:z(["fa me-1",s.value])},null,2),j(" "+$(C.value),1)],4)])],8,Ei),n("td",{class:"tablecell left","data-bs-toggle":"modal","data-bs-target":"#cpsconfig-"+x.chargepoint.id},[n("div",qi,[n("span",Fi,$(y.value),1),n("span",null,$(M.value),1)])],8,Ni),n("td",Ri,[n("span",{class:"fa-solid fa-lg fa-edit ps-1 tableicon","data-bs-toggle":"modal","data-bs-target":"#cpsconfig-"+x.chargepoint.id},null,8,Hi)])]),a.value?(i(),h("tr",Ji,[n("td",Qi,[a.value?(i(),B(ht,{key:0,chargepoint:x.chargepoint,onCloseConfig:P},null,8,["chargepoint"])):w("",!0)])])):w("",!0)],64))}});const Zi=E(Yi,[["__scopeId","data-v-e5ea1042"]]),Xi=t=>(K("data-v-76f208ee"),t=t(),ee(),t),Ki={class:"table table-borderless px-0"},ec=Xi(()=>n("thead",null,[n("tr",null,[n("th",{class:"tableheader alignleft"},[n("i",{class:"fa-solid fa-lg fa-charging-station ps-2"})]),n("th",{class:"tableheader alignleft"},[n("i",{class:"fa-solid fa-lg fa-car ps-2"})]),n("th",{class:"tableheader alignleft"},[n("i",{class:"fa-solid fa-lg fa-bolt ps-2"})]),n("th",{class:"tableheader alignleft"},[n("i",{class:"fa-solid fa-lg fa-car-battery ps-2"})]),n("th",{class:"tableheader alignright"})])],-1)),tc=I({__name:"CPSimpleList",setup(t){const e=f(()=>Object.values(T));return(a,s)=>(i(),B(xe,null,{title:v(()=>[j(" Ladepunkte ")]),default:v(()=>[n("table",Ki,[ec,n("tbody",null,[(i(!0),h(W,null,F(e.value,o=>(i(),B(Zi,{key:o.id,chargepoint:o},null,8,["chargepoint"]))),128))])]),(i(!0),h(W,null,F(e.value,o=>(i(),B(Tt,{key:o.id,"modal-id":"cpsconfig-"+o.id},{title:v(()=>[j(" Konfiguration: "+$(o.name),1)]),default:v(()=>[o!=null?(i(),B(ht,{key:0,chargepoint:o},null,8,["chargepoint"])):w("",!0)]),_:2},1032,["modal-id"]))),128))]),_:1}))}});const ac=E(tc,[["__scopeId","data-v-76f208ee"]]);const wt=I({__name:"ChargePointList",setup(t){let e,a;const s=f(()=>{let l=Object.values(T);return r(),l}),o=f(()=>{switch(Object.values(T).length){case 0:return _.preferWideBoxes?"col-lg-6":"col-lg-4";case 1:return _.preferWideBoxes?"col-lg-6":"col-lg-4";case 2:return _.preferWideBoxes?"col-lg-12":"col-lg-8 ";default:return"col-lg-12"}});function r(){if(e){let l="1";if(Ie.value)switch(Object.values(T).length){case 0:case 1:l="1";break;case 2:l="2";break;default:l="3"}a.setAttribute("slides-per-view",l),e.update()}}return ze(()=>{let l=document.querySelector(".swiper-chargepoints");l&&(a=l,e=a.swiper),window.addEventListener("resize",r)}),(l,c)=>(i(),h(W,null,[d(_).simpleCpList?w("",!0):(i(),h("swiper-container",{key:0,"space-between":0,"slides-per-view":1,pagination:{clickable:!0},class:z(["cplist m-0 p-0 swiper-chargepoints d-flex align-items-stretch",o.value])},[(i(!0),h(W,null,F(s.value,u=>(i(),h("swiper-slide",{key:u.id},[n("div",{class:z([d(Ie)?"mb-0":"mb-5","d-flex align-items-stretch flex-fill"])},[m(Bi,{chargepoint:u,"full-width":!0},null,8,["chargepoint"])],2)]))),128))],2)),d(_).simpleCpList?(i(),B(ac,{key:1})):w("",!0)],64))}}),nc={class:"container-fluid p-0 m-0"},oc={class:"row p-0 m-0"},sc={class:"d-grid gap-2"},rc=["onClick"],lc={class:"col-md-4 p-1"},ic={class:"d-grid gap-2"},cc={key:0},dc=n("hr",null,null,-1),uc=n("div",{class:"row"},[n("div",{class:"col text-center"},"Vorrang im Lademodus PV-Laden:")],-1),hc={class:"row justify-content-center m-1 p-0"},pc={class:"col-6 p-1 m-0"},gc={class:"d-grid gap-2"},mc=n("span",{class:"fas fa-car"}," ",-1),fc={class:"col-6 p-1 m-0"},_c={class:"d-grid gap-2"},vc=n("span",{class:"fas fa-car-battery"}," ",-1),bc=I({__name:"BBSelect",props:{cpId:{}},setup(t){const e=t,a=[{mode:"instant_charging",name:"Sofort",color:"var(--color-charging)"},{mode:"pv_charging",name:"PV",color:"var(--color-pv)"},{mode:"scheduled_charging",name:"Zielladen",color:"var(--color-battery)"},{mode:"standby",name:"Standby",color:"var(--color-axis)"},{mode:"stop",name:"Stop",color:"var(--color-axis)"}],s=f(()=>T[e.cpId]);function o(g){return g==s.value.chargeMode?"btn btn-success buttonTextSize":"btn btn-secondary buttonTextSize"}function r(g){switch(g){case"ev":return re.pvBatteryPriority?"btn-secondary":"btn-success";case"bat":return re.pvBatteryPriority?"btn-success":"btn-secondary";default:return""}}function l(g){s.value.chargeMode=g}function c(g){s.value.isLocked=g}function u(g){re.pvBatteryPriority=g}return(g,y)=>(i(),h("div",nc,[n("div",oc,[(i(),h(W,null,F(a,(M,C)=>n("div",{key:C,class:"col-md-4 p-1"},[n("div",sc,[n("button",{type:"button",class:z(o(M.mode)),style:{},onClick:S=>l(M.mode)},$(M.name),11,rc)])])),64)),n("div",lc,[n("div",ic,[s.value.isLocked?(i(),h("button",{key:0,type:"button",class:"btn btn-outline-success buttonTextSize","data-bs-dismiss":"modal",onClick:y[0]||(y[0]=M=>c(!1))}," Entsperren ")):w("",!0),s.value.isLocked?w("",!0):(i(),h("button",{key:1,type:"button",class:"btn btn-outline-danger buttonTextSize","data-bs-dismiss":"modal",onClick:y[1]||(y[1]=M=>c(!0))}," Sperren "))])])]),d(re).isBatteryConfigured&&s.value.chargeMode=="pv_charging"?(i(),h("div",cc,[dc,uc,n("div",hc,[n("div",pc,[n("div",gc,[n("button",{id:"evPriorityBtn",type:"button",class:z(["priorityModeBtn btn btn-secondary buttonTextSize",r("ev")]),"data-dismiss":"modal",priority:"1",onClick:y[2]||(y[2]=M=>u(!1))},[j(" EV "),mc],2)])]),n("div",fc,[n("div",_c,[n("button",{id:"batteryPriorityBtn",type:"button",class:z(["priorityModeBtn btn btn-secondary buttonTextSize",r("bat")]),"data-dismiss":"modal",priority:"0",onClick:y[3]||(y[3]=M=>u(!0))},[j(" Speicher "),vc],2)])])])])):w("",!0)]))}}),yc={class:"col-lg-4 p-0 m-0 mt-1"},wc={class:"d-grid gap-2"},kc=["data-bs-target"],$c={class:"m-0 p-0 d-flex justify-content-between align-items-center"},Sc={class:"mx-1 badge rounded-pill smallTextSize plugIndicator"},xc={key:0,class:"ms-2"},Pc={class:"m-0 p-0"},Mc={key:0,class:"ps-1"},Cc=I({__name:"BbChargeButton",props:{chargepoint:{}},setup(t){const e=t,a="chargeSelectModal"+e.chargepoint.id,s=f(()=>se[e.chargepoint.chargeMode].name),o=f(()=>{let y={background:"var(--color-menu)"};return e.chargepoint.isLocked?y.background="var(--color-evu)":e.chargepoint.isCharging?y.background="var(--color-charging)":e.chargepoint.isPluggedIn&&(y.background="var(--color-battery)"),y}),r=f(()=>{if(se){let y={background:se[e.chargepoint.chargeMode].color,color:"white"};switch(e.chargepoint.chargeMode){case de.instant_charging:e.chargepoint.isCharging&&!e.chargepoint.isLocked&&(y=g(y));break;case de.standby:case de.stop:y.background="darkgrey",y.color="black";break;case de.scheduled_charging:e.chargepoint.isPluggedIn&&!e.chargepoint.isCharging&&!e.chargepoint.isLocked&&(y=g(y));break}return y}else return{background:"var(--color-bg)",color:"var(--color-bg)"}}),l=f(()=>se?se[e.chargepoint.chargeMode].icon:""),c=f(()=>re.pvBatteryPriority?"fa-car-battery":"fa-car"),u=f(()=>{let y="fa-ellipsis";return e.chargepoint.isLocked?y="fa-lock":e.chargepoint.isCharging?y=" fa-bolt":e.chargepoint.isPluggedIn&&(y="fa-plug"),"fa "+y});function g(y){let M=y.color;return y.color=y.background,y.background=M,y}return(y,M)=>(i(),h("div",yc,[n("div",wc,[n("button",{type:"button",class:"btn mx-1 mb-0 p-1 regularTextSize chargeButton shadow",style:R(o.value),"data-bs-toggle":"modal","data-bs-target":"#"+a},[n("div",$c,[n("span",Sc,[n("i",{class:z(u.value)},null,2),y.chargepoint.isCharging?(i(),h("span",xc,$(d(Be)(y.chargepoint.power)),1)):w("",!0)]),n("span",Pc,$(y.chargepoint.name),1),n("span",{class:"mx-2 m-0 badge rounded-pill smallTextSize modeIndicator",style:R(r.value)},[n("i",{class:z(["fa me-1",l.value])},null,2),j(" "+$(s.value)+" ",1),y.chargepoint.chargeMode==d(de).pv_charging&&d(re).isBatteryConfigured?(i(),h("span",Mc,[j(" ( "),n("i",{class:z(["fa m-0",c.value])},null,2),j(") ")])):w("",!0)],4)])],12,kc)]),m(Tt,{"modal-id":a},{title:v(()=>[j(" Lademodus für "+$(y.chargepoint.name),1)]),default:v(()=>[m(bc,{"cp-id":y.chargepoint.id},null,8,["cp-id"])]),_:1})]))}});const Ic=E(Cc,[["__scopeId","data-v-888cf4ca"]]),Bc={class:"row p-0 mt-0 mb-1 m-0"},Vc={class:"col p-0 m-0"},Tc={class:"container-fluid p-0 m-0"},Lc={class:"row p-0 m-0 d-flex justify-content-center"},Oc=I({__name:"ButtonBar",setup(t){return(e,a)=>(i(),h("div",Bc,[n("div",Vc,[n("div",Tc,[n("div",Lc,[(i(!0),h(W,null,F(d(T),(s,o)=>(i(),B(Ic,{key:o,chargepoint:s,"charge-point-count":Object.values(d(T)).length},null,8,["chargepoint","charge-point-count"]))),128))])])])]))}}),At=t=>(K("data-v-a5c2f113"),t=t(),ee(),t),Ac=At(()=>n("span",{class:"fas fa-car-battery me-2",style:{color:"var(--color-battery)"}}," ",-1)),Dc=At(()=>n("span",{class:"sh-title py-4"},"Speicher",-1)),Wc={class:"col m-0 mb-1 p-0 d-flex justify-content-between"},Ec={class:"col m-0 mt-3 mb-1 p-0 d-flex justify-content-between"},Gc=At(()=>n("span",{class:"todaystring mt-4 float-right"}," Heute:",-1)),jc=I({__name:"BatteryList",setup(t){const e=f(()=>N.batOut.power>0?"Liefert":A.batIn.power>0?"Lädt":"Bereit"),a=f(()=>Be(N.batOut.power+A.batIn.power));return(s,o)=>d(re).isBatteryConfigured?(i(),B(xe,{key:0,"variable-width":!0},{title:v(()=>[Ac,Dc]),default:v(()=>[n("div",Wc,[m(oe,{heading:"Ladestand:"},{default:v(()=>[m(Ot,{soc:d(re).batterySoc,class:"me-2"},null,8,["soc"])]),_:1}),m(oe,{heading:"Status:"},{default:v(()=>[n("span",null,$(e.value),1)]),_:1}),m(oe,{heading:"Leistung:"},{default:v(()=>[n("span",null,$(a.value),1)]),_:1})]),n("div",Ec,[m(oe,{heading:""},{default:v(()=>[Gc]),_:1}),m(oe,{heading:"Geladen:"},{default:v(()=>[n("span",null,$(d(Ze)(d(A).batIn.energy)),1)]),_:1}),m(oe,{heading:"Geliefert"},{default:v(()=>[n("span",null,$(d(Ze)(d(N).batOut.energy)),1)]),_:1})])]),_:1})):w("",!0)}});const kt=E(jc,[["__scopeId","data-v-a5c2f113"]]),Uc=t=>(K("data-v-453a6579"),t=t(),ee(),t),zc=Uc(()=>n("p",null,"not implemented yet",-1)),Nc=I({__name:"PriceChart",setup(t){return(e,a)=>d(De).isEtEnabled?(i(),B(xe,{key:0},{default:v(()=>[zc]),_:1})):w("",!0)}});const $t=E(Nc,[["__scopeId","data-v-453a6579"]]),qc={class:"d-flex float-right justify-content-end align-items-center"},Fc={key:0,class:"my-0 badge rounded-pill tempbadge mx-1"},Rc={class:"row m-1 mt-0 p-0"},Hc={class:"col m-0 mb-1 p-0 d-flex justify-content-between"},Jc=I({__name:"SHListItem",props:{device:{}},setup(t){const e=t,a=f(()=>e.device.status=="on"?"fa-toggle-on":e.device.status=="waiting"?"fa-spinner fa-spin":"fa-toggle-off"),s=f(()=>{let c="var(--color-switchRed)";switch(e.device.status){case"on":c="var(--color-switchGreen)";break;case"detection":c="var(--color-switchBlue)";break;case"timeout":c="var(--color-switchWhite)";break;case"waiting":c="var(--color-menu)";break;default:c="var(--color-switchRed)"}return{color:c}});function o(){e.device.isAutomatic||(e.device.status=="on"?Z("shSwitchOn",0,e.device.id):Z("shSwitchOn",1,e.device.id),q[e.device.id].status="waiting")}function r(){e.device.isAutomatic?Z("shSetManual",1,e.device.id):Z("shSetManual",0,e.device.id)}const l=f(()=>e.device.isAutomatic?"Auto":"Man");return(c,u)=>(i(),B(ua,{titlecolor:c.device.color,fullwidth:!0},{title:v(()=>[j($(c.device.name),1)]),buttons:v(()=>[n("div",qc,[(i(!0),h(W,null,F(c.device.temp,(g,y)=>(i(),h("span",{key:y,class:"p-0 m-0 align-items-center d-flex"},[y<c.device.tempConfigured?(i(),h("span",Fc,$(d(mn)(g)),1)):w("",!0)]))),128)),e.device.canSwitch?(i(),h("span",{key:0,class:z([a.value,"fa statusbutton mr-2 ms-4"]),style:R(s.value),onClick:o},null,6)):w("",!0),e.device.canSwitch?(i(),h("span",{key:1,class:"badge rounded-pill modebutton mx-2",onClick:r},$(l.value),1)):w("",!0)])]),default:v(()=>[n("div",Rc,[n("div",Hc,[m(oe,{heading:"Leistung:"},{default:v(()=>[m(Bt,{watt:c.device.power},null,8,["watt"])]),_:1}),m(oe,{heading:"Energie:"},{default:v(()=>[m(fa,{"watt-h":c.device.energy},null,8,["watt-h"])]),_:1}),m(oe,{heading:"Laufzeit:"},{default:v(()=>[j($(d(pn)(c.device.runningTime)),1)]),_:1})])])]),_:1},8,["titlecolor"]))}});const Qc=E(Jc,[["__scopeId","data-v-064f5a85"]]),ot=t=>(K("data-v-476a5661"),t=t(),ee(),t),Yc=ot(()=>n("span",{class:"fas fa-plug me-2",style:{color:"var(--color-devices)"}}," ",-1)),Zc={class:"sh-title py-4"},Xc=ot(()=>n("span",{class:"fa-solid fa-lg ps-1 fa-ellipsis-vertical"},null,-1)),Kc=[Xc],ed=ot(()=>n("span",{class:"fas fa-gear"}," ",-1)),td=ot(()=>n("span",{class:"fa-solid fa-lg ps-1 fa-circle-check"},null,-1)),ad=[td],nd=["id","onUpdate:modelValue","value"],od=["for"],sd=ot(()=>n("div",{class:"col-12 mb-3 pe-3 mt-0"},[n("button",{class:"btn btn-sm btn-secondary float-end"},"Schließen")],-1)),rd=[sd],ld=3,id=I({__name:"SmartHomeList",setup(t){const e=f(()=>Ie.value?a.value.reduce((l,c)=>{const u=l;let g=l[l.length-1];return g.length>=ld?l.push([c]):g.push(c),u},[[]]):[a.value]),a=f(()=>Object.values(q).filter(l=>l.configured));function s(l){return"Geräte"+(Ie.value&&e.value.length>1?"("+(l+1)+")":"")}function o(){r.value=!r.value}const r=le(!1);return(l,c)=>(i(),h(W,null,[(i(!0),h(W,null,F(e.value,(u,g)=>(i(),B(pt,{key:g,"variable-width":!0},{title:v(()=>[n("span",{onClick:o},[Yc,n("span",Zc,$(s(g)),1)])]),buttons:v(()=>[n("span",{class:"ms-2 pt-1",onClick:o},Kc)]),default:v(()=>[(i(!0),h(W,null,F(u,y=>(i(),B(Qc,{key:y.id,device:y},null,8,["device"]))),128))]),_:2},1024))),128)),r.value?(i(),B(pt,{key:0},{title:v(()=>[n("span",{class:"smarthome",onClick:o},[ed,j(" Einstellungen")])]),buttons:v(()=>[n("span",{class:"ms-2 pt-1",onClick:o},ad)]),default:v(()=>[m(O,{title:"Im Energie-Graph anzeigen:",icon:"fa-chart-column",fullwidth:!0},{default:v(()=>[(i(!0),h(W,null,F(a.value,(u,g)=>(i(),h("div",{key:g},[Le(n("input",{id:"check"+g,"onUpdate:modelValue":y=>u.showInGraph=y,class:"form-check-input",type:"checkbox",value:u},null,8,nd),[[_t,u.showInGraph]]),n("label",{class:"form-check-label px-2",for:"check"+g},$(u.name),9,od)]))),128))]),_:1}),n("div",{class:"row p-0 m-0",onClick:o},rd)]),_:1})):w("",!0)],64))}});const St=E(id,[["__scopeId","data-v-476a5661"]]),cd={class:"row py-0 px-0 m-0"},dd={"space-between":0,pagination:{clickable:!0},"slides-per-view":"1",class:"p-0 m-0 swiper-carousel",breakpoints:{992:{slidesPerView:3,spaceBetween:0}}},ud=I({__name:"CarouselFix",setup(t){return(e,a)=>(i(),h("div",cd,[n("swiper-container",dd,[n("swiper-slide",null,[n("div",{class:z([d(Ie)?"mb-0":"mb-5","flex-fill d-flex align-items-stretch"])},[ae(e.$slots,"item1",{},void 0,!0)],2)]),n("swiper-slide",null,[n("div",{class:z([d(Ie)?"mb-0":"mb-5","flex-fill d-flex align-items-stretch"])},[ae(e.$slots,"item2",{},void 0,!0)],2)]),n("swiper-slide",null,[n("div",{class:z([d(Ie)?"mb-0":"mb-5","flex-fill d-flex align-items-stretch"])},[ae(e.$slots,"item3",{},void 0,!0)],2)])])]))}});const hd=E(ud,[["__scopeId","data-v-3ef4f401"]]);function pd(t,e){t=="openWB/graph/boolDisplayLiveGraph"?re.displayLiveGraph=+e==1:t.match(/^openwb\/graph\/alllivevaluesJson[1-9][0-9]*$/i)?(gd(t,e),console.info("live graph full load")):t=="openWB/graph/lastlivevaluesJson"?(console.info("live graph update"),md(t,e)):t=="openWB/graph/config/duration"?te.duration=JSON.parse(e):console.warn("Ignored GRAPH message: ["+t+"]("+e+")")}function gd(t,e){if(!te.initialized){let a=[];const s=e.toString().split(`
`);s.length>1?a=s.map(l=>JSON.parse(l)):a=[];const o=t.match(/(\d+)$/g),r=o?o[0]:"";r!=""&&typeof te.rawDataPacks[+r-1]>"u"&&(te.rawDataPacks[+r-1]=a,te.initCounter++)}if(te.initCounter==16){const a=[];te.unsubscribeRefresh(),te.initialized=!0,te.rawDataPacks.map(s=>{s.map(o=>{const r=_a(o);a.push(r)})}),at(a),te.subscribeUpdates()}}function md(t,e){const a=JSON.parse(e),s=_a(a);te.graphRefreshCounter++,at(b.data.concat(s)),te.graphRefreshCounter>60&&te.activate()}function _a(t){const e={};e.date=fd(t.time).valueOf(),+t.grid>0?(e.gridPull=+t.grid,e.gridPush=0):+t.grid<=0?(e.gridPull=0,e.gridPush=-t.grid):(e.gridPull=0,e.gridPush=0),+t["pv-all"]>=0?(e.solarPower=+t["pv-all"],e.inverter=0):(e.solarPower=0,e.inverter=-t["pv-all"]),e.house=+t["house-power"],+t["bat-all-power"]>0?(e.batOut=0,e.batIn=+t["bat-all-power"]):+t["bat-all-power"]<0?(e.batOut=-t["bat-all-power"],e.batIn=0):(e.batOut=0,e.batIn=0),t["bat-all-soc"]?e.batterySoc=+t["bat-all-soc"]:e.batterySoc=0,e.charging=+t["charging-all"];for(let a=0;a<10;a++)t["cp"+a+"-power"]?e["cp"+a]=+t["cp"+a+"-power"]:e["cp"+a]=0;return e.selfUsage=e.solarPower-e.gridPush,e.selfUsage<0&&(e.selfUsage=0),e.devices=0,e}function fd(t){const e=new Date(Date.now()),a=864e5;let s=new Date;const o=Qe("%H:%M:%S")(t);return o&&(s=o,s.setDate(e.getDate()),s.setMonth(e.getMonth()),s.setFullYear(e.getFullYear()),s.getHours()>e.getHours()&&(s=new Date(s.getTime()-a))),s}let st={},va={};const Ue=["charging","house","batIn","devices"];let Re=[];function _d(t,e){const a=JSON.parse(e).entries;Re=Object.values(X).map(o=>"soc-ev"+o.id.toString()),Ue.map(o=>{k[o].energyPv=0,k[o].energyBat=0});const s=vd(a);at(s),Ue.map(o=>{k[o].energyPv=Math.round(k[o].energyPv*100)/100,k[o].energyBat=Math.round(k[o].energyBat*100)/100}),Sd(st,va),b.graphMode=="today"&&setTimeout(()=>ie(),3e5)}function vd(t){const e=[];let a={},s={};return t.map((o,r)=>{if(s=bd(o),r==0)st=s,st.chargingPv=0,st.chargingBat=0;else{const l=kd(s,a);e.push(l),Ue.map(c=>{k[c].energyPv+=l[c+"Pv"]/12,k[c].energyBat+=l[c+"Bat"]/12})}a=s}),va=s,e}function bd(t){const e={};if(e.devices=0,b.graphMode=="day"||b.graphMode=="today"){const a=Qe("%H:%M")(t.date);a&&(a.setMonth(J.date.getMonth()),a.setDate(J.date.getDate()),a.setFullYear(J.date.getFullYear()),e.date=a.getTime())}else{const a=Qe("%Y%m%d")(t.date);a&&(e.date=a.getDate())}return Object.entries(t.counter).forEach(a=>{e.gridPush=a[1].exported,e.gridPull=a[1].imported}),Object.entries(t.pv).forEach(([a,s])=>{a=="pv1"&&(e.solarPower=s.exported)}),Object.entries(t.bat).length>0?Object.entries(t.bat).forEach(([a,s])=>{a=="all"&&(e.batIn=s.imported,e.batOut=s.exported)}):(e.batIn=0,e.batOut=0),Object.entries(t.cp).forEach(([a,s])=>{a!="all"?(e[a]=s.imported,e["soc"+a]=s.soc):e.charging=s.imported}),Object.entries(t.ev).forEach(([a,s])=>{a!="all"&&(e["soc-"+a]=s.soc)}),Object.entries(t.sh).forEach(([a,s])=>{a!="all"&&(e[a]=s.imported),e.devices+=s.imported}),e}const yd=["cp0","cp1","cp2","cp3","cp4","cp5","cp6","cp7","cp8","cp9"],wd=["sh0","sh1","sh2","sh3","sh4"];function kd(t,e){const a={};a.date=t.date;const s=["gridPull","gridPush","solarPower","batIn","batOut","charging","devices"];return s.concat(yd).forEach(r=>{a[r]=Rt(t,e,r)}),s.concat(wd).forEach(r=>{a[r]=Rt(t,e,r)}),a.soc0=Re[0]?t[Re[0]]:0,a.soc1=Re[1]?t[Re[1]]:0,a.selfUsage=a.solarPower-a.gridPush,a.house=a.solarPower+a.gridPull+a.batOut-a.gridPush-a.batIn-a.charging-a.devices,a.inverter=0,a.gridPull+a.batOut+a.solarPower>0?Ue.map(r=>$d(r,a)):Ue.map(r=>{a[r+"Pv"]=0,a[r+"Bat"]=0}),a}function Rt(t,e,a){return t[a]!==void 0&&e[a]!==void 0?12*(t[a]-e[a])/1e3:0}function $d(t,e){e[t+"Pv"]=e[t]*(e.solarPower-e.gridPush)/(e.solarPower-e.gridPush+e.gridPull+e.batOut),e[t+"Bat"]=e[t]*e.batOut/(e.solarPower-e.gridPush+e.gridPull+e.batOut)}function Sd(t,e){k.pv.energy=(e.solarPower-t.solarPower)/1e3,k.evuIn.energy=(e.gridPull-t.gridPull)/1e3,k.batOut.energy=(e.batOut-t.batOut)/1e3,k.evuOut.energy=(e.gridPush-t.gridPush)/1e3,k.batIn.energy=(e.batIn-t.batIn)/1e3,k.charging.energy=(e.charging-t.charging)/1e3,k.devices.energy=(e.devices-t.devices)/1e3,k.charging.pvPercentage=Math.round((k.charging.energyPv+k.charging.energyBat)/k.charging.energy*100),k.house.energy=k.evuIn.energy+k.pv.energy+k.batOut.energy-k.evuOut.energy-k.batIn.energy-k.charging.energy-k.devices.energy,A.devices.energy=k.devices.energy,Ue.map(a=>{A[a].energyPv=k[a].energyPv,A[a].energyBat=k[a].energyBat,k[a].pvPercentage=Math.round((k[a].energyPv+k[a].energyBat)/k[a].energy*100),A[a].pvPercentage=k[a].pvPercentage})}let He={};const et=["charging","house","batIn","devices"];function xd(t,e){const a=JSON.parse(e).entries;et.map(s=>{k[s].energyPv=0,k[s].energyBat=0}),at(Pd(a)),Cd(He),Md(t,e)}function Pd(t){const e=[];let a={};return He={},t.map(s=>{a=ba(s),e.push(a),et.map(o=>{k[o].energyPv+=a[o+"Pv"],k[o].energyBat+=a[o+"Bat"]}),Object.keys(a).map(o=>{o!="date"&&(He[o]?He[o]+=a[o]:He[o]=a[o])})}),e}function Md(t,e){JSON.parse(e).entries.map(s=>{ba(s)})}function ba(t){const e={},a=Qe("%Y%m%d")(t.date);return a&&(e.date=a.getDate()),Object.entries(t.counter).forEach(o=>{e.gridPush=o[1].energy_exported,e.gridPull=o[1].energy_imported}),Object.entries(t.pv).forEach(([o,r])=>{o=="all"&&(e.solarPower=r.energy_exported)}),Object.entries(t.bat).length>0?Object.entries(t.bat).forEach(([o,r])=>{o=="all"&&(e.batIn=r.energy_imported,e.batOut=r.energy_exported)}):(e.batIn=0,e.batOut=0),Object.entries(t.cp).forEach(([o,r])=>{o!="all"?e[o]=r.energy_imported:e.charging=r.energy_imported}),Object.entries(t.ev).forEach(([o,r])=>{o!="all"&&(e["soc-"+o]=r.soc)}),e.devices=Object.entries(t.sh).reduce((o,r)=>(o+=r[1].energy_imported,o),0),e.selfUsage=e.solarPower-e.gridPush,e.house=e.solarPower+e.gridPull+e.batOut-e.gridPush-e.batIn-e.charging,e.inverter=0,e.gridPull+e.batOut+e.solarPower>0?et.map(o=>sa(o,e)):et.map(o=>{e[o+"Pv"]=0,e[o+"Bat"]=0}),e}function Cd(t){k.pv.energy=t.solarPower,k.evuIn.energy=t.gridPull,k.batOut.energy=t.batOut,k.evuOut.energy=t.gridPush,k.batIn.energy=t.batIn,k.charging.energy=t.charging,k.devices.energy=t.devices,k.house.energy=k.evuIn.energy+k.pv.energy+k.batOut.energy-k.evuOut.energy-k.batIn.energy-k.charging.energy-k.devices.energy,et.map(e=>{k[e].pvPercentage=Math.round((k[e].energyPv+k[e].energyBat)/k[e].energy*100)})}let Je={};const tt=["charging","house","batIn","devices"];function Id(t,e){const a=JSON.parse(e).entries;tt.map(s=>{k[s].energyPv=0,k[s].energyBat=0}),at(Bd(a)),Td(Je),Vd(t,e)}function Bd(t){const e=[];let a={};return Je={},t.map(s=>{a=ya(s),e.push(a),tt.map(o=>{k[o].energyPv+=a[o+"Pv"],k[o].energyBat+=a[o+"Bat"]}),Object.keys(a).map(o=>{o!="date"&&(a[o]<0&&(console.warn(`Negative energy value for ${o} in row ${a.date}. Ignoring the value.`),a[o]=0),Je[o]?Je[o]+=a[o]:Je[o]=a[o])})}),e}function Vd(t,e){JSON.parse(e).entries.map(s=>{ya(s)})}function ya(t){const e={},a=Qe("%Y%m%d")(t.date);return a&&(e.date=a.getMonth()+1),Object.entries(t.counter).forEach(o=>{e.gridPush=o[1].energy_exported/1e3,e.gridPull=o[1].energy_imported/1e3}),Object.entries(t.pv).forEach(([o,r])=>{o=="all"&&(e.solarPower=r.energy_exported/1e3)}),Object.entries(t.bat).length>0?Object.entries(t.bat).forEach(([o,r])=>{o=="all"&&(e.batIn=r.energy_imported/1e3,e.batOut=r.energy_exported/1e3)}):(e.batIn=0,e.batOut=0),Object.entries(t.cp).forEach(([o,r])=>{o!="all"?e[o]=r.energy_imported/1e3:e.charging=r.energy_imported/1e3}),Object.entries(t.ev).forEach(([o,r])=>{o!="all"&&(e["soc-"+o]=r.soc)}),e.devices=Object.entries(t.sh).reduce((o,r)=>(r[1].energy_imported>=0?o+=r[1].energy_imported/1e3:console.warn(`Negative energy value for device ${r[0]} in row ${e.date}. Ignoring this value`),o),0),e.selfUsage=e.solarPower-e.gridPush,e.house=e.solarPower+e.gridPull+e.batOut-e.gridPush-e.batIn-e.charging,e.inverter=0,e.gridPull+e.batOut+e.solarPower>0?tt.map(o=>sa(o,e)):tt.map(o=>{e[o+"Pv"]=0,e[o+"Bat"]=0}),e}function Td(t){k.pv.energy=t.solarPower,k.evuIn.energy=t.gridPull,k.batOut.energy=t.batOut,k.evuOut.energy=t.gridPush,k.batIn.energy=t.batIn,k.charging.energy=t.charging,k.devices.energy=t.devices,k.house.energy=k.evuIn.energy+k.pv.energy+k.batOut.energy-k.evuOut.energy-k.batIn.energy-k.charging.energy-k.devices.energy,tt.map(e=>{k[e].pvPercentage=Math.round((k[e].energyPv+k[e].energyBat)/k[e].energy*100)})}class Ld{constructor(e){p(this,"id");p(this,"dailyYieldExport",0);p(this,"dailyYieldImport",0);p(this,"exported",0);p(this,"faultState",0);p(this,"faultStr","");p(this,"imported",0);p(this,"power",0);p(this,"soc",0);this.id=e}}class Od{constructor(){p(this,"dailyExport",0);p(this,"dailyImport",0);p(this,"exported",0);p(this,"imported",0);p(this,"power",0);p(this,"soc",0)}}const pe=H({});H(new Od);function Ad(t){t in pe?console.info("Duplicate battery message: "+t):(pe[t]=new Ld(t),console.info("Added battery "+t))}function Dd(){Object.keys(pe).forEach(t=>{delete pe[parseInt(t)]})}function Wd(t,e){const a=Ed(t);if(a&&!(a in pe)){console.warn("Invalid battery index received: "+a);return}t=="openWB/bat/config/configured"?re.isBatteryConfigured=e=="true":t=="openWB/bat/get/power"?+e>0?(A.batIn.power=+e,N.batOut.power=0):(A.batIn.power=0,N.batOut.power=-e):t=="openWB/bat/get/soc"?re.batterySoc=+e:t=="openWB/bat/get/daily_exported"?N.batOut.energy=+e:t=="openWB/bat/get/daily_imported"?A.batIn.energy=+e:a&&(t.match(/^openwb\/bat\/[0-9]+\/get\/daily_yield_export$/i)?pe[a].dailyYieldExport=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/daily_yield_import$/i)?pe[a].dailyYieldImport=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/exported$/i)?pe[a].exported=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/fault_state$/i)?pe[a].faultState=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/fault_str$/i)?pe[a].faultStr=e:t.match(/^openwb\/bat\/[0-9]+\/get\/imported$/i)?pe[a].imported=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/power$/i)?pe[a].power=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/soc$/i)&&(pe[a].soc=+e))}function Ed(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch{console.warn("Parser error in getIndex for topic "+t)}}function Gd(t,e){t=="openWB/optional/et/active"?De.isEtEnabled=JSON.parse(e):t=="openWB/optional/et/get/price"?De.etCurrentPrice=parseFloat(e):t=="openWB/optional/et/config/max_price"?De.updateEtMaxPrice(parseFloat(e)):t=="openWB/optional/et/provider"&&(De.etProvider=JSON.parse(e))}function jd(t,e){const a=wa(t);if(a&&!(a in T)){console.warn("Invalid chargepoint id received: "+a);return}if(t=="openWB/chargepoint/get/power"?A.charging.power=+e:t=="openWB/chargepoint/get/daily_imported"&&(A.charging.energy=+e/1e3),t=="openWB/chargepoint/get/daily_exported")re.cpDailyExported=+e;else if(a){if(t.match(/^openwb\/chargepoint\/[0-9]+\/config$/i))if(T[a]){const s=JSON.parse(e);T[a].name=s.name,T[a].icon=s.name}else console.warn("invalid chargepoint index: "+a);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/state_str$/i))T[a].stateStr=JSON.parse(e);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/fault_str$/i))T[a].faultStr=JSON.parse(e);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/fault_state$/i))T[a].faultState=+e;else if(t.match(/^openWB\/chargepoint\/[0-9]+\/get\/power$/i))T[a].power=+e;else if(t.match(/^openWB\/chargepoint\/[0-9]+\/get\/daily_imported$/i))T[a].dailyYield=+e/1e3;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/plug_state$/i))T[a].isPluggedIn=e=="true";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/charge_state$/i))T[a].isCharging=e=="true";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/manual_lock$/i))T[a].updateIsLocked(e=="true");else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/enabled$/i))T[a].isEnabled=e=="1";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/phases_in_use/i))T[a].phasesInUse=+e;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/current/i))T[a].current=+e;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/log/i)){const s=JSON.parse(e);T[a].chargedSincePlugged=s.imported_since_plugged}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/soc$/i)){const s=JSON.parse(e);T[a].rangeCharged=s.range_charged,T[a].rangeUnit=s.range_unit}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/soc_config$/i))T[a].isSocManual=e=="manual";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/info$/i)){const s=JSON.parse(e);T[a].vehicleName=String(s.name),T[a].updateConnectedVehicle(+s.id)}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/config$/i)){const s=JSON.parse(e);switch(s.chargemode){case"instant_charging":T[a].updateChargeMode(de.instant_charging);break;case"pv_charging":T[a].updateChargeMode(de.pv_charging);break;case"scheduled_charging":T[a].updateChargeMode(de.scheduled_charging);break;case"standby":T[a].updateChargeMode(de.standby);break;case"stop":T[a].updateChargeMode(de.stop);break}T[a].chargeTemplate=s.charge_template,T[a].averageConsumption=s.average_consumption}}}function Ud(t,e){const a=wa(t);if(a!=null){if(!(a in X)){const s=new Ja(a);X[a]=s}t.match(/^openwb\/vehicle\/[0-9]+\/name$/i)?(Object.values(T).forEach(s=>{s.connectedVehicle==a&&(s.vehicleName=JSON.parse(e))}),X[a].name=JSON.parse(e)):t.match(/^openwb\/vehicle\/[0-9]+\/get\/soc$/i)?Object.values(T).forEach(s=>{s.connectedVehicle==a&&(s.soc=JSON.parse(e))}):t.match(/^openwb\/vehicle\/[0-9]+\/get\/range$/i)?X[a].range=+e:t.match(/^openwb\/vehicle\/[0-9]+\/charge_template$/i)?X[a].updateChargeTemplateId(+e):t.match(/^openwb\/vehicle\/[0-9]+\/ev_template$/i)&&X[a].updateEvTemplateId(+e)}}function zd(t,e){if(t.match(/^openwb\/vehicle\/template\/charge_template\/[0-9]+$/i)){const a=t.match(/[0-9]+$/i);if(a){const s=+a[0],o=JSON.parse(e);o.chargemode.scheduled_charging.plans||(o.chargemode.scheduled_charging.plans={}),o.time_charging.plans||(o.time_charging.plans={}),ue[s]=o,Nd(s,o)}}else if(t.match(/^openwb\/vehicle\/template\/charge_template\/[0-9]+\/time_charging\/plans\/[0-9]+$/i)){const a=t.match(/(?:\/)([0-9]+)(?:\/)/g),s=t.match(/[0-9]+$/i);if(a&&s){const o=+a[0].replace(/[^0-9]+/g,""),r=+s[0],l=JSON.parse(e);ue[o].time_charging.plans[r]=l}}else if(t.match(/^openwb\/vehicle\/template\/ev_template\/[0-9]+$/i)){const a=t.match(/[0-9]+$/i);if(a){const s=+a[0],o=JSON.parse(e);xt[s]=o}}}function Nd(t,e){Object.values(T).forEach(a=>{a.chargeTemplate==t&&(a.updateCpPriority(e.prio),a.updateInstantChargeLimitMode(e.chargemode.instant_charging.limit.selected),a.updateInstantTargetCurrent(e.chargemode.instant_charging.current),a.updateInstantTargetSoc(e.chargemode.instant_charging.limit.soc),a.updateInstantMaxEnergy(e.chargemode.instant_charging.limit.amount),a.updateScheduledCharging(e.time_charging.active),a.updatePvFeedInLimit(e.chargemode.pv_charging.feed_in_limit),a.updatePvMinCurrent(e.chargemode.pv_charging.min_current),a.updatePvMaxSoc(e.chargemode.pv_charging.max_soc),a.updatePvMinSoc(e.chargemode.pv_charging.min_soc),a.updatePvMinSocCurrent(e.chargemode.pv_charging.min_soc_current))})}function wa(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch{console.warn("Parser error in getIndex for topic "+t)}}function qd(t,e){t.match(/^openWB\/LegacySmarthome\/config\//i)?Fd(t,e):t.match(/^openWB\/LegacySmarthome\/Devices\//i)&&Rd(t,e)}function Fd(t,e){const a=ka(t);a!=null&&(a in q||It(a),t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_configured$/i)?q[a].configured=e!="0":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_name$/i)?q[a].name=e.toString():t.match(/^openWB\/LegacySmarthome\/config\/set\/Devices\/[0-9]+\/mode$/i)?q[a].isAutomatic=e=="0":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_canswitch$/i)?q[a].canSwitch=e=="1":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_temperatur_configured$/i)&&(q[a].tempConfigured=+e))}function Rd(t,e){const a=ka(t);if(a==null){console.warn("Smarthome: Missing index in "+t);return}if(a in q||It(a),t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/Watt$/i))q[a].power=+e,Hd("power");else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/RunningTimeToday$/i))q[a].runningTime=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor0$/i))q[a].temp[0]=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor1$/i))q[a].temp[1]=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor2$/i))q[a].temp[2]=+e;else if(t.match(/^openWB\/LegacySmartHome\/Devices\/[0-9]+\/Status$/i))switch(+e){case 10:q[a].status="off";break;case 11:q[a].status="on";break;case 20:q[a].status="detection";break;case 30:q[a].status="timeout";break;default:q[a].status="off"}}function Hd(t){switch(t){case"power":A.devices.power=Object.values(q).filter(e=>e.configured).reduce((e,a)=>e+a.power,0);break;case"energy":A.devices.energy=Object.values(q).filter(e=>e.configured).reduce((e,a)=>e+a.energy,0);break;default:console.error("Unknown category")}}function ka(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch{console.warn("Parser error in getIndex for topic "+t)}}const Jd=["openWB/counter/#","openWB/bat/#","openWB/pv/get/#","openWB/chargepoint/#","openWB/vehicle/#","openWB/general/chargemode_config/pv_charging/#","openWB/optional/et/#","openWB/system/#","openWB/LegacySmartHome/#"];function Qd(){Fa(Yd),Jd.forEach(t=>{Ce(t)}),ie()}function Yd(t,e){const a=e.toString();t.match(/^openwb\/counter\/[0-9]+\//i)?Zd(t,a):t.match(/^openwb\/counter\//i)?Xd(t,a):t.match(/^openwb\/bat\//i)?Wd(t,a):t.match(/^openwb\/pv\//i)?Kd(t,a):t.match(/^openwb\/chargepoint\//i)?jd(t,a):t.match(/^openwb\/vehicle\/template\//i)?zd(t,a):t.match(/^openwb\/vehicle\//i)?Ud(t,a):t.match(/^openwb\/general\/chargemode_config\/pv_charging\//i)?eu(t,a):t.match(/^openwb\/graph\//i)?pd(t,a):t.match(/^openwb\/log\/daily\//i)?_d(t,a):t.match(/^openwb\/log\/monthly\//i)?xd(t,a):t.match(/^openwb\/log\/yearly\//i)?Id(t,a):t.match(/^openwb\/optional\/et\//i)?Gd(t,a):t.match(/^openwb\/LegacySmartHome\//i)&&qd(t,a)}function Zd(t,e){const a=t.split("/");if(+a[2]==re.evuId)tu(t,e);else if(a[3]!="config")switch(a[4]){}}function Xd(t,e){if(t.match(/^openwb\/counter\/get\/hierarchy$/i)){const a=JSON.parse(e);if(a.length){Ya(),Dd();for(const s of a)s.type=="counter"&&(re.evuId=s.id);$a(a[0])}}else t.match(/^openwb\/counter\/set\/home_consumption$/i)?A.house.power=+e:t.match(/^openwb\/counter\/set\/daily_yield_home_consumption$/i)&&(A.house.energy=+e/1e3)}function $a(t){switch(t.type){case"counter":break;case"cp":Qa(t.id);break;case"bat":Ad(t.id);break}t.children.forEach(e=>$a(e))}function Kd(t,e){switch(t){case"openWB/pv/get/power":N.pv.power=-e;break;case"openWB/pv/get/daily_exported":N.pv.energy=+e/1e3;break}}function eu(t,e){const a=t.split("/");if(a.length>0)switch(a[4]){case"bat_prio":re.updatePvBatteryPriority(e=="true");break}}function tu(t,e){switch(t.split("/")[4]){case"power":+e>0?(N.evuIn.power=+e,A.evuOut.power=0):(N.evuIn.power=0,A.evuOut.power=-e);break;case"daily_imported":N.evuIn.energy=+e/1e3;break;case"daily_exported":A.evuOut.energy=+e/1e3;break}}const au=0,nu={host:location.hostname,port:location.protocol=="https:"?443:80,endpoint:"/ws",protocol:location.protocol=="https:"?"wss":"ws",clean:!0,connectTimeout:4e3,reconnectPeriod:4e3,clientId:Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,6),username:"openWB",password:"openWB"},Ht={topic:"",qos:au};let je;const{host:ou,port:su,endpoint:ru,...Sa}=nu,lu=`${Sa.protocol}://${ou}:${su}${ru}`;try{je=Jt.connect(lu,Sa),je.on("connect",()=>{console.info("MQTT connection successful")}),je.on("error",t=>{console.error("MQTT connection failed: ",t)})}catch(t){console.error("MQTT connect error: ",t)}function iu(t){je?je.on("message",t):console.error("MqttRegister: MQTT client not available")}function cu(t){Ht.topic=t;const{topic:e,qos:a}=Ht;je.subscribe(e,{qos:a},s=>{if(s){console.error("MQTT Subscription error: "+s);return}console.info("MQTT Subscription successful: "+t)})}const gt=H([]);let du=class xa{constructor(e,a,s,o){p(this,"name");p(this,"children");p(this,"count");p(this,"lastValue");this.name=e,this.children=a,this.count=s,this.lastValue=o}insert(e,a){if(e.length){const s=e.splice(1);if(e[0]==this.name)if(s.length){let o=!1;if(this.children.forEach(r=>{r.name==s[0]&&(r.insert(s,a),o=!0)}),!o){const r=new xa(s[0],[],0,"");r.insert(s,a),this.children.push(r)}}else this.count=this.count+1,this.lastValue=a}}};function uu(t,e){const a=t.split("/");if(a.length){let s=!1;if(gt.forEach(o=>{o.name==a[0]&&(o.insert(a,e),s=!0)}),!s){const o=new du(a[0],[],0,"");gt.push(o),o.insert(a,e)}}}const hu=["openWB/#"];function pu(){iu(gu),hu.forEach(t=>{cu(t)})}function gu(t,e){uu(t,e.toString())}const mu={class:"row p-0 mb-0 mx-0"},fu={class:"py-2 m-0"},_u={key:0},vu={key:1,style:{"background-color":"white"},class:"p-2"},bu={key:0,class:"col-md-9 m-0 p-0 ps-2"},yu={class:"container-fluid m-0 p-0"},wu=I({__name:"MqttNode",props:{node:{},level:{},hide:{type:Boolean},expandAll:{type:Boolean}},setup(t){const e=t;let a=le(!e.hide),s=le(!1);const o=f(()=>e.node.name),r=f(()=>[...e.node.children].sort((y,M)=>y.name<M.name?-1:1)),l=f(()=>e.node.count>0?"("+e.node.count+")":""),c=f(()=>e.node.children.length),u=f(()=>e.node.lastValue!=""?{"background-color":"lightgoldenrodyellow"}:{"background-color":"lightsteelblue"});function g(){c.value>0&&(a.value=!a.value),e.node.lastValue!=""&&(s.value=!s.value)}return(y,M)=>{const C=Da("MqttNode",!0);return i(),h("div",mu,[n("div",{class:"col-md m-0 px-2 node",style:R(u.value),onClick:g},[n("p",fu,$(o.value)+$(l.value),1),d(s)?(i(),h("hr",_u)):w("",!0),d(s)?(i(),h("p",vu,[n("code",null,$(e.node.lastValue),1)])):w("",!0)],4),(d(a)||e.expandAll)&&c.value>0?(i(),h("div",bu,[n("div",yu,[(i(!0),h(W,null,F(r.value,(S,P)=>(i(),B(C,{key:P,level:e.level+1,node:S,hide:!0,"expand-all":e.expandAll},null,8,["level","node","expand-all"]))),128))])])):w("",!0)])}}});const ku=E(wu,[["__scopeId","data-v-3dfd535f"]]),Dt=t=>(K("data-v-bf618b70"),t=t(),ee(),t),$u={class:"mqviewer"},Su={class:"row pt-2"},xu={class:"col"},Pu=Dt(()=>n("h3",{class:"mqtitle ps-2"},"MQTT Message Viewer",-1)),Mu=Dt(()=>n("hr",null,null,-1)),Cu=Dt(()=>n("hr",null,null,-1)),Iu={key:0},Bu=I({__name:"MQTTViewer",setup(t){ze(()=>{pu()});const e=le(!1);function a(){e.value=!e.value}const s=f(()=>e.value?"active":"");return(o,r)=>(i(),h("div",$u,[n("div",Su,[n("div",xu,[Pu,Mu,n("button",{class:z(["btn btn-small btn-outline-primary ms-2",s.value]),onClick:a}," Expand All ",2),Cu])]),d(gt)[0]?(i(),h("div",Iu,[(i(!0),h(W,null,F(d(gt)[0].children.sort((l,c)=>l.name<c.name?-1:1),(l,c)=>(i(),B(ku,{key:c,node:l,level:1,hide:!0,"expand-all":e.value},null,8,["node","expand-all"]))),128))])):w("",!0)]))}});const Vu=E(Bu,[["__scopeId","data-v-bf618b70"]]),Tu={class:"container-fluid p-0 m-0"},Lu={class:"row p-0 m-0"},Ou=n("button",{class:"btn btn-secondary float-end mt-0 ms-1","data-bs-toggle":"collapse","data-bs-target":"#themesettings"},[n("span",null,[n("i",{class:"fa-solid fa-rectangle-xmark"})])],-1),Au={class:"row m-0 p-0"},Du=n("div",{class:"row p-0 m-0"},[n("div",{class:"col-12 mb-3 pe-3 mt-0"},[n("button",{class:"btn btn-sm btn-secondary float-end","data-bs-toggle":"collapse","data-bs-target":"#themesettings"}," Schließen ")])],-1),Wu=I({__name:"ThemeSettings",emits:["resetArcs"],setup(t,{emit:e}){const a=[["Dunkel","dark"],["Hell","light"],["Blau","blue"]],s=[["3 kW","0"],["3,1 kW","1"],["3,14 kW","2"],["3,141 kW","3"],["3141 W","4"]],o=[["Orange","normal"],["Grün/Violett","standard"],["Bunt","advanced"]];return(r,l)=>(i(),h("div",Tu,[n("div",Lu,[m(pt,{"full-width":!0},{title:v(()=>[j(" Look & Feel ")]),buttons:v(()=>[Ou]),default:v(()=>[n("div",Au,[m(O,{title:"Farbschema",icon:"fa-adjust",infotext:"Hintergrundfarbe"},{default:v(()=>[m(Te,{modelValue:d(_).displayMode,"onUpdate:modelValue":l[0]||(l[0]=c=>d(_).displayMode=c),options:a},null,8,["modelValue"])]),_:1}),m(O,{title:"Grafik: Raster",icon:"fa-th",infotext:"Verwende ein Hintergrundraster in den Grafiken"},{default:v(()=>[m(me,{modelValue:d(_).showGrid,"onUpdate:modelValue":l[1]||(l[1]=c=>d(_).showGrid=c)},null,8,["modelValue"])]),_:1}),m(O,{title:"Variable Bogenlänge",icon:"fa-chart-area",infotext:"Im Graph 'Aktuelle Leistung' können die Bögen immer die volle Länge haben, oder entsprechend des aktuellen Gesamtleistung verkürzt dargestellt werden."},{default:v(()=>[m(me,{modelValue:d(_).showRelativeArcs,"onUpdate:modelValue":l[2]||(l[2]=c=>d(_).showRelativeArcs=c)},null,8,["modelValue"])]),_:1}),d(_).showRelativeArcs?(i(),B(O,{key:0,title:"Bögen zurücksetzen",icon:"fa-undo",infotext:"Durch Click auf den Button wird die Maximallänge der Bögen auf den aktuellen Wert gesetzt."},{default:v(()=>[d(_).showRelativeArcs?(i(),h("button",{key:0,class:"btn btn-secondary",onClick:l[3]||(l[3]=c=>e("resetArcs"))}," Reset ")):w("",!0)]),_:1})):w("",!0),m(O,{title:"Anzahl Dezimalstellen",icon:"fa-sliders-h",infotext:"Alle kW- und kWh-Werte werden mit der gewählten Anzahl an Stellen angezeigt."},{default:v(()=>[m(Lt,{modelValue:d(_).decimalPlaces,"onUpdate:modelValue":l[4]||(l[4]=c=>d(_).decimalPlaces=c),options:s},null,8,["modelValue"])]),_:1}),m(O,{title:"Farbschema Smart-Home-Geräte",icon:"fa-palette",infotext:"Für die Smart-Home-Geräte stehen mehrere Schemata zur Verfügung."},{default:v(()=>[m(Te,{modelValue:d(_).smartHomeColors,"onUpdate:modelValue":l[5]||(l[5]=c=>d(_).smartHomeColors=c),options:o},null,8,["modelValue"])]),_:1}),m(O,{title:"Kompakte Ladepunktliste",icon:"fa-list",infotext:"Zeige eine einzelne Ladepunktliste statt separater Element pro Ladepunkt."},{default:v(()=>[m(me,{modelValue:d(_).simpleCpList,"onUpdate:modelValue":l[6]||(l[6]=c=>d(_).simpleCpList=c)},null,8,["modelValue"])]),_:1}),m(O,{title:"Filter-Buttons",icon:"fa-filter",infotext:"Hauptseite mit Buttons zur Auswahl der Kategorie."},{default:v(()=>[m(me,{modelValue:d(_).showQuickAccess,"onUpdate:modelValue":l[7]||(l[7]=c=>d(_).showQuickAccess=c)},null,8,["modelValue"])]),_:1}),m(O,{title:"Animationen",icon:"fa-film",infotext:"Animationen anzeigen"},{default:v(()=>[m(me,{modelValue:d(_).showAnimations,"onUpdate:modelValue":l[8]||(l[8]=c=>d(_).showAnimations=c)},null,8,["modelValue"])]),_:1}),m(O,{title:"Breite Widgets",icon:"fa-desktop",infotext:"Widgets immer breit machen"},{default:v(()=>[m(me,{modelValue:d(_).preferWideBoxes,"onUpdate:modelValue":l[9]||(l[9]=c=>d(_).preferWideBoxes=c)},null,8,["modelValue"])]),_:1})]),Du]),_:1})])]))}}),qe=t=>(K("data-v-42ab5d0a"),t=t(),ee(),t),Eu={class:"container-fluid px-2 m-0 theme-colors"},Gu={id:"themesettings",class:"collapse"},ju={key:1,class:"row py-0 px-0 m-0"},Uu={key:2,class:"row py-0 m-0 d-flex justify-content-center"},zu={key:3,class:"nav nav-tabs nav-justified mx-1 mt-2",role:"tablist"},Nu=Wa('<a class="nav-link active" data-bs-toggle="tab" data-bs-target="#showAll" data-v-42ab5d0a><i class="fa-solid fa-lg fa-circle-info me-1" data-v-42ab5d0a></i><span class="d-none d-md-inline ms-2" data-v-42ab5d0a>Alles</span></a><a class="nav-link" data-bs-toggle="tab" data-bs-target="#chargepointlist" data-v-42ab5d0a><i class="fa-solid fa-lg fa-charging-station" data-v-42ab5d0a></i><span class="d-none d-md-inline ms-2" data-v-42ab5d0a>Ladepunkte</span></a>',2),qu={key:0,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#batterylist"},Fu=qe(()=>n("i",{class:"fa-solid fa-lg fa-car-battery"},null,-1)),Ru=qe(()=>n("span",{class:"d-none d-md-inline ms-2"},"Speicher",-1)),Hu=[Fu,Ru],Ju=qe(()=>n("a",{class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#smarthomelist"},[n("i",{class:"fa-solid fa-lg fa-plug"}),n("span",{class:"d-none d-md-inline ms-2"},"Smart Home")],-1)),Qu={key:1,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#etPricing"},Yu=qe(()=>n("i",{class:"fa-solid fa-lg fa-money-bill-1-wave"},null,-1)),Zu=qe(()=>n("span",{class:"d-none d-md-inline ms-2"},"Strompreis",-1)),Xu=[Yu,Zu],Ku={key:4,id:"cpContent",class:"tab-content mx-0 pt-1"},eh={id:"showAll",class:"tab-pane active",role:"tabpanel","aria-labelledby":"showall-tab"},th={class:"row py-0 m-0 d-flex justify-content-center"},ah={id:"chargepointlist",class:"tab-pane",role:"tabpanel","aria-labelledby":"chargepoint-tab"},nh={class:"row py-0 m-0 d-flex justify-content-center"},oh={id:"batterylist",class:"tab-pane",role:"tabpanel","aria-labelledby":"battery-tab"},sh={class:"row py-0 m-0 d-flex justify-content-center"},rh={id:"smarthomelist",class:"tab-pane",role:"tabpanel","aria-labelledby":"smarthome-tab"},lh={key:0,class:"row py-0 m-0 d-flex justify-content-center"},ih={id:"etPricing",class:"tab-pane",role:"tabpanel","aria-labelledby":"pricechart-tab"},ch={class:"row py-0 m-0 d-flex justify-content-center"},dh={class:"row p-2 mt-5"},uh={class:"col p-2"},hh=qe(()=>n("hr",null,null,-1)),ph={class:"d-flex justify-content-between"},gh={class:"mx-4"},mh={key:0},fh=I({__name:"ColorsTheme",setup(t){const e=f(()=>[A.evuOut,A.devices,A.charging].concat(Object.values(T).map(r=>r.toPowerItem())).concat(Object.values(Ye).filter(r=>r.configured&&r.showInGraph)).concat([A.batIn,A.house])),a=le(!1);function s(){oa()}function o(){a.value=!a.value}return ze(()=>{s(),window.addEventListener("resize",on),Qd()}),(r,l)=>(i(),h(W,null,[n("div",Eu,[n("div",Gu,[m(Wu)]),m(Oc),w("",!0),(i(),h("div",ju,[m(hd,null,{item1:v(()=>[m(En)]),item2:v(()=>[m(Ro)]),item3:v(()=>[m(ms,{"usage-details":e.value},null,8,["usage-details"])]),_:1})])),d(_).showQuickAccess?w("",!0):(i(),h("div",Uu,[m(wt),m(kt),m(St),m($t)])),d(_).showQuickAccess?(i(),h("nav",zu,[Nu,d(re).isBatteryConfigured?(i(),h("a",qu,Hu)):w("",!0),Ju,d(De).isEtEnabled?(i(),h("a",Qu,Xu)):w("",!0)])):w("",!0),d(_).showQuickAccess?(i(),h("div",Ku,[n("div",eh,[n("div",th,[m(wt),m(kt),m(St),m($t)])]),n("div",ah,[n("div",nh,[m(wt)])]),n("div",oh,[n("div",sh,[m(kt)])]),n("div",rh,[Object.keys(d(Ye)).length>0?(i(),h("div",lh,[m(St)])):w("",!0)]),n("div",ih,[n("div",ch,[m($t)])])])):w("",!0)]),n("div",dh,[n("div",uh,[hh,n("div",ph,[n("p",gh,"Screen Width: "+$(d(dt).x),1),n("button",{class:"btn btn-sm btn-secondary mx-4",onClick:o}," MQ Viewer ")]),a.value?(i(),h("hr",mh)):w("",!0),a.value?(i(),B(Vu,{key:1})):w("",!0)])])],64))}});const _h=E(fh,[["__scopeId","data-v-42ab5d0a"]]);const vh={},Pa=t=>(K("data-v-bfeed27e"),t=t(),ee(),t),bh=Pa(()=>n("nav",{class:"navbar navbar-expand-lg px-3 mb-0"},[n("div",{class:"container-lg"},[n("a",{href:"/",class:"navbar-brand"},[n("span",null,"openWB")]),n("button",{class:"navbar-toggler togglebutton ps-5",type:"button","data-bs-toggle":"collapse","data-bs-target":"#mainNavbar","aria-controls":"mainNavbar","aria-expanded":"false","aria-label":"Toggle navigation"},[n("span",{class:"fa fa-ellipsis-vertical"})]),n("div",{id:"mainNavbar",class:"collapse navbar-collapse justify-content-end"},[n("div",{class:"nav navbar-nav"},[n("a",{id:"navStatus",class:"nav-link",href:"../../settings/#/Status",target:"_parent"},"Status"),n("div",{class:"nav-item dropdown"},[n("a",{id:"loggingDropdown",class:"nav-link",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[j("Auswertungen "),n("i",{class:"fa-solid fa-caret-down"})]),n("div",{class:"dropdown-menu","aria-labelledby":"loggingDropdown"},[n("a",{href:"../../settings/#/Logging/ChargeLog",class:"dropdown-item",target:"_parent"},"Ladeprotokoll"),n("a",{href:"../../settings/#/Logging/Chart",class:"dropdown-item",target:"_parent"},"Diagramme")])]),n("div",{class:"nav-item dropdown"},[n("a",{id:"settingsDropdown",class:"nav-link",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[j("Einstellungen "),n("i",{class:"fa-solid fa-caret-down"})]),n("div",{class:"dropdown-menu","aria-labelledby":"settingsDropdown"},[n("a",{id:"navSettings",class:"nav-link",href:"../../settings/index.html",target:"_parent"},"openWB"),n("a",{class:"nav-link","data-bs-toggle":"collapse","data-bs-target":"#themesettings","aria-expanded":"false","aria-controls":"themeSettings"},[n("span",null,[j("Look&Feel"),n("span",{class:"fa-solid fa-caret-down"})])])])])])])])],-1)),yh=Pa(()=>n("hr",{class:"m-0 p-0 mb-2"},null,-1));function wh(t,e){return i(),h(W,null,[bh,yh],64)}const kh=E(vh,[["render",wh],["__scopeId","data-v-bfeed27e"]]),$h={id:"app",class:"m-0 p-0"},Sh={class:"container-lg p-0"},xh={class:"row p-0 m-0"},Ph={class:"col-12 p-0 m-0"},Mh=I({__name:"App",setup(t){return(e,a)=>(i(),h("div",$h,[m(kh),n("div",Sh,[n("div",xh,[n("div",Ph,[m(_h)])])])]))}});const Ch=Ea(Mh);Ga();Ch.mount("#app");
