var Ma=Object.defineProperty;var Ca=(t,e,a)=>e in t?Ma(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var f=(t,e,a)=>(Ca(t,typeof e!="symbol"?e+"":e,a),a);import{m as Jt,r as J,a as le,c as g,s as fe,d as I,p as Qt,b as Yt,w as Ia,o as i,e as h,t as k,f as n,n as z,g as B,h as y,i as ae,j as b,k as U,u,l as m,F as D,q,v as Ve,x as ft,y as Zt,z as vt,A as Mt,B as nt,C as De,D as Et,E as Ba,G as ot,H as Va,I as H,J as Ta,K as Ue,L as K,M as ee,N as La,O as Oe,P as Xt,Q as _t,R as Oa,S as Aa,T as Je,U as Wa,V as Da,W as Ea,X as Ga}from"./vendor-73164592.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function a(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=a(o);fetch(o.href,r)}})();const ja=0,Kt={host:location.hostname,port:location.protocol=="https:"?443:80,endpoint:"/ws",protocol:location.protocol=="https:"?"wss":"ws",connectTimeout:4e3,reconnectPeriod:4e3,clientId:Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,6)},st={topic:"",qos:ja};let Se;const{host:Ua,port:za,endpoint:Na,...ea}=Kt,Fa=`${ea.protocol}://${Ua}:${za}${Na}`;try{Se=Jt.connect(Fa,ea),Se.on("connect",()=>{console.info("MQTT connection successful")}),Se.on("error",t=>{console.error("MQTT connection failed: ",t)})}catch(t){console.error("MQTT connect error: ",t)}function qa(t){Se?Se.on("message",t):console.error("MqttRegister: MQTT client not available")}function Ce(t){st.topic=t;const{topic:e,qos:a}=st;Se.subscribe(e,{qos:a},s=>{if(s){console.error("MQTT Subscription error: "+s);return}})}function Ee(t){st.topic=t;const{topic:e}=st;Se.unsubscribe(e,a=>{if(a){console.error("MQTT Unsubscribe from "+t+" failed: "+a);return}})}function rt(t,e){Se.publish(t,e,{qos:0},s=>{s&&console.warn("MQTT publish error: ",s),console.info("Message sent: ["+t+"]("+e+")")})}function Ha(){return Kt.clientId}class Ra{constructor(e){f(this,"id");f(this,"name","Ladepunkt");f(this,"icon","Ladepunkt");f(this,"type","");f(this,"ev",0);f(this,"template",0);f(this,"connectedPhases",0);f(this,"phase_1",0);f(this,"autoPhaseSwitchHw",!1);f(this,"controlPilotInterruptionHw",!1);f(this,"isEnabled",!0);f(this,"isPluggedIn",!1);f(this,"isCharging",!1);f(this,"_isLocked",!1);f(this,"_connectedVehicle",0);f(this,"chargeTemplate",0);f(this,"evTemplate",0);f(this,"_chargeMode","pv_charging");f(this,"_hasPriority",!1);f(this,"currentPlan","");f(this,"averageConsumption",0);f(this,"vehicleName","");f(this,"rangeCharged",0);f(this,"rangeUnit","");f(this,"counter",0);f(this,"dailyYield",0);f(this,"energyPv",0);f(this,"energyBat",0);f(this,"pvPercentage",0);f(this,"faultState",0);f(this,"faultStr","");f(this,"phasesInUse",0);f(this,"power",0);f(this,"chargedSincePlugged",0);f(this,"stateStr","");f(this,"current",0);f(this,"phasesToUse",0);f(this,"soc",0);f(this,"isSocConfigured",!0);f(this,"isSocManual",!1);f(this,"color","white");f(this,"_scheduledCharging",!1);f(this,"_instantChargeLimitMode","");f(this,"_instantTargetCurrent",0);f(this,"_instantTargetSoc",0);f(this,"_instantMaxEnergy",0);f(this,"_pvFeedInLimit",!1);f(this,"_pvMinCurrent",0);f(this,"_pvMaxSoc",0);f(this,"_pvMinSoc",0);f(this,"_pvMinSocCurrent",0);this.id=e}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked=e,Z("cpLock",e,this.id)}updateIsLocked(e){this._isLocked=e}get connectedVehicle(){return this._connectedVehicle}set connectedVehicle(e){this._connectedVehicle=e,Z("cpVehicle",e,this.id)}updateConnectedVehicle(e){this._connectedVehicle=e}get chargeMode(){return this._chargeMode}set chargeMode(e){this._chargeMode=e,Z("chargeMode",e,this.id)}updateChargeMode(e){this._chargeMode=e}get hasPriority(){return this._hasPriority}set hasPriority(e){this._hasPriority=e,Z("cpPriority",e,this.id)}updateCpPriority(e){this._hasPriority=e}get scheduledCharging(){return this._scheduledCharging}set scheduledCharging(e){this._scheduledCharging=e,Z("cpScheduledCharging",e,this.id)}updateScheduledCharging(e){this._scheduledCharging=e}get instantTargetCurrent(){return this._instantTargetCurrent}set instantTargetCurrent(e){this._instantTargetCurrent=e,Z("cpInstantTargetCurrent",e,this.id)}updateInstantTargetCurrent(e){this._instantTargetCurrent=e}get instantChargeLimitMode(){return this._instantChargeLimitMode}set instantChargeLimitMode(e){this._instantChargeLimitMode=e,Z("cpInstantChargeLimitMode",e,this.id)}updateInstantChargeLimitMode(e){this._instantChargeLimitMode=e}get instantTargetSoc(){return this._instantTargetSoc}set instantTargetSoc(e){this._instantTargetSoc=e,Z("cpInstantTargetSoc",e,this.id)}updateInstantTargetSoc(e){this._instantTargetSoc=e}get instantMaxEnergy(){return this._instantMaxEnergy}set instantMaxEnergy(e){this._instantMaxEnergy=e,Z("cpInstantMaxEnergy",e,this.id)}updateInstantMaxEnergy(e){this._instantMaxEnergy=e}get pvFeedInLimit(){return this._pvFeedInLimit}set pvFeedInLimit(e){this._pvFeedInLimit=e,Z("cpPvFeedInLimit",e,this.id)}updatePvFeedInLimit(e){this._pvFeedInLimit=e}get pvMinCurrent(){return this._pvMinCurrent}set pvMinCurrent(e){this._pvMinCurrent=e,Z("cpPvMinCurrent",e,this.id)}updatePvMinCurrent(e){this._pvMinCurrent=e}get pvMaxSoc(){return this._pvMaxSoc}set pvMaxSoc(e){this._pvMaxSoc=e,Z("cpPvMaxSoc",e,this.id)}updatePvMaxSoc(e){this._pvMaxSoc=e}get pvMinSoc(){return this._pvMinSoc}set pvMinSoc(e){this._pvMinSoc=e,Z("cpPvMinSoc",e,this.id)}updatePvMinSoc(e){this._pvMinSoc=e}get pvMinSocCurrent(){return this._pvMinSocCurrent}set pvMinSocCurrent(e){this._pvMinSocCurrent=e,Z("cpPvMinSocCurrent",e,this.id)}updatePvMinSocCurrent(e){this._pvMinSocCurrent=e}toPowerItem(){return{name:this.name,power:this.power,energy:this.dailyYield,energyPv:this.energyPv,energyBat:this.energyBat,pvPercentage:this.pvPercentage,color:this.color,icon:this.icon}}}class Ja{constructor(e){f(this,"id");f(this,"name","");f(this,"_chargeTemplateId",0);f(this,"_evTemplateId",0);f(this,"tags",[]);f(this,"soc",0);f(this,"range",0);this.id=e}get chargeTemplateId(){return this._chargeTemplateId}set chargeTemplateId(e){this._chargeTemplateId=e,Z("vhChargeTemplateId",e,this.id)}updateChargeTemplateId(e){this._chargeTemplateId=e}get evTemplateId(){return this._evTemplateId}set evTemplateId(e){this._evTemplateId=e,Z("vhEvTemplateId",e,this.id)}updateEvTemplateId(e){this._evTemplateId=e}}var ce=(t=>(t.instant_charging="instant_charging",t.pv_charging="pv_charging",t.scheduled_charging="scheduled_charging",t.standby="standby",t.stop="stop",t))(ce||{});function ta(){return{frequency:{once:[new Date("2022-02-02"),new Date("2022-02-22")],selected:"daily",weekly:[!1,!1,!1,!1,!1,!1,!1]},name:"Neuer Plan",time:["10:00","16:00"],current:16}}function aa(){return{name:"Neuer Plan",timed:!1,time:"12:00",soc:80,frequency:{once:[new Date("2022-02-02"),new Date("2022-02-22")],selected:"daily",weekly:[!1,!1,!1,!1,!1,!1,!1]}}}const T=J({}),X=J({}),ue=J({}),xt=J({});function Qa(t){t in T||(T[t]=new Ra(t),T[t].color="var(--color-cp"+Object.values(T).length+")")}function Ya(){Object.keys(T).forEach(t=>{delete T[parseInt(t)]})}const Za={cpLock:"openWB/set/chargepoint/%/set/manual_lock",chargeMode:"openWB/set/vehicle/template/charge_template/%/chargemode/selected",cpPriority:"openWB/set/vehicle/template/charge_template/%/prio",cpScheduledCharging:"openWB/set/vehicle/template/charge_template/%/time_charging/active",pvBatteryPriority:"openWB/set/general/chargemode_config/pv_charging/bat_prio",chargeTemplate:"openWB/set/vehicle/template/charge_template/%",cpVehicle:"openWB/set/chargepoint/%/config/ev",cpInstantChargeLimitMode:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/selected",cpInstantTargetCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/current",cpInstantTargetSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/soc",cpInstantMaxEnergy:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/amount",cpPvFeedInLimit:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/feed_in_limit",cpPvMinCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_current",cpPvMaxSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/max_soc",cpPvMinSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_soc",cpPvMinSocCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_soc_current",etMaxPrice:"openWB/set/optional/et/max_price",vhChargeTemplateId:"openWB/set/vehicle/%/charge_template",vhEvTemplateId:"openWB/set/vehicle/%/ev_template",shSetManual:"openWB/set/LegacySmartHome/config/set/Devices/%/mode",shSwitchOn:"openWB/set/LegacySmartHome/config/set/Devices/%/device_manual_control"};function Z(t,e,a=0){if(isNaN(a)){console.warn("Invalid index");return}let s=Za[t];if(!s){console.warn("No topic for update type "+t);return}switch(t){case"chargeMode":case"cpPriority":case"cpScheduledCharging":case"cpInstantTargetCurrent":case"cpInstantChargeLimitMode":case"cpInstantTargetSoc":case"cpInstantMaxEnergy":case"cpPvFeedInLimit":case"cpPvMinCurrent":case"cpPvMaxSoc":case"cpPvMinSoc":case"cpPvMinSocCurrent":s=s.replace("%",T[a].chargeTemplate.toString());break;default:s=s.replace("%",String(a))}switch(typeof e){case"number":rt(s,JSON.stringify(+e));break;default:rt(s,JSON.stringify(e))}}function na(t){const e=ue[t];if(e){const a="openWB/set/vehicle/template/charge_template/"+t;rt(a,JSON.stringify(e))}}function Ct(t){rt("openWB/set/command/"+Ha()+"/todo",JSON.stringify(t))}class Xa{constructor(){f(this,"batterySoc",0);f(this,"isBatteryConfigured",!0);f(this,"chargeMode","0");f(this,"_pvBatteryPriority",!1);f(this,"displayLiveGraph",!0);f(this,"isEtEnabled",!0);f(this,"etMaxPrice",0);f(this,"etCurrentPrice",0);f(this,"cpDailyExported",0);f(this,"evuId",0);f(this,"etProvider","")}get pvBatteryPriority(){return this._pvBatteryPriority}set pvBatteryPriority(e){this._pvBatteryPriority=e,Z("pvBatteryPriority",e)}updatePvBatteryPriority(e){this._pvBatteryPriority=e}}const Ge=J({evuIn:{name:"Netz",color:"var(--color-evu)",icon:""},pv:{name:"PV",color:"var(--color-pv",icon:""},batOut:{name:"Bat >",color:"var(--color-battery)",icon:""},evuOut:{name:"Export",color:"var(--color-export)",icon:""},charging:{name:"Laden",color:"var(--color-charging)",icon:""},devices:{name:"Geräte",color:"var(--color-devices)",icon:""},batIn:{name:"> Bat",color:"var(--color-battery)",icon:""},house:{name:"Haus",color:"var(--color-house)",icon:""}}),$=J({evuIn:ie("evuIn"),pv:ie("pv"),batOut:ie("batOut"),evuOut:ie("evuOut"),charging:ie("charging"),devices:ie("devices"),batIn:ie("batIn"),house:ie("house")}),F=J({evuIn:ie("evuIn"),pv:ie("pv"),batOut:ie("batOut")}),A=J({evuOut:ie("evuOut"),charging:ie("charging"),devices:ie("devices"),batIn:ie("batIn"),house:ie("house")}),re=J(new Xa);le("");function ie(t){return{name:Ge[t].name,power:0,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:Ge[t].color,icon:Ge[t].icon}}class Ka{constructor(){f(this,"_showRelativeArcs",!1);f(this,"showTodayGraph",!0);f(this,"_graphPreference","today");f(this,"_usageStackOrder",0);f(this,"_displayMode","dark");f(this,"_showGrid",!1);f(this,"_smartHomeColors","normal");f(this,"_decimalPlaces",1);f(this,"_showQuickAccess",!0);f(this,"_simpleCpList",!1);f(this,"_showAnimations",!0);f(this,"_preferWideBoxes",!1);f(this,"_maxPower",4e3);f(this,"isEtEnabled",!1);f(this,"etPrice",20.5);f(this,"showRightButton",!0);f(this,"showLeftButton",!0);f(this,"animationDuration",300);f(this,"animationDelay",100)}get showRelativeArcs(){return this._showRelativeArcs}set showRelativeArcs(e){this._showRelativeArcs=e,he()}setShowRelativeArcs(e){this._showRelativeArcs=e}get graphPreference(){return this._graphPreference}set graphPreference(e){this._graphPreference=e,he()}setGraphPreference(e){this._graphPreference=e}get usageStackOrder(){return this._usageStackOrder}set usageStackOrder(e){this._usageStackOrder=e,he()}setUsageStackOrder(e){this._usageStackOrder=e}get displayMode(){return this._displayMode}set displayMode(e){this._displayMode=e,an(e)}setDisplayMode(e){this._displayMode=e}get showGrid(){return this._showGrid}set showGrid(e){this._showGrid=e,he()}setShowGrid(e){this._showGrid=e}get decimalPlaces(){return this._decimalPlaces}set decimalPlaces(e){this._decimalPlaces=e,he()}setDecimalPlaces(e){this._decimalPlaces=e}get smartHomeColors(){return this._smartHomeColors}set smartHomeColors(e){this._smartHomeColors=e,Gt(e),he()}setSmartHomeColors(e){this._smartHomeColors=e,Gt(e)}get showQuickAccess(){return this._showQuickAccess}set showQuickAccess(e){this._showQuickAccess=e,he()}setShowQuickAccess(e){this._showQuickAccess=e}get simpleCpList(){return this._simpleCpList}set simpleCpList(e){this._simpleCpList=e,he()}setSimpleCpList(e){this._simpleCpList=e}get showAnimations(){return this._showAnimations}set showAnimations(e){this._showAnimations=e,he()}setShowAnimations(e){this._showAnimations=e}get preferWideBoxes(){return this._preferWideBoxes}set preferWideBoxes(e){this._preferWideBoxes=e,he()}setPreferWideBoxes(e){this._preferWideBoxes=e}get maxPower(){return this._maxPower}set maxPower(e){this._maxPower=e,he()}setMaxPower(e){this._maxPower=e}}const v=J(new Ka);function oa(){on();const t=fe("html");t.classed("theme-dark",v.displayMode=="dark"),t.classed("theme-light",v.displayMode=="light"),t.classed("theme-blue",v.displayMode=="blue"),t.classed("shcolors-standard",v.smartHomeColors=="standard"),t.classed("shcolors-advanced",v.smartHomeColors=="advanced"),t.classed("shcolors-normal",v.smartHomeColors=="normal")}const en=992,lt=J({x:document.documentElement.clientWidth,y:document.documentElement.clientHeight});function tn(){lt.x=document.documentElement.clientWidth,lt.y=document.documentElement.clientHeight,oa()}const Ie=g(()=>lt.x>=en),se={stop:{mode:ce.stop,name:"Stop",color:"var(--color-fg)",icon:"fa-power-off"},standby:{mode:ce.standby,name:"Standby",color:"var(--color-axis",icon:"fa-pause"},pv_charging:{mode:ce.pv_charging,name:"PV",color:"var(--color-pv",icon:"fa-solar-panel"},scheduled_charging:{mode:ce.scheduled_charging,name:"Zielladen",color:"var(--color-battery)",icon:"fa-bullseye"},instant_charging:{mode:ce.instant_charging,name:"Sofort",color:"var(--color-charging)",icon:"fa-bolt"}};function he(){nn()}function an(t){const e=fe("html");e.classed("theme-dark",t=="dark"),e.classed("theme-light",t=="light"),e.classed("theme-blue",t=="blue"),he()}function Gt(t){const e=fe("html");e.classed("shcolors-normal",t=="normal"),e.classed("shcolors-standard",t=="standard"),e.classed("shcolors-advanced",t=="advanced")}const $e={chargemode:"Der Lademodus für diesen Ladepunkt",vehicle:"Das Fahrzeug, das an diesem Ladepounkt geladen wird",locked:"Diesen Ladepunkt sperren",priority:"Diesen Ladepunkt auf hohe Priorität setzen",timeplan:"An diesem Ladepunkt nach dem konfigurierten Zeitplan laden",minsoc:"Immer mindestens bis zum eingestellten Ladestand laden. Wenn notwendig mit Netzstrom.",minpv:"Durchgehend mit mindestens dem eingestellten Strom laden. Wenn notwendig mit Netzstrom."};function nn(){const t={};t.hideSH=Object.values(N).filter(e=>!e.showInGraph).map(e=>e.id),t.showLG=v.graphPreference=="live",t.displayM=v.displayMode,t.stackO=v.usageStackOrder,t.showGr=v.showGrid,t.decimalP=v.decimalPlaces,t.smartHomeC=v.smartHomeColors,t.relPM=v.showRelativeArcs,t.maxPow=v.maxPower,t.showQA=v.showQuickAccess,t.simpleCP=v.simpleCpList,t.animation=v.showAnimations,t.wideB=v.preferWideBoxes,document.cookie="openWBColorTheme="+JSON.stringify(t)+"; max-age=16000000"}function on(){const e=document.cookie.split(";").filter(a=>a.split("=")[0]==="openWBColorTheme");if(e.length>0){const a=JSON.parse(e[0].split("=")[1]);a.decimalP!==void 0&&v.setDecimalPlaces(+a.decimalP),a.smartHomeC!==void 0&&v.setSmartHomeColors(a.smartHomeC),a.hideSH!==void 0&&a.hideSH.map(s=>{N[s]==null&&It(s),N[s].showInGraph=!1}),a.showLG!==void 0&&v.setGraphPreference(a.showLG?"live":"today"),a.maxPow!==void 0&&v.setMaxPower(+a.maxPow),a.relPM!==void 0&&v.setShowRelativeArcs(a.relPM),a.displayM!==void 0&&v.setDisplayMode(a.displayM),a.stackO!==void 0&&v.setUsageStackOrder(a.stackO),a.showGr!==void 0&&v.setShowGrid(a.showGr),a.showQA!==void 0&&v.setShowQuickAccess(a.showQA),a.simpleCP!==void 0&&v.setSimpleCpList(a.simpleCP),a.animation!=null&&v.setShowAnimations(a.animation),a.wideB!=null&&v.setPreferWideBoxes(a.wideB)}}class sn{constructor(e){f(this,"id");f(this,"name","Gerät");f(this,"power",0);f(this,"status","off");f(this,"energy",0);f(this,"runningTime",0);f(this,"configured",!1);f(this,"_showInGraph",!0);f(this,"color","white");f(this,"canSwitch",!1);f(this,"countAsHouse",!1);f(this,"energyPv",0);f(this,"energyBat",0);f(this,"pvPercentage",0);f(this,"tempConfigured",0);f(this,"temp",[300,300,300]);f(this,"on",!1);f(this,"isAutomatic",!0);f(this,"icon","");this.id=e}get showInGraph(){return this._showInGraph}set showInGraph(e){this._showInGraph=e,he()}}const N=J({});function It(t){t in N?console.info("Duplicate sh device message: "+t):(N[t]=new sn(t),N[t].color="var(--color-sh"+Object.values(N).length+")")}const rn=["origin"],ln=I({__name:"PMSourceArc",props:{radius:{},cornerRadius:{},circleGapSize:{},emptyPower:{}},setup(t){const e=t,a=g(()=>{const s=Object.values(F).length;let o={name:"",power:e.emptyPower,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:"var(--color-bg)",icon:""},r=F;r["zz-empty"]=o;const l=Qt().value(p=>p.power).startAngle(-Math.PI/2+e.circleGapSize).endAngle(Math.PI/2-e.circleGapSize).sort(null),c=Yt().innerRadius(e.radius/6*5).outerRadius(e.radius).cornerRadius(e.cornerRadius).padAngle(0),d=fe("g#pmSourceArc");return d.selectAll("*").remove(),d.selectAll("sources").data(l(Object.values(r))).enter().append("path").attr("d",c).attr("fill",p=>p.data.color).attr("stroke",(p,w)=>w==s?p.data.power>0?"var(--color-scale)":"null":p.data.color),"pmSourceArc.vue"});return Ia(()=>{let s=F.pv.power+F.evuIn.power+F.batOut.power;s>v.maxPower&&(v.maxPower=s)}),(s,o)=>(i(),h("g",{id:"pmSourceArc",origin:a.value},null,8,rn))}}),cn=["origin"],dn=I({__name:"PMUsageArc",props:{radius:{},cornerRadius:{},circleGapSize:{},emptyPower:{}},setup(t){const e=t,a=g(()=>{let s={name:"",power:e.emptyPower,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:"var(--color-bg)",icon:""};const o=[A.evuOut,A.charging].concat(Object.values(N).filter(p=>p.configured&&!p.countAsHouse).sort((p,w)=>w.power-p.power)).concat([A.batIn,A.house]).concat(s),r=o.length-1,l=Qt().value(p=>p.power).startAngle(Math.PI*1.5-e.circleGapSize).endAngle(Math.PI/2+e.circleGapSize).sort(null),c=Yt().innerRadius(e.radius/6*5).outerRadius(e.radius).cornerRadius(e.cornerRadius),d=fe("g#pmUsageArc");return d.selectAll("*").remove(),d.selectAll("consumers").data(l(o)).enter().append("path").attr("d",c).attr("fill",p=>p.data.color).attr("stroke",(p,w)=>w==r?p.data.power>0?"var(--color-scale)":"null":p.data.color),"pmUsageArc.vue"});return(s,o)=>(i(),h("g",{id:"pmUsageArc",origin:a.value},null,8,cn))}});function Be(t,e=1){let a;if(t>=1e3&&e<4){switch(e){case 0:a=Math.round(t/1e3);break;case 1:a=Math.round(t/100)/10;break;case 2:a=Math.round(t/10)/100;break;case 3:a=Math.round(t)/1e3;break;default:a=Math.round(t/100)/10;break}return(a==null?void 0:a.toLocaleString(void 0,{minimumFractionDigits:e}))+" kW"}else return Math.round(t).toLocaleString(void 0)+" W"}function Qe(t,e=1,a=!1){let s;if(t>=1e3&&e<4){switch(e){case 0:s=Math.round(t/1e3);break;case 1:s=(Math.round(t/100)/10).toFixed(1);break;case 2:s=(Math.round(t/10)/100).toFixed(2);break;case 3:s=(Math.round(t)/1e3).toFixed(3);break;default:s=Math.round(t/100)/10;break}return s.toLocaleString(void 0,{minimumFractionDigits:e})+(a?" MWh":" kWh")}else return Math.round(t).toLocaleString(void 0)+(a?" kWh":" Wh")}function un(t){const e=Math.floor(t/3600),a=(t%3600/60).toFixed(0);return e>0?e+"h "+a+" min":a+" min"}function hn(t,e){return["Jan","Feb","März","April","Mai","Juni","Juli","Aug","Sep","Okt","Nov","Dez"][t]+" "+e}function pn(t){return(Math.round(t*10)/10).toLocaleString(void 0,{minimumFractionDigits:1})+"°"}const Bt=I({__name:"FormatWatt",props:{watt:{}},setup(t){const e=t,a=g(()=>Be(e.watt,v.decimalPlaces));return(s,o)=>k(a.value)}}),gn={key:0,id:"pmLabel"},mn=["x","y","fill","text-anchor"],fn=22,be=I({__name:"PMLabel",props:{x:{},y:{},data:{},props:{},anchor:{},labeltext:{},labelicon:{},labelcolor:{}},setup(t){const e=t,a=g(()=>e.labeltext?e.labeltext:e.props?e.props.icon+" ":e.labelicon?e.labelicon+" ":""),s=g(()=>e.labelcolor?e.labelcolor:e.props?e.props.color:""),o=g(()=>!e.data||e.data.power>0),r=g(()=>e.labeltext?"":"fas");return(l,c)=>o.value?(i(),h("g",gn,[n("text",{x:l.x,y:l.y,fill:s.value,"text-anchor":l.anchor,"font-size":fn,class:"pmLabel"},[n("tspan",{class:z(r.value)},k(a.value),3),n("tspan",null,[l.data!==void 0?(i(),B(Bt,{key:0,watt:l.data.power},null,8,["watt"])):y("",!0)])],8,mn)])):y("",!0)}}),vn={class:"wb-widget p-0 m-0 shadow"},_n={class:"d-flex justify-content-between"},bn={class:"m-4 me-0 mb-0"},yn=n("div",{class:"p-0"},"(title goes here)",-1),wn={class:"p-4 pb-0 ps-0 m-0",style:{"text-align":"right"}},kn={class:"px-4 pt-4 pb-2 wb-subwidget"},$n={class:"row"},Sn={class:"col"},xn={class:"container-fluid m-0 p-0"},Pn={key:0},Mn=n("hr",null,null,-1),Cn={class:"px-4 py-2 wb-subwidget"},In={class:"row"},Bn={class:"col"},Vn={class:"container-fluid m-0 p-0"},xe=I({__name:"WBWidget",props:{variableWidth:{type:Boolean},fullWidth:{type:Boolean}},setup(t){const e=t,a=g(()=>e.fullWidth?"col-12":e.variableWidth&&v.preferWideBoxes?"col-lg-6":"col-lg-4");return(s,o)=>(i(),h("div",{class:z(["p-2 m-0 d-flex flex-fill",a.value])},[n("div",vn,[n("div",_n,[n("h3",bn,[ae(s.$slots,"title",{},()=>[yn]),ae(s.$slots,"subtitle")]),n("div",wn,[ae(s.$slots,"buttons")])]),n("div",kn,[n("div",$n,[n("div",Sn,[n("div",xn,[ae(s.$slots,"default")])])])]),s.$slots.footer!=null?(i(),h("div",Pn,[Mn,n("div",Cn,[n("div",In,[n("div",Bn,[n("div",Vn,[ae(s.$slots,"footer")])])])])])):y("",!0)])],2))}}),Tn={id:"powermeter",class:"p-0 m-0"},Ln=["viewBox"],On=["transform"],An=["x"],ye=500,Me=20,jt=1,Wn=I({__name:"PowerMeter",setup(t){const e=ye,a=Math.PI/40,s=[[4],[4,6],[1,4,6],[0,2,4,6],[0,2,3,5,6]],o=[{x:-85,y:e/2*1/5},{x:0,y:e/2*1/5},{x:85,y:e/2*1/5},{x:-85,y:e/2*2/5},{x:0,y:e/2*2/5},{x:85,y:e/2*2/5},{x:0,y:e/2*3/5}],r=g(()=>ye/2-Me),l=g(()=>{let x="",G=Object.values(F).filter(Q=>Q.power>0);return G.length==1&&G[0].name=="PV"?x="Aktueller Verbrauch: ":x="Bezug/Verbrauch: ",x+Be(A.house.power+A.charging.power+A.devices.power+A.batIn.power,v.decimalPlaces)}),c=g(()=>{let x=F.pv.power+F.evuIn.power+F.batOut.power;return v.maxPower>x?Be(v.maxPower,v.decimalPlaces):Be(x,v.decimalPlaces)}),d=g(()=>Object.values(T)),p=g(()=>{let x=0;return v.showRelativeArcs&&(x=v.maxPower-(F.pv.power+F.evuIn.power+F.batOut.power)),x<0?0:x}),w=g(()=>[A.evuOut,A.charging,A.devices,A.batIn,A.house].filter(x=>x.power>0)),M=g(()=>s[w.value.length-1]);function C(x){return o[M.value[x]]}function S(x){return d.value[x].soc}function P(x){return x.length>12?x.slice(0,12-1)+".":x}return(x,G)=>(i(),B(xe,{"full-width":!0},{title:b(()=>[U(" Aktuelle Leistung ")]),default:b(()=>[n("figure",Tn,[(i(),h("svg",{viewBox:"0 0 "+ye+" "+u(e)},[n("g",{transform:"translate("+ye/2+","+u(e)/2+")"},[m(ln,{radius:r.value,"corner-radius":jt,"circle-gap-size":a,"empty-power":p.value},null,8,["radius","empty-power"]),m(dn,{"sh-device":u(N),radius:r.value,"corner-radius":jt,"circle-gap-size":a,"empty-power":p.value},null,8,["sh-device","radius","empty-power"]),m(be,{x:0,y:-u(e)/10*2,data:u(F).pv,props:u(Ge).pv,anchor:"middle",config:u(v)},null,8,["y","data","props","config"]),m(be,{x:0,y:-u(e)/10*3,data:u(F).evuIn,props:u(Ge).evuIn,anchor:"middle",config:u(v)},null,8,["y","data","props","config"]),m(be,{x:0,y:-u(e)/10,data:u(F).batOut,props:u(Ge).batOut,anchor:"middle",config:u(v)},null,8,["y","data","props","config"]),(i(!0),h(D,null,q(w.value,(Q,Y)=>(i(),B(be,{key:Y,x:C(Y).x,y:C(Y).y,data:Q,labelicon:Q.icon,labelcolor:Q.color,anchor:"middle",config:u(v)},null,8,["x","y","data","labelicon","labelcolor","config"]))),128)),d.value.length>0&&d.value[0].isSocConfigured?(i(),B(be,{key:0,x:-ye/2-Me/4+10,y:-u(e)/2+Me+5,labeltext:P(d.value[0].vehicleName)+": "+S(0)+"%",labelcolor:d.value[0].color,anchor:"start",config:u(v)},null,8,["x","y","labeltext","labelcolor","config"])):y("",!0),d.value.length>1&&d.value[1].isSocConfigured?(i(),B(be,{key:1,x:ye/2+Me/4-10,y:-u(e)/2+Me+5,labeltext:P(d.value[1].vehicleName)+": "+S(1)+"%",labelcolor:d.value[1].color,anchor:"end",config:u(v)},null,8,["x","y","labeltext","labelcolor","config"])):y("",!0),u(re).batterySoc>0?(i(),B(be,{key:2,x:-ye/2-Me/4+10,y:u(e)/2-Me+15,labeltext:"Speicher: "+u(re).batterySoc+"%",labelcolor:u(A).batIn.color,anchor:"start",config:u(v)},null,8,["x","y","labeltext","labelcolor","config"])):y("",!0),m(be,{x:0,y:0,labeltext:l.value,labelcolor:"var(--color-fg)",anchor:"middle",config:u(v)},null,8,["labeltext","config"]),u(v).showRelativeArcs?(i(),h("text",{key:3,x:ye/2-44,y:"2","text-anchor":"middle",fill:"var(--color-axis)","font-size":"12"}," Peak: "+k(c.value),9,An)):y("",!0)],8,On)],8,Ln))])]),_:1}))}}),Te=["charging","house","batIn","devices"];class Dn{constructor(){f(this,"data",[]);f(this,"_graphMode","")}get graphMode(){return this._graphMode}set graphMode(e){this._graphMode=e}}const _=J(new Dn);let it=!0,Ye=!0;function Ut(){it=!1}function zt(){Ye=!1}function En(t){Ye=t}function Xe(t){_.data=t}const te=J({refreshTopicPrefix:"openWB/graph/alllivevaluesJson",updateTopic:"openWB/graph/lastlivevaluesJson",configTopic:"openWB/graph/config/#",initialized:!1,initCounter:0,graphRefreshCounter:0,rawDataPacks:[],duration:0,activate(){_.data=[],this.unsubscribeUpdates(),this.subscribeRefresh(),Ce(this.configTopic),this.initialized=!1,this.initCounter=0,this.graphRefreshCounter=0,this.rawDataPacks=[]},deactivate(){this.unsubscribeRefresh(),this.unsubscribeUpdates(),Ee(this.configTopic)},subscribeRefresh(){for(let t=1;t<17;t++)Ce(this.refreshTopicPrefix+t)},unsubscribeRefresh(){for(let t=1;t<17;t++)Ee(this.refreshTopicPrefix+t)},subscribeUpdates(){Ce(this.updateTopic)},unsubscribeUpdates(){Ee(this.updateTopic)}}),R=J({topic:"openWB/log/daily/#",date:new Date,activate(){if(_.graphMode=="day"||_.graphMode=="today"){_.graphMode=="today"&&(this.date=new Date);const t=this.date.getFullYear().toString()+(this.date.getMonth()+1).toString().padStart(2,"0")+this.date.getDate().toString().padStart(2,"0");_.data=[],Ce(this.topic),Ct({command:"getDailyLog",data:{day:t}})}},deactivate(){Ee(this.topic)},back(){this.date=new Date(this.date.setTime(this.date.getTime()-864e5))},forward(){this.date=new Date(this.date.setTime(this.date.getTime()+864e5))},setDate(t){this.date=t},getDate(){return this.date}}),ve=J({topic:"openWB/log/monthly/#",month:new Date().getMonth()+1,year:new Date().getFullYear(),activate(){const t=this.year.toString()+this.month.toString().padStart(2,"0");_.data=[],Ce(this.topic),Ct({command:"getMonthlyLog",data:{month:t}})},deactivate(){Ee(this.topic)},back(){this.month-=1,this.month<1&&(this.month=12,this.year-=1),this.activate()},forward(){this.month-1<new Date().getMonth()&&(this.month=this.month+1,this.month>12&&(this.month=1,this.year+=1),this.activate())},getDate(){return new Date(this.year,this.month)}}),We=J({topic:"openWB/log/yearly/#",month:new Date().getMonth()+1,year:new Date().getFullYear(),activate(){const t=this.year.toString();_.data=[],Ce(this.topic),Ct({command:"getYearlyLog",data:{year:t}})},deactivate(){Ee(this.topic)},back(){this.month-=1,this.month<1&&(this.month=12,this.year-=1),this.activate()},forward(){this.month-1<new Date().getMonth()&&(this.month=this.month+1,this.month>12&&(this.month=1,this.year+=1),this.activate())},getDate(){return new Date(this.year,this.month)}});function de(t=!1){switch(_.graphMode==""?Gn(v.graphPreference):_.graphMode=="live"?v.graphPreference="live":v.graphPreference="today",t||(it=!0,Ye=!0),_.graphMode){case"live":R.deactivate(),ve.deactivate(),We.deactivate(),te.activate();break;case"today":te.deactivate(),ve.deactivate(),We.deactivate(),R.activate();break;case"day":te.deactivate(),ve.deactivate(),We.deactivate(),R.activate();break;case"month":te.deactivate(),R.deactivate(),We.deactivate(),ve.activate();break;case"year":te.deactivate(),R.deactivate(),ve.deactivate(),We.activate();break}}function Gn(t){_.graphMode=t}function Vt(t,e){e[t+"Pv"]=1e3*(e[t]*(e.solarPower-e.gridPush))/(e.solarPower-e.gridPush+e.gridPull+e.batOut),e[t+"Bat"]=1e3*(e[t]*e.batOut)/(e.solarPower-e.gridPush+e.gridPull+e.batOut)}function sa(t){$.pv.energy=t.solarPower*1e3,$.evuIn.energy=t.gridPull*1e3,$.batOut.energy=t.batOut*1e3,$.evuOut.energy=t.gridPush*1e3,$.batIn.energy=t.batIn*1e3,$.charging.energy=t.charging*1e3,$.devices.energy=t.devices*1e3,$.house.energy=$.evuIn.energy+$.pv.energy+$.batOut.energy-$.evuOut.energy-$.batIn.energy-$.charging.energy-$.devices.energy,Te.map(e=>{$[e].pvPercentage=Math.round(($[e].energyPv+$[e].energyBat)/$[e].energy*100)})}function Tt(){switch(_.graphMode){case"live":_.graphMode="today",v.showRightButton=!0,de();break;case"today":_.graphMode="day",R.date=new Date,R.back(),de();break;case"day":R.back(),de();break;case"month":ve.back();break}}function ra(){const t=new Date;switch(_.graphMode){case"live":break;case"today":_.graphMode="live",v.showRightButton=!1,de();break;case"day":R.forward(),R.date.getDate()==t.getDate()&&R.date.getMonth()==t.getMonth()&&R.date.getFullYear()==t.getFullYear()&&(_.graphMode="today"),de();break;case"month":ve.forward();break}}function la(){switch(_.graphMode){case"live":Tt();break;case"day":case"today":_.graphMode="month",de();break;case"month":_.graphMode="year",de();break}}function ia(){switch(_.graphMode){case"year":_.graphMode="month",de();break;case"month":_.graphMode="day",de();break;case"today":case"day":_.graphMode="live",de();break}}function Nt(t){if(_.graphMode=="day"||_.graphMode=="today"){R.setDate(t);const e=new Date;R.date.getDate()==e.getDate()&&R.date.getMonth()==e.getMonth()&&R.date.getFullYear()==e.getFullYear()?_.graphMode="today":_.graphMode="day",de()}}const jn=["origin","transform"],Un=I({__name:"PGSourceGraph",props:{width:{},height:{},margin:{}},setup(t){const e=t,a={house:"var(--color-house)",batIn:"var(--color-battery)",inverter:"var(--color-pv)",batOut:"var(--color-battery)",selfUsage:"var(--color-pv)",gridPush:"var(--color-export)",gridPull:"var(--color-evu)"};var s,o;const r=v.showAnimations?v.animationDuration:0,l=v.showAnimations?v.animationDelay:0,c=g(()=>{if(_.data.length>0){const j=fe("g#pgSourceGraph");_.graphMode=="month"||_.graphMode=="year"?L(j):W(j);const V=j.append("g").attr("class","axis");V.call(G.value),V.selectAll(".tick").attr("font-size",12),V.selectAll(".tick line").attr("stroke",Y.value).attr("stroke-width",Q.value),V.select(".domain").attr("stroke","var(--color-bg)")}return"pgSourceGraph.vue"}),d=g(()=>_.graphMode=="month"||_.graphMode=="year"?["gridPull","batOut","selfUsage","gridPush"]:["selfUsage","gridPush","batOut","gridPull"]),p=g(()=>Ve().domain([0,_.data.length-1]).range([0,e.width])),w=g(()=>ft().domain(Array.from({length:_.data.length},(j,V)=>V)).range([0,e.width+e.margin.right]).paddingInner(.4)),M=g(()=>Zt().keys(d.value)),C=g(()=>M.value(_.data)),S=g(()=>Ve().range([e.height-10,0]).domain(_.graphMode=="year"?[0,Math.ceil(P.value[1]*10)/10]:[0,Math.ceil(P.value[1])])),P=g(()=>{let j=vt(_.data,V=>Math.max(V.solarPower+V.gridPull+V.batOut,V.selfUsage+V.gridPush));return j[0]!=null&&j[1]!=null?j:[0,0]}),x=g(()=>_.graphMode=="month"||_.graphMode=="year")?-e.width-e.margin.right:-e.width,G=g(()=>Mt(S.value).tickSizeInner(x).ticks(4).tickFormat(j=>(j==0?"":Math.round(j*10)/10).toLocaleString(void 0))),Q=g(()=>v.showGrid?"0.5":"1"),Y=g(()=>v.showGrid?"var(--color-grid)":"var(--color-bg)");function W(j){const V=nt().x((ge,Ne)=>p.value(Ne)).y(S.value(0)),ne=nt().x((ge,Ne)=>p.value(Ne)).y0(ge=>S.value(ge[0])).y1(ge=>S.value(ge[1]));it?(j.selectAll("*").remove(),s=j.selectAll(".sourceareas").data(C.value).enter().append("path").attr("fill",(ge,Ne)=>a[d.value[Ne]]).attr("d",ge=>V(ge)),s.transition().duration(r).delay(l).ease(De).attr("d",ge=>ne(ge)),Ut()):s.data(C.value).transition().duration(0).ease(De).attr("d",ge=>ne(ge))}function L(j){it?(j.selectAll("*").remove(),o=j.selectAll(".sourcebar").data(C.value).enter().append("g").attr("fill",(V,ne)=>a[d.value[ne]]).selectAll("rect").data(V=>V).enter().append("rect").attr("x",(V,ne)=>w.value(ne)??0).attr("y",()=>S.value(0)).attr("height",0).attr("width",w.value.bandwidth()),o.transition().duration(r).delay(l).ease(De).attr("height",V=>S.value(V[0])-S.value(V[1])).attr("y",V=>S.value(V[1])),Ut()):(j.selectAll("*").remove(),o=j.selectAll(".sourcebar").data(C.value).enter().append("g").attr("fill",(V,ne)=>a[d.value[ne]]).selectAll("rect").data(V=>V).enter().append("rect").attr("x",(V,ne)=>w.value(ne)??0).attr("y",V=>S.value(V[1])).attr("width",w.value.bandwidth()).attr("height",V=>S.value(V[0])-S.value(V[1])))}return(j,V)=>(i(),h("g",{id:"pgSourceGraph",origin:c.value,transform:"translate("+j.margin.left+","+j.margin.top+")"},null,8,jn))}}),zn=["origin","transform"],Nn=I({__name:"PGUsageGraph",props:{width:{},height:{},margin:{},stackOrder:{}},setup(t){const e=t,a=[["house","charging","devices","batIn","inverter"],["charging","devices","house","batIn","inverter"],["devices","house","charging","batIn","inverter"]],s={house:"var(--color-house)",charging:"var(--color-charging)",batIn:"var(--color-battery)",inverter:"var(--color-pv)",batOut:"var(--color-battery)",selfUsage:"var(--color-pv)",gridPush:"var(--color-export)",gridPull:"var(--color-evu)",cp0:"var(--color-cp0)",cp1:"var(--color-cp1)",cp2:"var(--color-cp2)",cp3:"var(--color-cp3)",sh1:"var(--color-sh1)",sh2:"var(--color-sh2)",sh3:"var(--color-sh3)",sh4:"var(--color-sh4)",devices:"var(--color-devices)"};var o,r;const l=v.showAnimations?v.animationDuration:0,c=v.showAnimations?v.animationDelay:0,d=g(()=>{if(_.data.length>0){const W=fe("g#pgUsageGraph");_.graphMode=="month"||_.graphMode=="year"?Y(W):Q(W);const L=W.append("g").attr("class","axis");L.call(G.value),L.selectAll(".tick").attr("font-size",12).attr("color","var(--color-axis)"),v.showGrid?L.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):L.selectAll(".tick line").attr("stroke","var(--color-bg)"),L.select(".domain").attr("stroke","var(--color-bg)")}return"pgUsageGraph.vue"}),p=g(()=>Zt().keys(a[e.stackOrder])),w=g(()=>p.value(_.data)),M=g(()=>Ve().domain([0,_.data.length-1]).range([0,e.width])),C=g(()=>ft().domain(Array.from({length:_.data.length},(W,L)=>L)).range([0,e.width+e.margin.right]).paddingInner(.4)),S=g(()=>Ve().range([e.height+10,2*e.height]).domain(_.graphMode=="year"?[0,Math.ceil(P.value[1]*10)/10]:[0,Math.ceil(P.value[1])])),P=g(()=>{let W=vt(_.data,L=>L.house+L.charging+L.batIn+L.inverter+L.devices);return W[0]!=null&&W[1]!=null?W:[0,0]}),x=g(()=>_.graphMode=="month"||_.graphMode=="year")?-e.width-e.margin.right:-e.width,G=g(()=>Mt(S.value).tickSizeInner(x).ticks(4).tickFormat(W=>(W==0?"":Math.round(W*10)/10).toLocaleString(void 0)));function Q(W){const L=nt().x((V,ne)=>M.value(ne)).y(S.value(0)),j=nt().x((V,ne)=>M.value(ne)).y0(V=>S.value(V[0])).y1(V=>S.value(V[1]));v.showAnimations?Ye?(W.selectAll("*").remove(),o=W.selectAll(".usageareas").data(w.value).enter().append("path").attr("d",V=>L(V)).attr("fill",(V,ne)=>s[a[e.stackOrder][ne]]),o.transition().duration(300).delay(100).ease(De).attr("d",V=>j(V)),zt()):o.data(w.value).transition().duration(100).ease(De).attr("d",V=>j(V)):(W.selectAll("*").remove(),W.selectAll(".usageareas").data(w.value).enter().append("path").attr("d",V=>j(V)).attr("fill",(V,ne)=>s[a[e.stackOrder][ne]]))}function Y(W){Ye?(W.selectAll("*").remove(),r=W.selectAll(".usagebar").data(w.value).enter().append("g").attr("fill",(L,j)=>s[a[e.stackOrder][j]]).selectAll("rect").data(L=>L).enter().append("rect").attr("x",(L,j)=>C.value(j)??0).attr("y",()=>S.value(0)).attr("height",0).attr("width",C.value.bandwidth()),r.transition().duration(l).delay(c).ease(De).attr("y",L=>S.value(L[0])).attr("height",L=>S.value(L[1])-S.value(L[0])),zt()):(W.selectAll("*").remove(),r=W.selectAll(".usagebar").data(w.value).enter().append("g").attr("fill",(L,j)=>s[a[e.stackOrder][j]]).selectAll("rect").data(L=>L).enter().append("rect").attr("x",(L,j)=>C.value(j)??0).attr("y",L=>S.value(L[0])).attr("height",L=>S.value(L[1])-S.value(L[0])).attr("width",C.value.bandwidth()))}return(W,L)=>(i(),h("g",{id:"pgUsageGraph",origin:d.value,transform:"translate("+W.margin.left+","+W.margin.top+")"},null,8,zn))}}),Fn=["transform"],qn=["origin","transform"],Hn=["origin","transform"],Rn={key:0},Jn=["width","height"],Qn={key:1},Yn=["y","width","height"],yt=12,Zn=I({__name:"PGXAxis",props:{width:{},height:{},margin:{}},setup(t){const e=t,a=g(()=>Et(r.value).ticks(4).tickSizeInner(o.value).tickFormat(Ba("%H:%M"))),s=g(()=>Et(l.value).ticks(4).tickSizeInner(o.value).tickFormat((p,w)=>(w+1).toString())),o=g(()=>_.graphMode!=="month"&&_.graphMode!=="year"?v.showGrid?-(e.height/2-7):-10:0),r=g(()=>{let p=vt(_.data,w=>w.date);return p[0]&&p[1]?ot().domain(p).range([0,e.width]):ot().range([0,0])}),l=g(()=>ft().domain(Array.from({length:_.data.length},(p,w)=>w)).paddingInner(.4).range([0,e.width+e.margin.right])),c=g(()=>{let p=fe("g#PGXAxis");return p.selectAll("*").remove(),_.graphMode=="month"||_.graphMode=="year"?p.call(s.value):p.call(a.value),p.selectAll(".tick").attr("color","var(--color-axis)").attr("font-size",yt),v.showGrid?p.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):p.selectAll(".tick line").attr("stroke","var(--color-bg)"),p.select(".domain").attr("stroke","var(--color-bg)"),p.append("text").attr("x",-e.margin.left).attr("y",12).attr("fill","var(--color-axis)").attr("font-size",yt).text(_.graphMode=="year"?"MWh":"kWh").attr("text-anchor","start"),"PGXAxis.vue"}),d=g(()=>{let p=fe("g#PGXAxis2");return p.selectAll("*").remove(),v.showGrid&&(p.selectAll(".tick").attr("color","var(--color-axis)").attr("font-size",yt),p.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"),p.select(".domain").attr("stroke","var(--color-bg)")),"PGXAxis.vue"});return(p,w)=>(i(),h("g",{transform:"translate("+p.margin.left+","+p.margin.top+")"},[n("g",{id:"PGXAxis",class:"axis",origin:c.value,transform:"translate(0,"+(p.height/2-6)+")"},null,8,qn),n("g",{id:"PGXAxis2",class:"axis",origin:d.value,transform:"translate(0,"+(p.height/2+10)+")"},null,8,Hn),u(v).showGrid?(i(),h("g",Rn,[n("rect",{x:"0",y:"0",width:p.width,height:p.height/2-10,fill:"none",stroke:"var(--color-grid)","stroke-width":"0.5"},null,8,Jn)])):y("",!0),u(v).showGrid?(i(),h("g",Qn,[n("rect",{x:"0",y:p.height/2+10,width:p.width,height:p.height/2-10,fill:"none",stroke:"var(--color-grid)","stroke-width":"0.5"},null,8,Yn)])):y("",!0)],8,Fn))}}),Xn=["d"],Kn=["d","stroke"],eo=["x","y","text-anchor"],Ft=I({__name:"PgSoc",props:{width:{},height:{},margin:{},order:{}},setup(t){const e=t,a=g(()=>Object.values(X)),s=g(()=>{let M=vt(_.data,C=>C.date);return M[0]&&M[1]?ot().domain(M).range([0,e.width]):ot().range([0,0])}),o=g(()=>Ve().range([e.height-10,0]).domain([0,100])),r=g(()=>{let C=Va().x(S=>s.value(S.date)).y(S=>o.value(S["soc"+e.order])!=null?o.value(S["soc"+e.order]):o.value(0))(_.data);return C||""}),l=g(()=>a.value[e.order].name??""),c=g(()=>e.order==0?"var(--color-cp1)":"var(--color-cp2)"),d=g(()=>e.order==0?e.width-3:3),p=g(()=>_.data.length>0?e.order==0?o.value(_.data[_.data.length-1].soc0+2):o.value(_.data[0].soc1+2):0),w=g(()=>e.order==0?"end":"start");return(M,C)=>(i(),h(D,null,[n("path",{class:"soc-baseline",d:r.value,stroke:"var(--color-bg)","stroke-width":"1",fill:"none"},null,8,Xn),n("path",{class:"soc-dashes",d:r.value,stroke:c.value,"stroke-width":"1",style:{strokeDasharray:"3,3"},fill:"none"},null,8,Kn),n("text",{class:"cpname",x:d.value,y:p.value,style:H({fill:c.value,fontSize:10}),"text-anchor":w.value},k(l.value),13,eo)],64))}}),to=["transform"],ao=I({__name:"PgSocAxis",props:{width:{},height:{},margin:{}},setup(t){const e=t,a=g(()=>Ve().range([e.height-10,0]).domain([0,100])),s=g(()=>Ta(a.value).ticks(5).tickFormat(r=>r.toString()+"%"));function o(){let r=fe("g#PGSocAxis");r.call(s.value),r.selectAll(".tick").attr("font-size",12),r.selectAll(".tick line").attr("stroke","var(--color-bg)"),r.select(".domain").attr("stroke","var(--color-bg)")}return Ue(()=>{o()}),(r,l)=>(i(),h("g",{id:"PGSocAxis",class:"axis",transform:"translate("+(r.width-20)+",0)"},null,8,to))}}),no=t=>(K("data-v-e2c9f241"),t=t(),ee(),t),oo={class:"d-flex align-self-top justify-content-center align-items-center"},so={class:"input-group input-group-xs"},ro={key:0,class:"btn dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},lo={class:"dropdown-menu"},io={class:"table optiontable"},co=["onClick"],uo={key:1,class:"btn dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},ho={class:"dropdown-menu"},po={class:"table optiontable"},go=["onClick"],mo={key:2,class:"btn dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},fo={class:"dropdown-menu"},vo={class:"table optiontable"},_o=["onClick"],bo=no(()=>n("span",{class:"fa-solid fa-circle-check"},null,-1)),yo=[bo],wo=I({__name:"DateInput",props:{modelValue:{type:Date,required:!0},mode:{type:String,default:"day"}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,s=new Date().getFullYear();let o=Array.from({length:10},(C,S)=>s-S);const r=le(!0),l=[[0,1,2,3],[4,5,6,7],[8,9,10,11]],c=le(a.modelValue.getDate()),d=le(a.modelValue.getMonth()),p=le(a.modelValue.getFullYear()),w=g(()=>{const S=new Date(p.value,d.value,1).getDay();let P=0;switch(d.value){case 1:case 3:case 5:case 7:case 8:case 10:case 12:P=31;break;case 4:case 6:case 9:case 11:P=30;break;case 2:Math.trunc(p.value/4)*4==p.value&&(P=29)}let x=[],G=[0,0,0,0,0,0,0],Q=S;for(let Y=0;Y<P;Y++)G[Q]=Y+1,Q==6?(x.push(G),G=[0,0,0,0,0,0,0],Q=0):Q++;return Q<8&&x.push(G),x});function M(){e("update:modelValue",new Date(p.value,d.value,c.value)),r.value=!1}return(C,S)=>(i(),h("span",oo,[n("div",so,[a.mode=="day"||a.mode=="today"?(i(),h("button",ro,k(c.value),1)):y("",!0),n("div",lo,[n("table",io,[(i(!0),h(D,null,q(w.value,(P,x)=>(i(),h("tr",{key:x,class:""},[(i(!0),h(D,null,q(P,(G,Q)=>(i(),h("td",{key:Q},[G!=0?(i(),h("span",{key:0,type:"button",class:"btn optionbutton",onClick:Y=>c.value=G},k(G),9,co)):y("",!0)]))),128))]))),128))])]),a.mode!="year"&&a.mode!="live"?(i(),h("button",uo,k(d.value+1),1)):y("",!0),n("div",ho,[n("table",po,[(i(),h(D,null,q(l,(P,x)=>n("tr",{key:x,class:""},[(i(!0),h(D,null,q(P,(G,Q)=>(i(),h("td",{key:Q,class:"p-0 m-0"},[n("span",{type:"button",class:"btn btn-sm optionbutton",onClick:Y=>d.value=G},k(G+1),9,go)]))),128))])),64))])]),a.mode!="live"?(i(),h("button",mo,k(p.value),1)):y("",!0),n("div",fo,[n("table",vo,[(i(!0),h(D,null,q(u(o),(P,x)=>(i(),h("tr",{key:x,class:""},[n("td",null,[n("span",{type:"button",class:"btn optionbutton",onClick:G=>p.value=P},k(P),9,_o)])]))),128))])]),a.mode!="live"?(i(),h("button",{key:3,class:"button-outline-secondary",type:"button",onClick:M},yo)):y("",!0)])]))}});const E=(t,e)=>{const a=t.__vccOpts||t;for(const[s,o]of e)a[s]=o;return a},Ze=E(wo,[["__scopeId","data-v-e2c9f241"]]),ko={class:"btn-group m-0",role:"group","aria-label":"radiobar"},$o=["id","value"],So=I({__name:"RadioBarInput",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,s=g({get(){return a.modelValue},set(l){e("update:modelValue",l)}});function o(l){let c=a.options[l].color?a.options[l].color:"var(--color-fg)";return a.options[l].active?{color:"var(--color-bg)",background:c}:{color:c}}function r(l){let c=l.target;for(;c&&!c.value&&c.parentElement;)c=c.parentElement;c.value&&(s.value=c.value)}return(l,c)=>(i(),h("div",null,[n("div",ko,[(i(!0),h(D,null,q(l.options,(d,p)=>(i(),h("button",{id:"radio-"+d.value,key:p,class:z(["btn btn-outline-secondary btn-sm radiobutton mx-0 mb-0 px-2",d.value==s.value?"active":""]),value:d.value,style:H(o(p)),onClick:r},[n("span",{style:H(o(p))},[d.icon?(i(),h("i",{key:0,class:z(["fa-solid",d.icon])},null,2)):y("",!0),U(" "+k(d.text),1)],4)],14,$o))),128))])]))}});const ca=E(So,[["__scopeId","data-v-82ab6829"]]),bt=t=>(K("data-v-708803a4"),t=t(),ee(),t),xo=bt(()=>n("i",{class:"fa-solid fa-xl fa-chevron-circle-up"},null,-1)),Po=[xo],Mo=bt(()=>n("span",{class:"fa-solid fa-xl fa-chevron-circle-left arrowButton"},null,-1)),Co=[Mo],Io=bt(()=>n("span",{class:"fa-solid fa-xl fa-gear"},null,-1)),Bo=[Io],Vo=bt(()=>n("span",{class:"fa-solid fa-xl fa-circle-check"},null,-1)),To=[Vo],Lo=I({__name:"PgSelector",props:{widgetid:{},showLeftButton:{type:Boolean},showRightButton:{type:Boolean}},emits:["shiftLeft","shiftRight","shiftUp","shiftDown"],setup(t){const e=t,a=le(0),s=g(()=>{switch(_.graphMode){case"live":return`${te.duration} min`;case"today":return"heute";case"day":return R.date.getDate()+"."+(R.date.getMonth()+1)+".";case"month":return hn(ve.month-1,ve.year);case"year":return We.year.toString();default:return"???"}}),o=["live","today","day","month","year"],r=["Live","Heute","Tag","Monat","Jahr"],l=g({get(){return _.graphMode},set(Y){switch(Y){case"day":M();break;case"today":C();break;case"live":w();break;case"month":S();break;case"year":P()}}}),c=g(()=>{switch(_.graphMode){case"live":case"today":return R.getDate();case"month":return ve.getDate();default:return R.getDate()}});function d(Y){Nt(Y)}function p(){a.value+=1,a.value>2&&(a.value=0)}function w(){_.graphMode!="live"&&(_.graphMode="live",de())}function M(){_.graphMode!="day"&&_.graphMode!="today"&&(_.graphMode="day",de())}function C(){_.graphMode!="today"&&(_.graphMode="today",Nt(new Date))}function S(){_.graphMode!="month"&&(_.graphMode="month",de())}function P(){_.graphMode!="year"&&(_.graphMode="year",de())}const x=g(()=>a.value>0?{border:"1px solid var(--color-frame)"}:""),G=g(()=>a.value==1?"justify-content-between":"justify-content-end"),Q=g(()=>a.value==1?"justify-content-between":"justify-content-center");return(Y,W)=>(i(),h("div",{class:"d-flex flex-column justify-content-center pgselector rounded",style:H(x.value)},[a.value==2?(i(),B(ca,{key:0,id:"pgm2",modelValue:l.value,"onUpdate:modelValue":W[0]||(W[0]=L=>l.value=L),class:"m-2",options:o.map((L,j)=>({text:r[j],value:L,color:"var(--color-menu)",active:L==u(_).graphMode}))},null,8,["modelValue","options"])):y("",!0),a.value==1?(i(),h("span",{key:1,type:"button",class:z(["arrowButton d-flex align-self-center mb-3 mt-3",{disabled:!e.showLeftButton}]),onClick:W[1]||(W[1]=L=>Y.$emit("shiftUp"))},Po,2)):y("",!0),n("div",{class:z(["d-flex align-items-center",Q.value])},[a.value==1?(i(),h("span",{key:0,type:"button",class:z(["p-1",{disabled:!e.showLeftButton}]),onClick:W[2]||(W[2]=L=>Y.$emit("shiftLeft"))},Co,2)):y("",!0),a.value<2?(i(),h("span",{key:1,type:"button",class:"p-2 px-3 badge rounded-pill datebadge",onClick:p},k(s.value),1)):y("",!0),a.value==2?(i(),B(Ze,{key:2,"model-value":c.value,mode:u(_).graphMode,"onUpdate:modelValue":d},null,8,["model-value","mode"])):y("",!0),a.value==1?(i(),h("span",{key:3,id:"graphRightButton",type:"button",class:z(["arrowButton fa-solid fa-xl fa-chevron-circle-right p-1",{disabled:!e.showRightButton}]),onClick:W[3]||(W[3]=L=>Y.$emit("shiftRight"))},null,2)):y("",!0)],2),n("div",{class:z(["d-flex align-items-center",G.value])},[a.value==1?(i(),h("span",{key:0,type:"button",class:"p-1",onClick:p},Bo)):y("",!0),a.value==1?(i(),h("span",{key:1,id:"graphLeftButton",type:"button",class:z(["arrowButton fa-solid fa-xl fa-chevron-circle-down p-1",{disabled:!e.showLeftButton}]),onClick:W[4]||(W[4]=L=>Y.$emit("shiftDown"))},null,2)):y("",!0),a.value>0?(i(),h("span",{key:2,type:"button",class:"p-1",onClick:W[5]||(W[5]=L=>a.value=0)},To)):y("",!0)],2)],4))}});const da=E(Lo,[["__scopeId","data-v-708803a4"]]),Oo=t=>(K("data-v-2ce1d1f1"),t=t(),ee(),t),Ao=["viewBox"],Wo=["transform"],Do={id:"button"},Eo=["y"],Go=Oo(()=>n("tspan",{fill:"var(--color-menu)",class:"fas fa-lg"},k(""),-1)),jo=[Go],we=500,ke=500,Uo=2,zo="Leistung / Ladestand ",No=I({__name:"PowerGraph",setup(t){const e={top:10,right:20,bottom:10,left:25};function a(){let s=v.usageStackOrder+1;s>Uo&&(s=0),v.usageStackOrder=s,En(!0)}return(s,o)=>(i(),B(xe,{"full-width":!0},{title:b(()=>[U(k(zo))]),buttons:b(()=>[m(da,{widgetid:"graphsettings","show-left-button":!0,"show-right-button":!0,onShiftLeft:u(Tt),onShiftRight:u(ra),onShiftUp:u(la),onShiftDown:u(ia)},null,8,["onShiftLeft","onShiftRight","onShiftUp","onShiftDown"])]),default:b(()=>[n("figure",{id:"powergraph",class:"p-0 m-0",onClick:a},[(i(),h("svg",{viewBox:"0 0 "+we+" "+ke},[m(Un,{width:we-e.left-2*e.right,height:(ke-e.top-e.bottom)/2,margin:e},null,8,["width","height"]),m(Nn,{width:we-e.left-2*e.right,height:(ke-e.top-e.bottom)/2,margin:e,"stack-order":u(v).usageStackOrder},null,8,["width","height","stack-order"]),m(Zn,{width:we-e.left-2*e.right,height:ke-e.top-e.bottom,margin:e,"graph-data":u(_)},null,8,["width","height","graph-data"]),n("g",{transform:"translate("+e.left+","+e.top+")"},[(u(_).graphMode=="day"||u(_).graphMode=="today")&&Object.values(u(X)).length>0?(i(),B(Ft,{key:0,width:we-e.left-2*e.right,height:(ke-e.top-e.bottom)/2,margin:e,order:0},null,8,["width","height"])):y("",!0),(u(_).graphMode=="day"||u(_).graphMode=="today")&&Object.values(u(X)).length>1?(i(),B(Ft,{key:1,width:we-e.left-2*e.right,height:(ke-e.top-e.bottom)/2,margin:e,order:1},null,8,["width","height"])):y("",!0),u(_).graphMode=="day"||u(_).graphMode=="today"?(i(),B(ao,{key:2,width:we-e.left-e.right,height:(ke-e.top-e.bottom)/2,margin:e},null,8,["width","height"])):y("",!0)],8,Wo),n("g",Do,[n("text",{x:we,y:ke-10,color:"var(--color-menu)","text-anchor":"end"},jo,8,Eo)])],8,Ao))])]),_:1}))}});const Fo=E(No,[["__scopeId","data-v-2ce1d1f1"]]),qo=["id"],Ho=["x","width","height","fill"],Ro=["x","width","height"],Jo=["x","width","height"],Qo=I({__name:"EmBar",props:{item:{},xScale:{},yScale:{},margin:{},height:{},barcount:{},autarchy:{},autText:{}},setup(t){const e=t,a=g(()=>e.height-e.yScale(e.item.energy)-e.margin.top-e.margin.bottom),s=g(()=>e.item.energyPv>0?e.height-e.yScale(e.item.energyPv)-e.margin.top-e.margin.bottom:0),o=g(()=>e.item.energyPv>0?e.height-e.yScale(e.item.energyBat)-e.margin.top-e.margin.bottom:0);return(r,l)=>(i(),h("g",{id:"bar-"+e.item.name,transform:"scale(1,-1) translate (0,-445)"},[n("rect",{class:"bar",x:e.xScale(r.item.name),y:"0",width:e.xScale.bandwidth(),height:a.value,fill:r.item.color},null,8,Ho),n("rect",{class:"bar",x:e.xScale(r.item.name)+e.xScale.bandwidth()/6,y:"0",width:e.xScale.bandwidth()*2/3,height:s.value,fill:"var(--color-pv)","fill-opacity":"66%"},null,8,Ro),n("rect",{class:"bar",x:e.xScale(r.item.name)+e.xScale.bandwidth()/6,y:"0",width:e.xScale.bandwidth()*2/3,height:o.value,fill:"var(--color-pv)","fill-opacity":"66%"},null,8,Jo)],8,qo))}}),Yo={id:"emBargraph"},Zo=n("animateTransform",{"attribute-name":"transform",type:"scale",from:"1 0",to:"1 1",begin:"0s",dur:"2s"},null,-1),Xo=I({__name:"EMBarGraph",props:{plotdata:{},xScale:{},yScale:{},margin:{},height:{}},setup(t){const e=t;function a(o){if(o.name=="PV"){const r=_.graphMode=="live"||_.graphMode=="day"?F:$,c=(_.graphMode=="live"||_.graphMode=="day"?A:$).evuOut.energy,d=r.pv.energy;return Math.round((d-c)/d*100)}else if(o.name=="Netz"){const r=_.graphMode=="live"||_.graphMode=="day"?F:$,l=_.graphMode=="live"||_.graphMode=="day"?A:$,c=l.evuOut.energy,d=r.evuIn.energy,p=r.pv.energy,w=r.batOut.energy,M=l.batIn.energy;return Math.round((p+w-c-M)/(p+w+d-c-M)*100)}else return o.pvPercentage}function s(o){return o.name=="PV"?"Eigen":"Aut"}return(o,r)=>(i(),h("g",Yo,[(i(!0),h(D,null,q(e.plotdata,(l,c)=>(i(),h("g",{key:c},[m(Qo,{item:l,"x-scale":e.xScale,"y-scale":e.yScale,margin:e.margin,height:e.height,barcount:e.plotdata.length,"aut-text":s(l),autarchy:a(l)},null,8,["item","x-scale","y-scale","margin","height","barcount","aut-text","autarchy"])]))),128)),Zo]))}}),Ko=["origin"],es=I({__name:"EMYAxis",props:{yScale:{type:[Function,Object]},width:{},fontsize:{}},setup(t){const e=t,a=g(()=>Mt(e.yScale).tickFormat(o=>o>0?(o/1e3).toString():"").ticks(6).tickSizeInner(-e.width)),s=g(()=>{const o=fe("g#emYAxis");return o.attr("class","axis").call(a.value),o.append("text").attr("y",6).attr("dy","0.71em").attr("text-anchor","end").text("energy"),o.selectAll(".tick").attr("font-size",e.fontsize),v.showGrid?o.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):o.selectAll(".tick line").attr("stroke","var(--color-bg)"),o.select(".domain").attr("stroke","var(--color-bg)"),"emYAxis.vue"});return(o,r)=>(i(),h("g",{id:"emYAxis",class:"axis",origin:s.value},null,8,Ko))}}),ts=["id"],as=["x","y","font-size"],ns=["x","y","font-size","fill"],os=["x","y","font-size","fill"],ss=I({__name:"EmLabel",props:{item:{},xScale:{},yScale:{},margin:{},height:{},barcount:{},autarchy:{},autText:{}},setup(t){const e=t,a=g(()=>e.autarchy?e.yScale(e.item.energy)-25:e.yScale(e.item.energy)-10),s=g(()=>{let d=16,p=e.barcount;return p<=5?d=16:p==6?d=14:p>6&&p<=8?d=13:p==9?d=11:p==10?d=10:d=9,d}),o=g(()=>{let d=12,p=e.barcount;return p<=5?d=12:p==6?d=11:p>6&&p<=8||p==9?d=8:p==10?d=7:d=6,d});function r(d,p){return p.length>o.value?p.substring(0,o.value)+".":p}function l(){return e.autarchy?e.autText+": "+e.autarchy.toLocaleString(void 0)+" %":""}function c(){return"var(--color-pv)"}return(d,p)=>(i(),h("g",{id:"barlabel-"+e.item.name},[n("text",{x:e.xScale(d.item.name)+e.xScale.bandwidth()/2,y:a.value,"font-size":s.value,"text-anchor":"middle",fill:"var(--color-menu)"},k(u(Qe)(d.item.energy,u(v).decimalPlaces,u(_).graphMode=="year")),9,as),n("text",{x:e.xScale(d.item.name)+e.xScale.bandwidth()/2,y:e.yScale(d.item.energy)-10,"font-size":s.value-2,"text-anchor":"middle",fill:c()},k(l()),9,ns),n("text",{x:e.xScale(d.item.name)+e.xScale.bandwidth()/2,y:e.height-e.margin.bottom-5,"font-size":s.value,"text-anchor":"middle",fill:d.item.color,class:z(d.item.icon.length<=2?"fas":"")},k(r(d.item.name,d.item.icon)),11,os)],8,ts))}}),rs={id:"emBarLabels"},ls=I({__name:"EMLabels",props:{plotdata:{},xScale:{},yScale:{},height:{},margin:{}},setup(t){const e=t;function a(o){if(o.name=="PV"){const r=_.graphMode=="live"||_.graphMode=="day"?F:$,c=(_.graphMode=="live"||_.graphMode=="day"?A:$).evuOut.energy,d=r.pv.energy;return Math.round((d-c)/d*100)}else if(o.name=="Netz"){const r=_.graphMode=="live"||_.graphMode=="day"?F:$,l=_.graphMode=="live"||_.graphMode=="day"?A:$,c=l.evuOut.energy,d=r.evuIn.energy,p=r.pv.energy,w=r.batOut.energy,M=l.batIn.energy;return Math.round((p+w-c-M)/(p+w+d-c-M)*100)}else return o.pvPercentage}function s(o){return o.name=="PV"?"Eigen":"Aut"}return(o,r)=>(i(),h("g",rs,[(i(!0),h(D,null,q(e.plotdata,(l,c)=>(i(),h("g",{key:c},[m(ss,{item:l,"x-scale":e.xScale,"y-scale":e.yScale,margin:e.margin,height:e.height,barcount:e.plotdata.length,"aut-text":s(l),autarchy:a(l)},null,8,["item","x-scale","y-scale","margin","height","barcount","aut-text","autarchy"])]))),128))]))}}),is={id:"energymeter",class:"p-0 m-0"},cs={viewBox:"0 0 500 500"},ds=["transform"],us=["x"],qt=500,wt=500,Ht=12,hs="Energie",ps=I({__name:"EnergyMeter",props:{usageDetails:{}},setup(t){const e=t,a={top:25,bottom:30,left:25,right:0},s=g(()=>{let l=Object.values(F),c=e.usageDetails,d=Object.values($),p=[];switch(_.graphMode){default:case"live":case"today":p=l.concat(c).filter(w=>w.energy>0);break;case"day":case"month":case"year":p=d.filter(w=>w.energy>0)}return p}),o=g(()=>ft().range([0,qt-a.left-a.right]).domain(s.value.map(l=>l.name)).padding(.4)),r=g(()=>Ve().range([wt-a.bottom-a.top,15]).domain([0,La(s.value,l=>l.energy)]));return(l,c)=>(i(),B(xe,{"full-width":!0},{title:b(()=>[U(k(hs))]),buttons:b(()=>[m(da,{widgetid:"graphsettings","show-left-button":!0,"show-right-button":!0,onShiftLeft:u(Tt),onShiftRight:u(ra),onShiftUp:u(la),onShiftDown:u(ia)},null,8,["onShiftLeft","onShiftRight","onShiftUp","onShiftDown"])]),default:b(()=>[n("figure",is,[(i(),h("svg",cs,[n("g",{transform:"translate("+a.left+","+a.top+")"},[m(Xo,{plotdata:s.value,"x-scale":o.value,"y-scale":r.value,height:wt,margin:a},null,8,["plotdata","x-scale","y-scale"]),m(es,{"y-scale":r.value,width:qt,fontsize:Ht,config:u(v)},null,8,["y-scale","config"]),n("text",{x:-a.left,y:"-15",fill:"var(--color-axis)","font-size":Ht},k(u(_).graphMode=="year"?"MWh":"kWh"),9,us),m(ls,{plotdata:s.value,"x-scale":o.value,"y-scale":r.value,height:wt,margin:a,config:u(v)},null,8,["plotdata","x-scale","y-scale","config"])],8,ds)]))])]),_:1}))}}),gs={class:"d-flex flex-column align-items-center"},ms={class:"heading mt-1"},fs={class:"mx-1"},vs={class:"d-flex my-0 align-items-center content"},_s=I({__name:"InfoItem",props:{heading:{}},setup(t){const e=t;return(a,s)=>(i(),h("span",gs,[n("span",ms,k(e.heading),1),n("span",fs,[n("span",vs,[ae(a.$slots,"default",{},void 0,!0)])])]))}});const oe=E(_s,[["__scopeId","data-v-5512398e"]]),bs={class:"row p-0 m-0"},ys={class:"col p-0 m-0"},ws={class:"d-flex justify-content-between"},ks={class:"col p-0 m-0",style:{"text-align":"right"}},$s={class:"container-fluid m-0 p-0"},Ss=I({__name:"WbSubwidget",props:{titlecolor:{},fullwidth:{type:Boolean}},setup(t){const e=t,a=g(()=>e.titlecolor?{color:e.titlecolor}:{color:"var(--color-fg)"}),s=g(()=>e.fullwidth?"col-lg-12":"col-lg-4");return(o,r)=>(i(),h("div",{class:z(["px-4 pt-3 mb-2 wb-subwidget m-0",s.value])},[n("div",bs,[n("div",ys,[n("div",ws,[n("h3",{class:"m-0 mb-2",style:H(a.value)},[ae(o.$slots,"title",{},void 0,!0)],4),n("div",ks,[ae(o.$slots,"buttons",{},void 0,!0)])])])]),n("div",$s,[ae(o.$slots,"default",{},void 0,!0)])],2))}});const ua=E(Ss,[["__scopeId","data-v-263a58f0"]]),xs=t=>(K("data-v-85517e3c"),t=t(),ee(),t),Ps={class:"col-12 m-0 mb-0 px-0 py-0 configitem"},Ms={class:"titlecolumn m-0 p-0 d-flex align-items-center"},Cs=xs(()=>n("i",{class:"me-1 fa-solid fa-sm fa-circle-info"},null,-1)),Is={class:"row ms-1 mb-2 p-0 pt-2 d-flex align-items-center"},Bs={class:"col me-1 p-0 ps-4 selectors"},Vs={class:"d-flex justify-content-stretch align-items-center"},Ts=I({__name:"ConfigItem",props:{title:{},infotext:{},icon:{},fullwidth:{type:Boolean}},setup(t){const e=t,a=le(!1);function s(){a.value=!a.value}const o=g(()=>{let r={color:"var(--color-charging)"};return a.value&&(r.color="var(--color-battery)"),r});return(r,l)=>(i(),B(ua,{fullwidth:!!r.fullwidth},{default:b(()=>[n("div",Ps,[n("div",Ms,[n("span",{class:"d-flex align-items-baseline m-0 p-0",onClick:s},[e.icon?(i(),h("i",{key:0,class:z(["fa-solid fa-sm m-0 p-0 me-2 item-icon",e.icon])},null,2)):y("",!0),U(" "+k(r.title),1)]),n("span",null,[e.infotext?(i(),h("i",{key:0,class:"fa-solid fa-sm fa-circle-question ms-4 me-2",style:H(o.value),onClick:s},null,4)):y("",!0)])]),a.value?(i(),h("p",{key:0,class:"infotext shadow m-0 ps-2 mb-1 p-1",onClick:s},[Cs,U(" "+k(r.infotext),1)])):y("",!0),n("div",Is,[n("div",Bs,[n("span",Vs,[n("span",null,[ae(r.$slots,"default",{},void 0,!0)])])])])])]),_:3},8,["fullwidth"]))}});const O=E(Ts,[["__scopeId","data-v-85517e3c"]]),ha=t=>(K("data-v-d228e49b"),t=t(),ee(),t),Ls={class:"d-flex flex-fill justify-content-between"},Os=ha(()=>n("i",{class:"fa fa-xl fa-minus-square me-2"},null,-1)),As=[Os],Ws=["id","min","max","step"],Ds=ha(()=>n("i",{class:"fa fa-xl fa-plus-square ms-2"},null,-1)),Es=[Ds],Gs={class:"d-flex justify-content-between align-items-start"},js={class:"minlabel ps-4"},Us={class:"valuelabel"},zs={class:"maxlabel pe-4"},Ns=I({__name:"RangeInput",props:{id:{},min:{},max:{},step:{},unit:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,s=g({get(){return a.modelValue},set(l){e("update:modelValue",l)}});function o(){s.value>a.min&&(s.value=s.value-a.step)}function r(){s.value<a.max&&(s.value=s.value+a.step)}return(l,c)=>(i(),h(D,null,[n("span",Ls,[n("span",{class:"minusButton",onClick:o},As),Oe(n("input",{id:l.id,"onUpdate:modelValue":c[0]||(c[0]=d=>s.value=d),type:"range",class:"form-range flex-fill",min:l.min,max:l.max,step:l.step},null,8,Ws),[[Xt,s.value,void 0,{number:!0}]]),n("span",{class:"plusButton",onClick:r},Es)]),n("span",Gs,[n("span",js,k(l.min),1),n("span",Us,k(s.value)+" "+k(l.unit),1),n("span",zs,k(l.max),1)])],64))}});const _e=E(Ns,[["__scopeId","data-v-d228e49b"]]),Fs=["id","value"],qs=I({__name:"RadioInput",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,s=g({get(){return a.modelValue},set(l){e("update:modelValue",l)}});function o(l){return a.options[l][2]?{color:a.options[l][2]}:{color:"var(--color-fg)"}}function r(l){let c=l.target;for(;c&&!c.value&&c.parentElement;)c=c.parentElement;c.value&&(s.value=c.value)}return(l,c)=>(i(),h("div",null,[(i(!0),h(D,null,q(l.options,(d,p)=>(i(),h("button",{id:"radio-"+d[1],key:p,class:z(["btn btn-outline-secondary radiobutton me-2 mb-0 px-2",d[1]==s.value?"active":""]),value:d[1],style:H(o(p)),onClick:r},[n("span",{style:H(o(p))},[d[3]?(i(),h("i",{key:0,class:z(["fa-solid",d[3]])},null,2)):y("",!0),U(" "+k(d[0]),1)],4)],14,Fs))),128))]))}});const Le=E(qs,[["__scopeId","data-v-df222cbe"]]),Hs=t=>(K("data-v-ccd11e7e"),t=t(),ee(),t),Rs={class:"mt-2"},Js=Hs(()=>n("p",{class:"heading ms-1"},"Sofortladen:",-1)),Qs={key:0},Ys=I({__name:"CPConfigInstant",props:{chargepoint:{}},setup(t){const a=le(t.chargepoint),s=[{name:"keine",id:"none"},{name:"EV-SoC",id:"soc"},{name:"Energiemenge",id:"amount"}];return(o,r)=>(i(),h("div",Rs,[Js,m(O,{title:"Stromstärke",icon:"fa-bolt",fullwidth:!0},{default:b(()=>[m(_e,{id:"targetCurrent",modelValue:a.value.instantTargetCurrent,"onUpdate:modelValue":r[0]||(r[0]=l=>a.value.instantTargetCurrent=l),min:6,max:32,step:1,unit:"A"},null,8,["modelValue"])]),_:1}),a.value.instantChargeLimitMode!="none"?(i(),h("hr",Qs)):y("",!0),m(O,{title:"Begrenzung",icon:"fa-hand"},{default:b(()=>[m(Le,{modelValue:a.value.instantChargeLimitMode,"onUpdate:modelValue":r[1]||(r[1]=l=>a.value.instantChargeLimitMode=l),options:s.map(l=>[l.name,l.id])},null,8,["modelValue","options"])]),_:1}),a.value.instantChargeLimitMode=="soc"?(i(),B(O,{key:1,title:"Maximaler SoC",icon:"fa-sliders"},{default:b(()=>[m(_e,{id:"maxSoc",modelValue:a.value.instantTargetSoc,"onUpdate:modelValue":r[2]||(r[2]=l=>a.value.instantTargetSoc=l),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])]),_:1})):y("",!0),a.value.instantChargeLimitMode=="amount"?(i(),B(O,{key:2,title:"Zu ladende Energie",icon:"fa-sliders"},{default:b(()=>[m(_e,{id:"maxEnergy",modelValue:a.value.instantMaxEnergy,"onUpdate:modelValue":r[3]||(r[3]=l=>a.value.instantMaxEnergy=l),min:0,max:100,step:1,unit:"kWh"},null,8,["modelValue"])]),_:1})):y("",!0)]))}});const Zs=E(Ys,[["__scopeId","data-v-ccd11e7e"]]),Xs={class:"form-check form-switch"},me=I({__name:"SwitchInput",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,s=g({get(){return a.modelValue},set(o){e("update:modelValue",o)}});return(o,r)=>(i(),h("div",Xs,[Oe(n("input",{"onUpdate:modelValue":r[0]||(r[0]=l=>s.value=l),class:"form-check-input",type:"checkbox",role:"switch"},null,512),[[_t,s.value]])]))}}),pa=t=>(K("data-v-daf11c39"),t=t(),ee(),t),Ks={class:"pt-2"},er=pa(()=>n("p",{class:"heading ms-1"},"PV-Laden:",-1)),tr={class:"form-check form-switch"},ar=pa(()=>n("hr",null,null,-1)),nr={key:2},or=I({__name:"CPConfigPv",props:{chargepoint:{}},setup(t){const a=le(t.chargepoint),s=g({get(){return a.value.pvMinCurrent>5},set(r){r?a.value.pvMinCurrent=6:a.value.pvMinCurrent=0}}),o=g({get(){return a.value.pvMinSoc>0},set(r){r?a.value.pvMinSoc=50:a.value.pvMinSoc=0}});return(r,l)=>(i(),h("div",Ks,[er,m(O,{title:"Maximaler Ladestand",icon:"fa-battery-three-quarters",fullwidth:!0},{default:b(()=>[m(_e,{id:"maxSoc",modelValue:a.value.pvMaxSoc,"onUpdate:modelValue":l[0]||(l[0]=c=>a.value.pvMaxSoc=c),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])]),_:1}),m(O,{title:"Einspeisegrenze beachten",icon:"fa-hand",fullwidth:!0},{default:b(()=>[n("div",tr,[Oe(n("input",{id:"feedInLimitSwitch","onUpdate:modelValue":l[1]||(l[1]=c=>a.value.pvFeedInLimit=c),class:"form-check-input",type:"checkbox",role:"switch"},null,512),[[_t,a.value.pvFeedInLimit]])])]),_:1}),ar,m(O,{title:"Min-SoC-Laden",icon:"fa-battery-half",infotext:u($e).minsoc,fullwidth:!0},{default:b(()=>[m(me,{modelValue:o.value,"onUpdate:modelValue":l[2]||(l[2]=c=>o.value=c)},null,8,["modelValue"])]),_:1},8,["infotext"]),o.value?(i(),B(O,{key:0,title:"...bis SoC",fullwidth:!0},{info:b(()=>[U(k(u($e).minsoc),1)]),default:b(()=>[m(_e,{id:"minSoc",modelValue:a.value.pvMinSoc,"onUpdate:modelValue":l[3]||(l[3]=c=>a.value.pvMinSoc=c),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])]),_:1})):y("",!0),o.value?(i(),B(O,{key:1,title:"...mit Ladestrom",fullwidth:!0},{default:b(()=>[m(_e,{id:"minSocCurrent",modelValue:a.value.pvMinSocCurrent,"onUpdate:modelValue":l[4]||(l[4]=c=>a.value.pvMinSocCurrent=c),min:6,max:32,step:1,unit:"A"},null,8,["modelValue"])]),_:1})):y("",!0),s.value||o.value?(i(),h("hr",nr)):y("",!0),m(O,{title:"Min+PV-Laden",icon:"fa-bolt",infotext:u($e).minpv,fullwidth:!0},{default:b(()=>[m(me,{modelValue:s.value,"onUpdate:modelValue":l[5]||(l[5]=c=>s.value=c)},null,8,["modelValue"])]),_:1},8,["infotext"]),s.value?(i(),B(O,{key:3,title:"...bei Ladestrom (minimal)",fullwidth:!0},{default:b(()=>[m(_e,{id:"minCurrent",modelValue:a.value.pvMinCurrent,"onUpdate:modelValue":l[6]||(l[6]=c=>a.value.pvMinCurrent=c),min:6,max:32,step:1,unit:"A"},null,8,["modelValue"])]),_:1})):y("",!0)]))}});const sr=E(or,[["__scopeId","data-v-daf11c39"]]),ga=t=>(K("data-v-1a32bb24"),t=t(),ee(),t),rr=["id"],lr={class:"modal-dialog modal-lg modal-fullscreen-lg-down"},ir={class:"modal-content"},cr={class:"modal-header"},dr={class:"modal-title"},ur=ga(()=>n("button",{type:"button",class:"btn-close buttonTextSize d-flex justify-content-center pt-3 pb-0","data-bs-dismiss":"modal"},[n("i",{class:"fa-solid fa-lg fa-rectangle-xmark m-0 p-0"})],-1)),hr={class:"modal-body",style:{"background-color":"var(--color-bg)"}},pr=ga(()=>n("button",{class:"btn btn-secondary float-end mt-3 ms-1","data-bs-dismiss":"modal"}," Schließen ",-1)),gr=I({__name:"ModalComponent",props:{modalId:{}},setup(t){const e=t;return Ue(()=>{}),(a,s)=>(i(),h("div",{id:e.modalId,class:"modal fade"},[n("div",lr,[n("div",ir,[n("div",cr,[n("h3",dr,[ae(a.$slots,"title",{},void 0,!0)]),ur]),n("div",hr,[ae(a.$slots,"default",{},void 0,!0),pr])])])],8,rr))}});const Lt=E(gr,[["__scopeId","data-v-1a32bb24"]]),mr=["value"],fr=I({__name:"SelectInput",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,s=g({get(){return a.modelValue},set(o){e("update:modelValue",o)}});return(o,r)=>Oe((i(),h("select",{id:"selectme","onUpdate:modelValue":r[0]||(r[0]=l=>s.value=l),class:"form-select"},[(i(!0),h(D,null,q(o.options,(l,c)=>(i(),h("option",{key:c,value:l[1]},k(l[0]),9,mr))),128))],512)),[[Oa,s.value]])}});const Ot=E(fr,[["__scopeId","data-v-5e33ce1f"]]),vr=["id","onUpdate:modelValue","value"],_r=["for"],br=I({__name:"CheckBoxInput",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,s=g({get(){return a.modelValue},set(r){console.log("SET CHECKBOX"),e("update:modelValue",r)}});function o(r){return s.value[r]?{color:"var(--color-pv)"}:{color:"var(--color-menu)"}}return(r,l)=>(i(!0),h(D,null,q(r.options,(c,d)=>(i(),h("div",{key:d},[Oe(n("input",{id:"check"+d,"onUpdate:modelValue":p=>s.value[d]=p,class:"form-check-input",type:"checkbox",value:c},null,8,vr),[[_t,s.value[d]]]),n("label",{class:"form-check-label px-2",for:"check"+d,style:H(o(d))},k(r.options[d]),13,_r)]))),128))}});const ma=E(br,[["__scopeId","data-v-534700e0"]]),yr=I({__name:"TimeInput",props:{modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,s=g({get(){return a.modelValue},set(o){e("update:modelValue",o)}});return(o,r)=>Oe((i(),h("input",{"onUpdate:modelValue":r[0]||(r[0]=l=>s.value=l),type:"time",class:"form-control",name:"t"},null,512)),[[Xt,s.value]])}});const Pt=E(yr,[["__scopeId","data-v-51c81cc3"]]),wr={class:"container-fluid p-0 m-0"},kr={class:"row mt-2"},$r={class:"col d-flex justify-content-end"},Sr=I({__name:"CPEditSchedule",props:{chargeTemplateId:{},planId:{}},emits:["deletePlan","abort","savePlan"],setup(t){const e=t,a=[["Einmalig","once"],["Täglich","daily"],["Wöchentlich","weekly"]],s=["Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"],o=g(()=>ue[e.chargeTemplateId]),r=g(()=>{let l=o.value.chargemode.scheduled_charging.plans[e.planId];return l||aa()});return(l,c)=>(i(),h("div",wr,[m(O,{title:"Ladestand",fullwidth:!0},{default:b(()=>[m(_e,{id:"soc",modelValue:r.value.soc,"onUpdate:modelValue":c[0]||(c[0]=d=>r.value.soc=d),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])]),_:1}),m(O,{title:"Zielzeit beachten",fullwidth:!0},{default:b(()=>[m(me,{modelValue:r.value.timed,"onUpdate:modelValue":c[1]||(c[1]=d=>r.value.timed=d)},null,8,["modelValue"])]),_:1}),m(O,{title:"Uhrzeit",fullwidth:!0},{default:b(()=>[m(Pt,{modelValue:r.value.time,"onUpdate:modelValue":c[2]||(c[2]=d=>r.value.time=d)},null,8,["modelValue"])]),_:1}),m(O,{title:"Wiederholungen",fullwidth:!0},{default:b(()=>[m(Ot,{modelValue:r.value.frequency.selected,"onUpdate:modelValue":c[3]||(c[3]=d=>r.value.frequency.selected=d),options:a},null,8,["modelValue"])]),_:1}),r.value.frequency.selected=="once"?(i(),B(O,{key:0,title:"Gültig ab",fullwidth:!0},{default:b(()=>[m(Ze,{modelValue:r.value.frequency.once[0],"onUpdate:modelValue":c[4]||(c[4]=d=>r.value.frequency.once[0]=d)},null,8,["modelValue"])]),_:1})):y("",!0),r.value.frequency.selected=="once"?(i(),B(O,{key:1,title:"Gültig bis",fullwidth:!0},{default:b(()=>[m(Ze,{modelValue:r.value.frequency.once[1],"onUpdate:modelValue":c[5]||(c[5]=d=>r.value.frequency.once[1]=d)},null,8,["modelValue"])]),_:1})):y("",!0),r.value.frequency.selected=="weekly"?(i(),B(O,{key:2,title:"Wochentage",fullwidth:!0},{default:b(()=>[m(ma,{modelValue:r.value.frequency.weekly,"onUpdate:modelValue":c[6]||(c[6]=d=>r.value.frequency.weekly=d),options:s},null,8,["modelValue"])]),_:1})):y("",!0),n("div",kr,[n("div",$r,[n("button",{class:"btn btn-danger","data-bs-dismiss":"modal",onClick:c[7]||(c[7]=d=>l.$emit("deletePlan",l.planId))}," Löschen "),n("button",{class:"btn btn-warning ms-1","data-bs-dismiss":"modal",onClick:c[8]||(c[8]=d=>l.$emit("abort"))}," Abbrechen "),n("button",{class:"btn btn-success float-end ms-1","data-bs-dismiss":"modal",onClick:c[9]||(c[9]=d=>l.$emit("savePlan",l.planId))}," Speichern ")])])]))}});const xr=E(Sr,[["__scopeId","data-v-119e0317"]]),Ae=t=>(K("data-v-399182a8"),t=t(),ee(),t),Pr=Ae(()=>n("p",{class:"heading ms-1 pt-2"},"Zielladen:",-1)),Mr={class:"table table-borderless"},Cr=Ae(()=>n("thead",null,[n("tr",null,[n("th",{class:"tableheader"},"Ziel-SoC"),n("th",{class:"tableheader"},"Zeit"),n("th",{class:"tableheader"},"Wiederholung"),n("th",{class:"tableheader"})])],-1)),Ir={class:"tablecell"},Br={class:"tablecell"},Vr={class:"tablecell"},Tr={class:"tablecell left"},Lr=["data-bs-target","onClick"],Or=Ae(()=>n("i",{class:"fas fa-lg fa-pen ms-2"},null,-1)),Ar=[Or],Wr=Ae(()=>n("td",{class:"emptycell"},null,-1)),Dr=Ae(()=>n("td",{class:"emptycell"},null,-1)),Er=Ae(()=>n("td",{class:"emptycell"},null,-1)),Gr={class:"right"},jr=["data-bs-target"],Ur=Ae(()=>n("i",{class:"fa-solid fa-xl fa-square-plus ms-2"},null,-1)),zr=[Ur],Nr=I({__name:"CPConfigScheduled",props:{chargeTemplate:{},chargeTemplateId:{}},setup(t){const e=t,a={daily:"Täglich",once:"Einmal",weekly:"Wöchentlich"},s="schedulesettingmodal"+e.chargeTemplateId,o=J(["0"]),r=g(()=>{let P=e.chargeTemplate.chargemode.scheduled_charging.plans;return P||{}});function l(P){return r.value[P].timed?r.value[P].time:"-"}function c(P){o[0]=P}function d(){na(e.chargeTemplateId)}function p(){d()}function w(){console.log("abort edit")}function M(P){delete ue[e.chargeTemplateId].chargemode.scheduled_charging.plans[P],d()}function C(){let P=aa();e.chargeTemplate.chargemode.scheduled_charging.plans||(ue[e.chargeTemplateId].chargemode.scheduled_charging.plans={});let x=0;Object.keys(r.value).forEach(G=>{+G>x&&(x=+G)}),x=x+1,ue[e.chargeTemplateId].chargemode.scheduled_charging.plans[x.toString()]=P,c(x.toString()),console.log(r.value),S()}function S(){let P=document.getElementById(s);P?new Aa(P).show():console.log("NO MODAL ELEMENT")}return(P,x)=>(i(),h(D,null,[Pr,n("table",Mr,[Cr,n("tbody",null,[(i(!0),h(D,null,q(Object.keys(r.value),G=>(i(),h("tr",{key:G},[n("td",Ir,k(r.value[G].soc)+" %",1),n("td",Br,k(l(G)),1),n("td",Vr,k(a[r.value[G].frequency.selected]),1),n("td",Tr,[n("span",{class:"editButton","data-bs-toggle":"modal","data-bs-target":"#"+s,onClick:Q=>c(G)},Ar,8,Lr)])]))),128)),n("tr",null,[Wr,Dr,Er,n("td",Gr,[n("span",{class:"addButton","data-bs-target":"#"+s,onClick:C},zr,8,jr)])])])]),(i(!0),h(D,null,q(o,G=>(i(),B(Lt,{key:G,"modal-id":s},{title:b(()=>[U(" Zielladen - Parameter ")]),default:b(()=>[m(xr,{"charge-template-id":P.chargeTemplateId,"plan-id":G,onSavePlan:p,onDeletePlan:M,onAbort:w},null,8,["charge-template-id","plan-id"])]),_:2},1024))),128))],64))}});const Fr=E(Nr,[["__scopeId","data-v-399182a8"]]),qr={class:"container-fluid p-0 m-0"},Hr={class:"row"},Rr={class:"col d-flex justify-content-end"},Jr=I({__name:"CPEditTimeplan",props:{chargeTemplateId:{},planId:{}},emits:["deletePlan","abort","savePlan"],setup(t){const e=t,a=[["Einmalig","once"],["Täglich","daily"],["Wöchentlich","weekly"]],s=["Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sonntag"],o=g(()=>ue[e.chargeTemplateId]),r=g(()=>{let l=o.value.time_charging.plans[e.planId];return l||ta()});return(l,c)=>(i(),h("div",qr,[m(O,{title:"Beginn",fullwidth:!0},{default:b(()=>[m(Pt,{modelValue:r.value.time[0],"onUpdate:modelValue":c[0]||(c[0]=d=>r.value.time[0]=d)},null,8,["modelValue"])]),_:1}),m(O,{title:"Ende",fullwidth:!0},{default:b(()=>[m(Pt,{modelValue:r.value.time[1],"onUpdate:modelValue":c[1]||(c[1]=d=>r.value.time[1]=d)},null,8,["modelValue"])]),_:1}),m(O,{title:"Ladestrom",fullwidth:!0},{default:b(()=>[m(_e,{id:"current",modelValue:r.value.current,"onUpdate:modelValue":c[2]||(c[2]=d=>r.value.current=d),min:6,max:32,step:1,unit:"A"},null,8,["modelValue"])]),_:1}),m(O,{title:"Wiederholungen",fullwidth:!0},{default:b(()=>[m(Ot,{modelValue:r.value.frequency.selected,"onUpdate:modelValue":c[3]||(c[3]=d=>r.value.frequency.selected=d),options:a},null,8,["modelValue"])]),_:1}),r.value.frequency.selected=="once"?(i(),B(O,{key:0,title:"Gültig ab",fullwidth:!0},{default:b(()=>[m(Ze,{modelValue:r.value.frequency.once[0],"onUpdate:modelValue":c[4]||(c[4]=d=>r.value.frequency.once[0]=d)},null,8,["modelValue"])]),_:1})):y("",!0),r.value.frequency.selected=="once"?(i(),B(O,{key:1,title:"Gültig bis",fullwidth:!0},{default:b(()=>[m(Ze,{modelValue:r.value.frequency.once[1],"onUpdate:modelValue":c[5]||(c[5]=d=>r.value.frequency.once[1]=d)},null,8,["modelValue"])]),_:1})):y("",!0),r.value.frequency.selected=="weekly"?(i(),B(O,{key:2,title:"Wochentage",fullwidth:!0},{default:b(()=>[m(ma,{modelValue:r.value.frequency.weekly,"onUpdate:modelValue":c[6]||(c[6]=d=>r.value.frequency.weekly=d),options:s},null,8,["modelValue"])]),_:1})):y("",!0),n("div",Hr,[n("div",Rr,[n("button",{class:"btn btn-danger",onClick:c[7]||(c[7]=d=>l.$emit("deletePlan",l.planId))}," Löschen "),n("button",{class:"btn btn-warning ms-1",onClick:c[8]||(c[8]=d=>l.$emit("abort"))}," Abbrechen "),n("button",{class:"btn btn-success float-end ms-1",onClick:c[9]||(c[9]=d=>l.$emit("savePlan",l.planId))}," Speichern ")])])]))}});const Qr=E(Jr,[["__scopeId","data-v-dbb0f7ee"]]),Pe=t=>(K("data-v-674bed04"),t=t(),ee(),t),Yr=Pe(()=>n("p",{class:"heading ms-1 pt-2"},"Zeitpläne:",-1)),Zr={class:"table table-borderless"},Xr=Pe(()=>n("thead",null,[n("tr",null,[n("th",{class:"tableheader"},"Von"),n("th",{class:"tableheader"},"Bis"),n("th",{class:"tableheader"},"Ladestrom"),n("th",{class:"tableheader"},"Wiederholung"),n("th",{class:"tableheader right"})])],-1)),Kr={class:"tablecell"},el={class:"tablecell"},tl={class:"tablecell"},al={class:"tablecell"},nl={class:"tablecell left"},ol=["onClick"],sl=Pe(()=>n("i",{class:"fas fa-lg fa-pen ms-2"},null,-1)),rl=[sl],ll=Pe(()=>n("td",{class:"emptycell"},null,-1)),il=Pe(()=>n("td",{class:"emptycell"},null,-1)),cl=Pe(()=>n("td",{class:"emptycell"},null,-1)),dl=Pe(()=>n("td",{class:"emptycell"},null,-1)),ul=Pe(()=>n("i",{class:"fa-solid fa-xl fa-square-plus ms-2"},null,-1)),hl=[ul],pl=I({__name:"CPConfigTimed",props:{chargeTemplate:{},chargeTemplateId:{}},setup(t){const e=t,a={daily:"Täglich",once:"Einmal",weekly:"Wöchentlich"},s=J(["0"]);function o(C){s[0]=C}const r=le(!1);function l(){na(e.chargeTemplateId)}function c(){l(),r.value=!1}function d(){console.log("abort edit"),r.value=!1}function p(C){delete ue[e.chargeTemplateId].time_charging.plans[C],l(),r.value=!1}function w(){let C=ta();e.chargeTemplate.time_charging.plans||(ue[e.chargeTemplateId].time_charging.plans={});let S=0;Object.keys(M.value).forEach(P=>{+P>S&&(S=+P)}),S=S+1,ue[e.chargeTemplateId].time_charging.plans[S.toString()]=C,o(S.toString()),r.value=!0}const M=g(()=>{let C=e.chargeTemplate.time_charging.plans;return C||{}});return(C,S)=>(i(),h(D,null,[Yr,n("table",Zr,[Xr,n("tbody",null,[(i(!0),h(D,null,q(Object.keys(M.value),P=>(i(),h("tr",{key:P},[n("td",Kr,k(M.value[P].time[0]),1),n("td",el,k(M.value[P].time[1]),1),n("td",tl,k(M.value[P].current)+" A",1),n("td",al,k(a[M.value[P].frequency.selected]),1),n("td",nl,[n("span",{class:"editButton",editPlan:"true",onClick:x=>o(P)},rl,8,ol)])]))),128)),n("tr",null,[ll,il,cl,dl,n("td",{class:"tablecell right"},[n("span",{class:"addButton",onClick:w},hl)])])])]),r.value?(i(),B(xe,{key:0,"full-width":!0},{title:b(()=>[U(" Zeitplan bearbeiten ")]),default:b(()=>[m(Qr,{"charge-template-id":C.chargeTemplateId,"plan-id":s[0],onSavePlan:c,onDeletePlan:p,onAbort:d},null,8,["charge-template-id","plan-id"])]),_:1})):y("",!0)],64))}});const gl=E(pl,[["__scopeId","data-v-674bed04"]]),ml={class:"settingsheader mt-2 ms-1"},fl=I({__name:"CPConfigVehicle",props:{vehicleId:{}},setup(t){const e=t;return(a,s)=>(i(),h(D,null,[n("p",ml," Profile für "+k(u(X)[e.vehicleId].name)+": ",1),m(O,{title:"Ladeprofil",icon:"fa-sliders",fullwidth:!0},{default:b(()=>[m(Le,{modelValue:u(X)[e.vehicleId].chargeTemplateId,"onUpdate:modelValue":s[0]||(s[0]=o=>u(X)[e.vehicleId].chargeTemplateId=o),modelModifiers:{number:!0},options:Object.keys(u(ue)).map(o=>[u(ue)[+o].name,o])},null,8,["modelValue","options"])]),_:1}),m(O,{title:"Fahrzeug-Vorlage",icon:"fa-sliders",fullwidth:!0},{default:b(()=>[m(Le,{modelValue:u(X)[e.vehicleId].evTemplateId,"onUpdate:modelValue":s[1]||(s[1]=o=>u(X)[e.vehicleId].evTemplateId=o),modelModifiers:{number:!0},options:Object.keys(u(xt)).map(o=>[u(xt)[+o].name,o])},null,8,["modelValue","options"])]),_:1})],64))}});const vl=E(fl,[["__scopeId","data-v-fcb57a44"]]),_l=t=>(K("data-v-29abd227"),t=t(),ee(),t),bl=_l(()=>n("p",{class:"settingsheader mt-2 ms-1"},"Ladepunkt:",-1)),yl=I({__name:"CPChargeConfig",props:{chargepoint:{}},emits:["closeConfig"],setup(t){const a=t.chargepoint;return(s,o)=>(i(),h(D,null,[bl,m(O,{title:"Lademodus",icon:"fa-charging-station",infotext:u($e).chargemode,fullwidth:!0},{default:b(()=>[m(Le,{modelValue:u(a).chargeMode,"onUpdate:modelValue":o[0]||(o[0]=r=>u(a).chargeMode=r),options:Object.keys(u(se)).map(r=>[u(se)[r].name,r,u(se)[r].color,u(se)[r].icon])},null,8,["modelValue","options"])]),_:1},8,["infotext"]),m(O,{title:"Fahrzeug",icon:"fa-car",infotext:u($e).vehicle,fullwidth:!0},{default:b(()=>[m(Le,{modelValue:u(a).connectedVehicle,"onUpdate:modelValue":o[1]||(o[1]=r=>u(a).connectedVehicle=r),modelModifiers:{number:!0},options:Object.values(u(X)).map(r=>[r.name,r.id])},null,8,["modelValue","options"])]),_:1},8,["infotext"]),m(O,{title:"Sperren",icon:"fa-lock",infotext:u($e).locked,fullwidth:!0},{default:b(()=>[m(me,{modelValue:u(a).isLocked,"onUpdate:modelValue":o[2]||(o[2]=r=>u(a).isLocked=r)},null,8,["modelValue"])]),_:1},8,["infotext"]),m(O,{title:"Priorität",icon:"fa-star",infotext:u($e).priority,fullwidth:!0},{default:b(()=>[m(me,{modelValue:u(a).hasPriority,"onUpdate:modelValue":o[3]||(o[3]=r=>u(a).hasPriority=r)},null,8,["modelValue"])]),_:1},8,["infotext"]),m(O,{title:"Zeitplan",icon:"fa-clock",infotext:u($e).timeplan,fullwidth:!0},{default:b(()=>[m(me,{modelValue:u(a).scheduledCharging,"onUpdate:modelValue":o[4]||(o[4]=r=>u(a).scheduledCharging=r)},null,8,["modelValue"])]),_:1},8,["infotext"])],64))}});const wl=E(yl,[["__scopeId","data-v-29abd227"]]),ze=t=>(K("data-v-963883cd"),t=t(),ee(),t),kl={class:"status-string"},$l={style:{color:"red"}},Sl={class:"m-0 mt-4 p-0"},xl={class:"nav nav-tabs nav-justified mx-1 mt-1",role:"tablist"},Pl=["data-bs-target"],Ml=ze(()=>n("i",{class:"fa-solid fa-charging-station"},null,-1)),Cl=[Ml],Il=["data-bs-target"],Bl=ze(()=>n("i",{class:"fa-solid fa-lg fa-bolt"},null,-1)),Vl=[Bl],Tl=["data-bs-target"],Ll=ze(()=>n("i",{class:"fa-solid fa-solar-panel me-1"},null,-1)),Ol=[Ll],Al=["data-bs-target"],Wl=ze(()=>n("i",{class:"fa-solid fa-bullseye me-1"},null,-1)),Dl=[Wl],El=["data-bs-target"],Gl=ze(()=>n("i",{class:"fa-solid fa-clock"},null,-1)),jl=[Gl],Ul=["data-bs-target"],zl=ze(()=>n("i",{class:"fa-solid fa-rectangle-list"},null,-1)),Nl=[zl],Fl={id:"settingsPanes",class:"tab-content mx-1 p-1 pb-3"},ql=["id"],Hl=["id"],Rl=["id"],Jl=["id"],Ql=["id"],Yl=["id"],Zl=I({__name:"CPChargeConfigPanel",props:{chargepoint:{}},emits:["closeConfig"],setup(t){const a=t.chargepoint,s=g(()=>ue[a.chargeTemplate]),o=g(()=>a.id);return Ue(()=>{}),(r,l)=>(i(),h(D,null,[m(O,{title:"Status",icon:"fa-info-circle",fullwidth:!0},{default:b(()=>[n("span",kl,k(u(a).stateStr),1)]),_:1}),u(a).faultState!=0?(i(),B(O,{key:0,title:"Fehler"},{default:b(()=>[n("span",$l,k(u(a).faultStr),1)]),_:1})):y("",!0),n("div",Sl,[n("nav",xl,[n("a",{class:"nav-link active","data-bs-toggle":"tab","data-bs-target":"#chargeSettings"+o.value},Cl,8,Pl),r.chargepoint.chargeMode=="instant_charging"?(i(),h("a",{key:0,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#instantSettings"+o.value},Vl,8,Il)):y("",!0),r.chargepoint.chargeMode=="pv_charging"?(i(),h("a",{key:1,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#pvSettings"+o.value},Ol,8,Tl)):y("",!0),r.chargepoint.chargeMode=="scheduled_charging"?(i(),h("a",{key:2,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#scheduledSettings"+o.value},Dl,8,Al)):y("",!0),r.chargepoint.scheduledCharging?(i(),h("a",{key:3,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#timeSettings"+o.value},jl,8,El)):y("",!0),n("a",{class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#carSettings"+o.value},Nl,8,Ul)]),n("div",Fl,[n("div",{id:"chargeSettings"+o.value,class:"tab-pane active",role:"tabpanel","aria-labelledby":"instant-tab"},[m(wl,{chargepoint:r.chargepoint},null,8,["chargepoint"])],8,ql),n("div",{id:"instantSettings"+o.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"instant-tab"},[m(Zs,{chargepoint:u(a),vehicles:u(X),"charge-templates":u(ue)},null,8,["chargepoint","vehicles","charge-templates"])],8,Hl),n("div",{id:"pvSettings"+o.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"pv-tab"},[m(sr,{chargepoint:u(a),vehicles:u(X),"charge-templates":u(ue)},null,8,["chargepoint","vehicles","charge-templates"])],8,Rl),n("div",{id:"scheduledSettings"+o.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"scheduled-tab"},[s.value!=null?(i(),B(Fr,{key:0,"charge-template":s.value,"charge-template-id":u(a).chargeTemplate},null,8,["charge-template","charge-template-id"])):y("",!0)],8,Jl),n("div",{id:"timeSettings"+o.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"time-tab"},[s.value!=null?(i(),B(gl,{key:0,"charge-template":s.value,"charge-template-id":u(a).chargeTemplate},null,8,["charge-template","charge-template-id"])):y("",!0)],8,Ql),n("div",{id:"carSettings"+o.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"car-tab"},[u(X)[u(a).connectedVehicle]!=null?(i(),B(vl,{key:0,"vehicle-id":u(a).connectedVehicle},null,8,["vehicle-id"])):y("",!0)],8,Yl)])])],64))}});const ct=E(Zl,[["__scopeId","data-v-963883cd"]]),Xl=I({__name:"BatterySymbol",props:{soc:{}},setup(t){const e=t,a=g(()=>e.soc<=10?"fa-battery-empty":e.soc<50?"fa-battery-quarter":e.soc<75?"fa-battery-half":e.soc<95?"fa-battery-three-quarters":"fa-battery-full");return(s,o)=>(i(),h("span",null,[n("i",{class:z(["fa batIcon",a.value])},null,2),U(" "+k(s.soc+"%"),1)]))}});const At=E(Xl,[["__scopeId","data-v-49be699a"]]),fa=I({__name:"FormatWattH",props:{wattH:{}},setup(t){const e=t,a=g(()=>Qe(e.wattH,v.decimalPlaces));return(s,o)=>(i(),h("span",null,k(a.value),1))}}),Kl=t=>(K("data-v-349e7414"),t=t(),ee(),t),ei={class:"wb-widget p-0 m-0 shadow"},ti={class:"d-flex justify-content-between"},ai={class:"m-4 mb-3"},ni=Kl(()=>n("div",{class:"p-0"},"(title goes here)",-1)),oi={class:"p-4 pb-0 col-4 m-0",style:{"text-align":"right"}},si={class:"container-fluid p-0"},ri=I({__name:"WbWidgetFlex",props:{variableWidth:{type:Boolean},fullWidth:{type:Boolean}},setup(t){const e=t,a=g(()=>e.fullWidth?"col-12":e.variableWidth&&v.preferWideBoxes?"col-lg-6":"col-lg-4");return(s,o)=>(i(),h("div",{class:z(["p-2 m-0 d-flex",a.value])},[n("div",ei,[n("div",ti,[n("h3",ai,[ae(s.$slots,"title",{},()=>[ni],!0),ae(s.$slots,"subtitle",{},void 0,!0)]),n("div",oi,[ae(s.$slots,"buttons",{},void 0,!0)])]),n("div",si,[ae(s.$slots,"default",{},void 0,!0)])])],2))}});const dt=E(ri,[["__scopeId","data-v-349e7414"]]),Ke=t=>(K("data-v-faf7dfe6"),t=t(),ee(),t),li=Ke(()=>n("span",{class:"fa-solid fa-charging-station"}," ",-1)),ii=Ke(()=>n("span",{class:"fa-solid fa-lg ps-1 fa-ellipsis-vertical"},null,-1)),ci=[ii],di={key:0},ui={class:"col m-0 mb-1 p-0 d-flex justify-content-between"},hi={class:"col m-0 p-0 d-flex justify-content-between"},pi={class:"row m-0 p-0 mt-3 mb-0"},gi={class:"col d-flex justify-content-center p-0 m-0"},mi={key:1,class:"row m-0 mt-0 p-0"},fi={class:"col m-0 p-0"},vi={key:0},_i={class:"col"},bi=Ke(()=>n("i",{class:"fa-solid fa-sm fa-car me-2"},null,-1)),yi={key:0,class:"me-1 fa-solid fa-xs fa-star ps-1"},wi={class:"row m-0 p-1 pt-2 mb-3"},ki={class:"m-0 p-0 d-flex justify-content-between"},$i={key:0,class:"me-1 fa-solid fa-xs fa-clock ps-1"},Si=Ke(()=>n("span",{class:"fas fa-gear"}," ",-1)),xi=Ke(()=>n("span",{class:"fa-solid fa-lg ps-1 fa-circle-check"},null,-1)),Pi=[xi],Mi=I({__name:"CPChargePoint",props:{chargepoint:{},fullWidth:{type:Boolean}},setup(t){const e=t,a=g({get(){return e.chargepoint.chargeMode},set(C){T[e.chargepoint.id].chargeMode=C}}),s=g(()=>(Math.round(e.chargepoint.current*10)/10).toLocaleString(void 0)+" A"),o=g(()=>Math.round(e.chargepoint.rangeCharged).toString()+" "+e.chargepoint.rangeUnit),r=g(()=>e.chargepoint.isLocked?"Gesperrt":e.chargepoint.isCharging?"Lädt":e.chargepoint.isPluggedIn?"Bereit":"Frei"),l=g(()=>e.chargepoint.isLocked?"var(--color-evu)":e.chargepoint.isCharging?"var(--color-charging)":e.chargepoint.isPluggedIn?"var(--color-battery)":"var(--color-axis)"),c=g(()=>{let C="";return e.chargepoint.isLocked?C="fa-lock":e.chargepoint.isCharging?C=" fa-bolt":e.chargepoint.isPluggedIn&&(C="fa-plug"),"fa "+C}),d=g(()=>{switch(e.chargepoint.chargeMode){case"stop":return{color:"var(--fg)"};default:return{color:se[e.chargepoint.chargeMode].color}}}),p=g(()=>e.chargepoint.soc),w=g(()=>({color:e.chargepoint.color})),M=le(!1);return(C,S)=>(i(),h(D,null,[M.value?y("",!0):(i(),B(xe,{key:0,"variable-width":!0,"full-width":e.fullWidth},{title:b(()=>[n("span",{style:H(w.value),onClick:S[0]||(S[0]=P=>M.value=!M.value)},[li,U(" "+k(e.chargepoint.name),1)],4)]),buttons:b(()=>[n("span",{class:"ms-2 pt-1",style:H(d.value),onClick:S[1]||(S[1]=P=>M.value=!M.value)},ci,4)]),footer:b(()=>[M.value?y("",!0):(i(),h("div",vi,[n("div",{class:"row",onClick:S[5]||(S[5]=P=>M.value=!M.value)},[n("div",_i,[n("h3",null,[bi,U(" "+k(C.chargepoint.vehicleName)+" ",1),C.chargepoint.hasPriority?(i(),h("span",yi)):y("",!0)])])]),n("div",wi,[n("div",ki,[m(oe,{heading:"Ladestand:"},{default:b(()=>[C.chargepoint.isSocConfigured?(i(),B(At,{key:0,soc:p.value,class:"me-2"},null,8,["soc"])):y("",!0),C.chargepoint.isSocManual?(i(),h("i",{key:1,class:"fa-solid fa-sm fas fa-edit",style:H({color:"var(--color-menu)"})},null,4)):y("",!0),C.chargepoint.isSocManual?y("",!0):(i(),h("i",{key:2,class:"fa-solid fa-sm fa-sync",style:H({color:"var(--color-menu)"})},null,4))]),_:1}),m(oe,{heading:"Reichweite:"},{default:b(()=>[U(k(u(X)[e.chargepoint.connectedVehicle]?Math.round(u(X)[1].range):0)+" km ",1)]),_:1}),m(oe,{heading:"Zeitplan:"},{default:b(()=>[C.chargepoint.scheduledCharging?(i(),h("span",$i)):y("",!0),U(" "+k(e.chargepoint.scheduledCharging?"Ja":"Nein"),1)]),_:1})])])]))]),default:b(()=>[M.value?y("",!0):(i(),h("div",di,[n("div",{class:"row m-1 mt-0 p-0",onClick:S[2]||(S[2]=P=>M.value=!M.value)},[n("div",ui,[m(oe,{heading:"Status:"},{default:b(()=>[n("span",{style:H({color:l.value})},[n("i",{class:z(c.value)},null,2),U(" "+k(r.value),1)],4)]),_:1}),m(oe,{heading:"Geladen:"},{default:b(()=>[m(fa,{"watt-h":C.chargepoint.chargedSincePlugged},null,8,["watt-h"])]),_:1}),m(oe,{heading:"gel. Reichw.:"},{default:b(()=>[U(k(o.value),1)]),_:1})])]),e.chargepoint.power>0?(i(),h("div",{key:0,class:"row m-1 p-0",onClick:S[3]||(S[3]=P=>M.value=!M.value)},[n("div",hi,[m(oe,{heading:"Leistung:"},{default:b(()=>[m(Bt,{watt:e.chargepoint.power},null,8,["watt"])]),_:1}),m(oe,{heading:"Stromstärke:"},{default:b(()=>[U(k(s.value),1)]),_:1}),m(oe,{heading:"Phasen:"},{default:b(()=>[U(k(e.chargepoint.phasesInUse),1)]),_:1})])])):y("",!0),n("div",pi,[n("div",gi,[m(ca,{id:"chargemode-"+C.chargepoint.name,modelValue:a.value,"onUpdate:modelValue":S[4]||(S[4]=P=>a.value=P),options:Object.keys(u(se)).map(P=>({text:u(se)[P].name,value:P,color:u(se)[P].color,icon:u(se)[P].icon,active:u(se)[P].mode==C.chargepoint.chargeMode}))},null,8,["id","modelValue","options"])])])])),M.value?(i(),h("div",mi,[n("div",fi,[C.chargepoint!=null?(i(),B(ct,{key:0,chargepoint:C.chargepoint},null,8,["chargepoint"])):y("",!0)])])):y("",!0)]),_:1},8,["full-width"])),M.value?(i(),B(dt,{key:1,"full-width":e.fullWidth},{title:b(()=>[n("span",{style:H(w.value),onClick:S[6]||(S[6]=P=>M.value=!M.value)},[Si,U(" Einstellungen "+k(e.chargepoint.name),1)],4)]),buttons:b(()=>[n("span",{class:"ms-2 pt-1",style:H(d.value),onClick:S[7]||(S[7]=P=>M.value=!M.value)},Pi,4)]),default:b(()=>[C.chargepoint!=null?(i(),B(ct,{key:0,chargepoint:C.chargepoint},null,8,["chargepoint"])):y("",!0)]),_:1},8,["full-width"])):y("",!0)],64))}});const Ci=E(Mi,[["__scopeId","data-v-faf7dfe6"]]),Ii={class:"tablerow"},Bi={class:"d-flex flex-wrap"},Vi={key:0,class:"fa-solid fa-xs fa-star"},Ti={key:1,class:"fa-solid fa-xs fa-clock"},Li={class:"tablecell left"},Oi={class:"d-flex flex-column"},Ai={key:0,class:"flex-wrap"},Wi=["data-bs-target"],Di={class:"d-flex flex-column"},Ei={class:"d-flex align-items-center flex-wrap"},Gi={class:"d-flex align-items-center me-1"},ji={class:"badge phasesInUse rounded-pill"},Ui=["data-bs-target"],zi={class:"d-flex flex-column"},Ni={class:"me-2"},Fi={class:"buttoncell right"},qi=["data-bs-target"],Hi={key:0},Ri={colspan:"5",class:"px-0"},Ji=I({__name:"CPSListItem",props:{chargepoint:{}},setup(t){const e=t,a=le(!1),s=g(()=>se[e.chargepoint.chargeMode].icon),o=g(()=>{let x="";return e.chargepoint.isLocked?x="fa-lock":e.chargepoint.isCharging?x=" fa-bolt":e.chargepoint.isPluggedIn&&(x="fa-plug"),"fa "+x}),r=g(()=>{let x={color:"var(--color-axis)"};return e.chargepoint.isLocked?x.color="var(--color-evu)":e.chargepoint.isCharging?x.color="var(--color-charging)":e.chargepoint.isPluggedIn&&(x.color="var(--color-battery)"),x}),l=g(()=>{switch(e.chargepoint.chargeMode){case"stop":return{color:"var(--fg)"};default:return{color:se[e.chargepoint.chargeMode].color}}}),c=g(()=>Be(e.chargepoint.power,v.decimalPlaces)),d=g(()=>e.chargepoint.current+" A"),p=g(()=>e.chargepoint.phasesInUse),w=g(()=>e.chargepoint.dailyYield>0?Qe(e.chargepoint.dailyYield,v.decimalPlaces):"0 Wh"),M=g(()=>e.chargepoint.averageConsumption>0&&e.chargepoint.dailyYield>0?"("+Math.round(e.chargepoint.dailyYield/e.chargepoint.averageConsumption/10).toString()+" km)":""),C=g(()=>se[e.chargepoint.chargeMode].name);function S(){return{color:e.chargepoint.color}}function P(){a.value=!a.value}return(x,G)=>(i(),h(D,null,[n("tr",Ii,[n("td",{class:"tablecell left",onClick:P},[n("div",Bi,[n("span",null,[n("i",{class:z([o.value,"me-1"]),style:H(r.value)},null,6),n("span",{class:"me-1",style:H(S())},k(x.chargepoint.name),5)]),n("span",null,[x.chargepoint.hasPriority?(i(),h("i",Vi)):y("",!0),x.chargepoint.scheduledCharging?(i(),h("i",Ti)):y("",!0)])])]),n("td",Li,[n("div",Oi,[n("span",null,k(x.chargepoint.vehicleName),1),x.chargepoint.isSocConfigured?(i(),h("span",Ai,[m(At,{class:"me-1",soc:x.chargepoint.soc},null,8,["soc"]),x.chargepoint.isSocManual?(i(),h("i",{key:0,class:"fa-solid fa-sm fas fa-edit me-2",style:H({color:"var(--color-menu)"})},null,4)):y("",!0),x.chargepoint.isSocManual?y("",!0):(i(),h("i",{key:1,class:"fa-solid fa-sm fa-sync me-2",style:H({color:"var(--color-menu)"})},null,4))])):y("",!0)])]),n("td",{class:"tablecell left","data-bs-toggle":"modal","data-bs-target":"#cpsconfig-"+x.chargepoint.id},[n("div",Di,[n("span",Ei,[n("span",null,k(c.value),1),n("span",Gi,[n("span",ji,k(p.value),1),n("span",null,k(d.value),1)])]),n("span",{style:H(l.value)},[n("i",{class:z(["fa me-1",s.value])},null,2),U(" "+k(C.value),1)],4)])],8,Wi),n("td",{class:"tablecell left","data-bs-toggle":"modal","data-bs-target":"#cpsconfig-"+x.chargepoint.id},[n("div",zi,[n("span",Ni,k(w.value),1),n("span",null,k(M.value),1)])],8,Ui),n("td",Fi,[n("span",{class:"fa-solid fa-lg fa-edit ps-1 tableicon","data-bs-toggle":"modal","data-bs-target":"#cpsconfig-"+x.chargepoint.id},null,8,qi)])]),a.value?(i(),h("tr",Hi,[n("td",Ri,[a.value?(i(),B(ct,{key:0,chargepoint:x.chargepoint,onCloseConfig:P},null,8,["chargepoint"])):y("",!0)])])):y("",!0)],64))}});const Qi=E(Ji,[["__scopeId","data-v-e5ea1042"]]),Yi=t=>(K("data-v-76f208ee"),t=t(),ee(),t),Zi={class:"table table-borderless px-0"},Xi=Yi(()=>n("thead",null,[n("tr",null,[n("th",{class:"tableheader alignleft"},[n("i",{class:"fa-solid fa-lg fa-charging-station ps-2"})]),n("th",{class:"tableheader alignleft"},[n("i",{class:"fa-solid fa-lg fa-car ps-2"})]),n("th",{class:"tableheader alignleft"},[n("i",{class:"fa-solid fa-lg fa-bolt ps-2"})]),n("th",{class:"tableheader alignleft"},[n("i",{class:"fa-solid fa-lg fa-car-battery ps-2"})]),n("th",{class:"tableheader alignright"})])],-1)),Ki=I({__name:"CPSimpleList",setup(t){const e=g(()=>Object.values(T));return(a,s)=>(i(),B(xe,null,{title:b(()=>[U(" Ladepunkte ")]),default:b(()=>[n("table",Zi,[Xi,n("tbody",null,[(i(!0),h(D,null,q(e.value,o=>(i(),B(Qi,{key:o.id,chargepoint:o},null,8,["chargepoint"]))),128))])]),(i(!0),h(D,null,q(e.value,o=>(i(),B(Lt,{key:o.id,"modal-id":"cpsconfig-"+o.id},{title:b(()=>[U(" Konfiguration: "+k(o.name),1)]),default:b(()=>[o!=null?(i(),B(ct,{key:0,chargepoint:o},null,8,["chargepoint"])):y("",!0)]),_:2},1032,["modal-id"]))),128))]),_:1}))}});const ec=E(Ki,[["__scopeId","data-v-76f208ee"]]);const kt=I({__name:"ChargePointList",setup(t){let e,a;const s=g(()=>{let l=Object.values(T);return r(),l}),o=g(()=>{switch(Object.values(T).length){case 0:return v.preferWideBoxes?"col-lg-6":"col-lg-4";case 1:return v.preferWideBoxes?"col-lg-6":"col-lg-4";case 2:return v.preferWideBoxes?"col-lg-12":"col-lg-8 ";default:return"col-lg-12"}});function r(){if(e){let l="1";if(Ie.value)switch(Object.values(T).length){case 0:case 1:l="1";break;case 2:l="2";break;default:l="3"}a.setAttribute("slides-per-view",l),e.update()}}return Ue(()=>{let l=document.querySelector(".swiper-chargepoints");l&&(a=l,e=a.swiper),window.addEventListener("resize",r)}),(l,c)=>(i(),h(D,null,[u(v).simpleCpList?y("",!0):(i(),h("swiper-container",{key:0,"space-between":0,"slides-per-view":1,pagination:{clickable:!0},class:z(["cplist m-0 p-0 swiper-chargepoints d-flex align-items-stretch",o.value])},[(i(!0),h(D,null,q(s.value,d=>(i(),h("swiper-slide",{key:d.id},[n("div",{class:z([u(Ie)?"mb-0":"mb-5","d-flex align-items-stretch flex-fill"])},[m(Ci,{chargepoint:d,"full-width":!0},null,8,["chargepoint"])],2)]))),128))],2)),u(v).simpleCpList?(i(),B(ec,{key:1})):y("",!0)],64))}}),tc={class:"container-fluid p-0 m-0"},ac={class:"row p-0 m-0"},nc={class:"d-grid gap-2"},oc=["onClick"],sc={class:"col-md-4 p-1"},rc={class:"d-grid gap-2"},lc={key:0},ic=n("hr",null,null,-1),cc=n("div",{class:"row"},[n("div",{class:"col text-center"},"Vorrang im Lademodus PV-Laden:")],-1),dc={class:"row justify-content-center m-1 p-0"},uc={class:"col-6 p-1 m-0"},hc={class:"d-grid gap-2"},pc=n("span",{class:"fas fa-car"}," ",-1),gc={class:"col-6 p-1 m-0"},mc={class:"d-grid gap-2"},fc=n("span",{class:"fas fa-car-battery"}," ",-1),vc=I({__name:"BBSelect",props:{cpId:{}},setup(t){const e=t,a=[{mode:"instant_charging",name:"Sofort",color:"var(--color-charging)"},{mode:"pv_charging",name:"PV",color:"var(--color-pv)"},{mode:"scheduled_charging",name:"Zielladen",color:"var(--color-battery)"},{mode:"standby",name:"Standby",color:"var(--color-axis)"},{mode:"stop",name:"Stop",color:"var(--color-axis)"}],s=g(()=>T[e.cpId]);function o(p){return p==s.value.chargeMode?"btn btn-success buttonTextSize":"btn btn-secondary buttonTextSize"}function r(p){switch(p){case"ev":return re.pvBatteryPriority?"btn-secondary":"btn-success";case"bat":return re.pvBatteryPriority?"btn-success":"btn-secondary";default:return""}}function l(p){s.value.chargeMode=p}function c(p){s.value.isLocked=p}function d(p){re.pvBatteryPriority=p}return(p,w)=>(i(),h("div",tc,[n("div",ac,[(i(),h(D,null,q(a,(M,C)=>n("div",{key:C,class:"col-md-4 p-1"},[n("div",nc,[n("button",{type:"button",class:z(o(M.mode)),style:{},onClick:S=>l(M.mode)},k(M.name),11,oc)])])),64)),n("div",sc,[n("div",rc,[s.value.isLocked?(i(),h("button",{key:0,type:"button",class:"btn btn-outline-success buttonTextSize","data-bs-dismiss":"modal",onClick:w[0]||(w[0]=M=>c(!1))}," Entsperren ")):y("",!0),s.value.isLocked?y("",!0):(i(),h("button",{key:1,type:"button",class:"btn btn-outline-danger buttonTextSize","data-bs-dismiss":"modal",onClick:w[1]||(w[1]=M=>c(!0))}," Sperren "))])])]),u(re).isBatteryConfigured&&s.value.chargeMode=="pv_charging"?(i(),h("div",lc,[ic,cc,n("div",dc,[n("div",uc,[n("div",hc,[n("button",{id:"evPriorityBtn",type:"button",class:z(["priorityModeBtn btn btn-secondary buttonTextSize",r("ev")]),"data-dismiss":"modal",priority:"1",onClick:w[2]||(w[2]=M=>d(!1))},[U(" EV "),pc],2)])]),n("div",gc,[n("div",mc,[n("button",{id:"batteryPriorityBtn",type:"button",class:z(["priorityModeBtn btn btn-secondary buttonTextSize",r("bat")]),"data-dismiss":"modal",priority:"0",onClick:w[3]||(w[3]=M=>d(!0))},[U(" Speicher "),fc],2)])])])])):y("",!0)]))}}),_c={class:"col-lg-4 p-0 m-0 mt-1"},bc={class:"d-grid gap-2"},yc=["data-bs-target"],wc={class:"m-0 p-0 d-flex justify-content-between align-items-center"},kc={class:"mx-1 badge rounded-pill smallTextSize plugIndicator"},$c={key:0,class:"ms-2"},Sc={class:"m-0 p-0"},xc={key:0,class:"ps-1"},Pc=I({__name:"BbChargeButton",props:{chargepoint:{}},setup(t){const e=t,a="chargeSelectModal"+e.chargepoint.id,s=g(()=>se[e.chargepoint.chargeMode].name),o=g(()=>{let w={background:"var(--color-menu)"};return e.chargepoint.isLocked?w.background="var(--color-evu)":e.chargepoint.isCharging?w.background="var(--color-charging)":e.chargepoint.isPluggedIn&&(w.background="var(--color-battery)"),w}),r=g(()=>{if(se){let w={background:se[e.chargepoint.chargeMode].color,color:"white"};switch(e.chargepoint.chargeMode){case ce.instant_charging:e.chargepoint.isCharging&&!e.chargepoint.isLocked&&(w=p(w));break;case ce.standby:case ce.stop:w.background="darkgrey",w.color="black";break;case ce.scheduled_charging:e.chargepoint.isPluggedIn&&!e.chargepoint.isCharging&&!e.chargepoint.isLocked&&(w=p(w));break}return w}else return{background:"var(--color-bg)",color:"var(--color-bg)"}}),l=g(()=>se?se[e.chargepoint.chargeMode].icon:""),c=g(()=>re.pvBatteryPriority?"fa-car-battery":"fa-car"),d=g(()=>{let w="fa-ellipsis";return e.chargepoint.isLocked?w="fa-lock":e.chargepoint.isCharging?w=" fa-bolt":e.chargepoint.isPluggedIn&&(w="fa-plug"),"fa "+w});function p(w){let M=w.color;return w.color=w.background,w.background=M,w}return(w,M)=>(i(),h("div",_c,[n("div",bc,[n("button",{type:"button",class:"btn mx-1 mb-0 p-1 regularTextSize chargeButton shadow",style:H(o.value),"data-bs-toggle":"modal","data-bs-target":"#"+a},[n("div",wc,[n("span",kc,[n("i",{class:z(d.value)},null,2),w.chargepoint.isCharging?(i(),h("span",$c,k(u(Be)(w.chargepoint.power)),1)):y("",!0)]),n("span",Sc,k(w.chargepoint.name),1),n("span",{class:"mx-2 m-0 badge rounded-pill smallTextSize modeIndicator",style:H(r.value)},[n("i",{class:z(["fa me-1",l.value])},null,2),U(" "+k(s.value)+" ",1),w.chargepoint.chargeMode==u(ce).pv_charging&&u(re).isBatteryConfigured?(i(),h("span",xc,[U(" ( "),n("i",{class:z(["fa m-0",c.value])},null,2),U(") ")])):y("",!0)],4)])],12,yc)]),m(Lt,{"modal-id":a},{title:b(()=>[U(" Lademodus für "+k(w.chargepoint.name),1)]),default:b(()=>[m(vc,{"cp-id":w.chargepoint.id},null,8,["cp-id"])]),_:1})]))}});const Mc=E(Pc,[["__scopeId","data-v-888cf4ca"]]),Cc={class:"row p-0 mt-0 mb-1 m-0"},Ic={class:"col p-0 m-0"},Bc={class:"container-fluid p-0 m-0"},Vc={class:"row p-0 m-0 d-flex justify-content-center"},Tc=I({__name:"ButtonBar",setup(t){return(e,a)=>(i(),h("div",Cc,[n("div",Ic,[n("div",Bc,[n("div",Vc,[(i(!0),h(D,null,q(u(T),(s,o)=>(i(),B(Mc,{key:o,chargepoint:s,"charge-point-count":Object.values(u(T)).length},null,8,["chargepoint","charge-point-count"]))),128))])])])]))}}),Wt=t=>(K("data-v-694d07cd"),t=t(),ee(),t),Lc=Wt(()=>n("span",{class:"fas fa-car-battery me-2",style:{color:"var(--color-battery)"}}," ",-1)),Oc=Wt(()=>n("span",{class:"sh-title py-4"},"Speicher",-1)),Ac={class:"col m-0 mb-1 p-0 d-flex justify-content-between"},Wc={class:"col m-0 mt-3 mb-1 p-0 d-flex justify-content-between"},Dc=Wt(()=>n("span",{class:"todaystring mt-4 float-right"}," Heute:",-1)),Ec=I({__name:"BatteryList",setup(t){const e=g(()=>F.batOut.power>0?"Liefert":A.batIn.power>0?"Lädt":"Bereit"),a=g(()=>Be(F.batOut.power+A.batIn.power));return(s,o)=>u(re).isBatteryConfigured?(i(),B(xe,{key:0,"variable-width":!0},{title:b(()=>[Lc,Oc]),default:b(()=>[n("div",Ac,[m(oe,{heading:"Ladestand:"},{default:b(()=>[m(At,{soc:u(re).batterySoc,class:"me-2"},null,8,["soc"])]),_:1}),m(oe,{heading:"Status:"},{default:b(()=>[n("span",null,k(e.value),1)]),_:1}),m(oe,{heading:"Leistung:"},{default:b(()=>[n("span",null,k(a.value),1)]),_:1})]),n("div",Wc,[m(oe,{heading:""},{default:b(()=>[Dc]),_:1}),m(oe,{heading:"Geladen:"},{default:b(()=>[n("span",null,k(u(Qe)(u(A).batIn.energy)),1)]),_:1}),m(oe,{heading:"Geliefert"},{default:b(()=>[n("span",null,k(u(Qe)(u(F).batOut.energy)),1)]),_:1})])]),_:1})):y("",!0)}});const $t=E(Ec,[["__scopeId","data-v-694d07cd"]]);class Gc{constructor(){f(this,"etPriceList","");f(this,"_etMaxPrice",20);f(this,"etCurrentPrice",0);f(this,"isEtEnabled",!1);f(this,"etProvider","")}get etMaxPrice(){return this._etMaxPrice}set etMaxPrice(e){this._etMaxPrice=e,Z("etMaxPrice",e)}updateEtMaxPrice(e){this._etMaxPrice=e}}const Fe=J(new Gc),jc=t=>(K("data-v-453a6579"),t=t(),ee(),t),Uc=jc(()=>n("p",null,"not implemented yet",-1)),zc=I({__name:"PriceChart",setup(t){return(e,a)=>u(Fe).isEtEnabled?(i(),B(xe,{key:0},{default:b(()=>[Uc]),_:1})):y("",!0)}});const Nc=E(zc,[["__scopeId","data-v-453a6579"]]),Fc={class:"d-flex float-right justify-content-end align-items-center"},qc={key:0,class:"my-0 badge rounded-pill tempbadge mx-1"},Hc={class:"row m-1 mt-0 p-0"},Rc={class:"col m-0 mb-1 p-0 d-flex justify-content-between"},Jc=I({__name:"SHListItem",props:{device:{}},setup(t){const e=t,a=g(()=>e.device.status=="on"?"fa-toggle-on":e.device.status=="waiting"?"fa-spinner fa-spin":"fa-toggle-off"),s=g(()=>{let c="var(--color-switchRed)";switch(e.device.status){case"on":c="var(--color-switchGreen)";break;case"detection":c="var(--color-switchBlue)";break;case"timeout":c="var(--color-switchWhite)";break;case"waiting":c="var(--color-menu)";break;default:c="var(--color-switchRed)"}return{color:c}});function o(){e.device.isAutomatic||(e.device.status=="on"?Z("shSwitchOn",0,e.device.id):Z("shSwitchOn",1,e.device.id),N[e.device.id].status="waiting")}function r(){e.device.isAutomatic?Z("shSetManual",1,e.device.id):Z("shSetManual",0,e.device.id)}const l=g(()=>e.device.isAutomatic?"Auto":"Man");return(c,d)=>(i(),B(ua,{titlecolor:c.device.color,fullwidth:!0},{title:b(()=>[U(k(c.device.name),1)]),buttons:b(()=>[n("div",Fc,[(i(!0),h(D,null,q(c.device.temp,(p,w)=>(i(),h("span",{key:w,class:"p-0 m-0 align-items-center d-flex"},[w<c.device.tempConfigured?(i(),h("span",qc,k(u(pn)(p)),1)):y("",!0)]))),128)),e.device.canSwitch?(i(),h("span",{key:0,class:z([a.value,"fa statusbutton mr-2 ms-4"]),style:H(s.value),onClick:o},null,6)):y("",!0),e.device.canSwitch?(i(),h("span",{key:1,class:"badge rounded-pill modebutton mx-2",onClick:r},k(l.value),1)):y("",!0)])]),default:b(()=>[n("div",Hc,[n("div",Rc,[m(oe,{heading:"Leistung:"},{default:b(()=>[m(Bt,{watt:c.device.power},null,8,["watt"])]),_:1}),m(oe,{heading:"Energie:"},{default:b(()=>[m(fa,{"watt-h":c.device.energy},null,8,["watt-h"])]),_:1}),m(oe,{heading:"Laufzeit:"},{default:b(()=>[U(k(u(un)(c.device.runningTime)),1)]),_:1})])])]),_:1},8,["titlecolor"]))}});const Qc=E(Jc,[["__scopeId","data-v-064f5a85"]]),et=t=>(K("data-v-4488e90b"),t=t(),ee(),t),Yc=et(()=>n("span",{class:"fas fa-plug me-2",style:{color:"var(--color-devices)"}}," ",-1)),Zc={class:"sh-title py-4"},Xc=et(()=>n("span",{class:"fa-solid fa-lg ps-1 fa-ellipsis-vertical"},null,-1)),Kc=[Xc],ed=et(()=>n("span",{class:"fas fa-gear"}," ",-1)),td=et(()=>n("span",{class:"fa-solid fa-lg ps-1 fa-circle-check"},null,-1)),ad=[td],nd=["id","onUpdate:modelValue","value"],od=["for"],sd=et(()=>n("div",{class:"col-12 mb-3 pe-3 mt-0"},[n("button",{class:"btn btn-sm btn-secondary float-end"},"Schließen")],-1)),rd=[sd],ld=3,id=I({__name:"SmartHomeList",setup(t){const e=g(()=>Ie.value?a.value.reduce((l,c)=>{const d=l;let p=l[l.length-1];return p.length>=ld?l.push([c]):p.push(c),d},[[]]):[a.value]),a=g(()=>Object.values(N).filter(l=>l.configured));function s(l){return"Geräte"+(Ie.value&&e.value.length>1?"("+(l+1)+")":"")}function o(){r.value=!r.value}const r=le(!1);return(l,c)=>(i(),h(D,null,[(i(!0),h(D,null,q(e.value,(d,p)=>(i(),B(dt,{key:p,"variable-width":!0},{title:b(()=>[n("span",{onClick:o},[Yc,n("span",Zc,k(s(p)),1)])]),buttons:b(()=>[n("span",{class:"ms-2 pt-1",onClick:o},Kc)]),default:b(()=>[(i(!0),h(D,null,q(d,w=>(i(),B(Qc,{key:w.id,device:w},null,8,["device"]))),128))]),_:2},1024))),128)),r.value?(i(),B(dt,{key:0},{title:b(()=>[n("span",{class:"smarthome",onClick:o},[ed,U(" Einstellungen")])]),buttons:b(()=>[n("span",{class:"ms-2 pt-1",onClick:o},ad)]),default:b(()=>[m(O,{title:"Im Energie-Graph anzeigen:",icon:"fa-chart-column",fullwidth:!0},{default:b(()=>[(i(!0),h(D,null,q(a.value,(d,p)=>(i(),h("div",{key:p},[Oe(n("input",{id:"check"+p,"onUpdate:modelValue":w=>d.showInGraph=w,class:"form-check-input",type:"checkbox",value:d},null,8,nd),[[_t,d.showInGraph]]),n("label",{class:"form-check-label px-2",for:"check"+p},k(d.name),9,od)]))),128))]),_:1}),n("div",{class:"row p-0 m-0",onClick:o},rd)]),_:1})):y("",!0)],64))}});const St=E(id,[["__scopeId","data-v-4488e90b"]]),cd={class:"row py-0 px-0 m-0"},dd={"space-between":0,pagination:{clickable:!0},"slides-per-view":"1",class:"p-0 m-0 swiper-carousel",breakpoints:{992:{slidesPerView:3,spaceBetween:0}}},ud=I({__name:"CarouselFix",setup(t){return(e,a)=>(i(),h("div",cd,[n("swiper-container",dd,[n("swiper-slide",null,[n("div",{class:z([u(Ie)?"mb-0":"mb-5","flex-fill d-flex align-items-stretch"])},[ae(e.$slots,"item1",{},void 0,!0)],2)]),n("swiper-slide",null,[n("div",{class:z([u(Ie)?"mb-0":"mb-5","flex-fill d-flex align-items-stretch"])},[ae(e.$slots,"item2",{},void 0,!0)],2)]),n("swiper-slide",null,[n("div",{class:z([u(Ie)?"mb-0":"mb-5","flex-fill d-flex align-items-stretch"])},[ae(e.$slots,"item3",{},void 0,!0)],2)])])]))}});const hd=E(ud,[["__scopeId","data-v-3ef4f401"]]);function pd(t,e){t=="openWB/graph/boolDisplayLiveGraph"?re.displayLiveGraph=+e==1:t.match(/^openwb\/graph\/alllivevaluesJson[1-9][0-9]*$/i)?gd(t,e):t=="openWB/graph/lastlivevaluesJson"?md(t,e):t=="openWB/graph/config/duration"&&(te.duration=JSON.parse(e))}function gd(t,e){if(!te.initialized){let a=[];const s=e.toString().split(`
`);s.length>1?a=s.map(l=>JSON.parse(l)):a=[];const o=t.match(/(\d+)$/g),r=o?o[0]:"";r!=""&&typeof te.rawDataPacks[+r-1]>"u"&&(te.rawDataPacks[+r-1]=a,te.initCounter++)}if(te.initCounter==16){const a=[];te.unsubscribeRefresh(),te.initialized=!0,te.rawDataPacks.map(s=>{s.map(o=>{const r=va(o);a.push(r)})}),Xe(a),te.subscribeUpdates()}}function md(t,e){const a=JSON.parse(e),s=va(a);te.graphRefreshCounter++,Xe(_.data.concat(s)),te.graphRefreshCounter>60&&te.activate()}function va(t){const e={};e.date=fd(t.time).valueOf(),+t.grid>0?(e.gridPull=+t.grid,e.gridPush=0):+t.grid<=0?(e.gridPull=0,e.gridPush=-t.grid):(e.gridPull=0,e.gridPush=0),+t["pv-all"]>=0?(e.solarPower=+t["pv-all"],e.inverter=0):(e.solarPower=0,e.inverter=-t["pv-all"]),e.house=+t["house-power"],+t["bat-all-power"]>0?(e.batOut=0,e.batIn=+t["bat-all-power"]):+t["bat-all-power"]<0?(e.batOut=-t["bat-all-power"],e.batIn=0):(e.batOut=0,e.batIn=0),t["bat-all-soc"]?e.batterySoc=+t["bat-all-soc"]:e.batterySoc=0,e.charging=+t["charging-all"];for(let a=0;a<10;a++)t["cp"+a+"-power"]?e["cp"+a]=+t["cp"+a+"-power"]:e["cp"+a]=0;return e.selfUsage=e.solarPower-e.gridPush,e.selfUsage<0&&(e.selfUsage=0),e.devices=0,e}function fd(t){const e=new Date(Date.now()),a=864e5;let s=new Date;const o=Je("%H:%M:%S")(t);return o&&(s=o,s.setDate(e.getDate()),s.setMonth(e.getMonth()),s.setFullYear(e.getFullYear()),s.getHours()>e.getHours()&&(s=new Date(s.getTime()-a))),s}let at={},_a={},qe=[],ut=[],ht=[];function vd(t,e){const a=JSON.parse(e).entries;qe=Object.values(X).map(o=>"soc-ev"+o.id.toString()),Te.map(o=>{$[o].energyPv=0,$[o].energyBat=0}),ut=[],ht=[];const s=_d(a);Xe(s),Te.map(o=>{$[o].energyPv=Math.round($[o].energyPv*100)/100,$[o].energyBat=Math.round($[o].energyBat*100)/100}),kd(at,_a),_.graphMode=="today"&&setTimeout(()=>R.activate(),3e5)}function _d(t){const e=[];let a={},s={};return t.map((o,r)=>{if(s=bd(o),r==0)at=s,at.chargingPv=0,at.chargingBat=0;else{const l=yd(s,a);e.push(l),Te.map(c=>{$[c].energyPv+=l[c+"Pv"]/12,$[c].energyBat+=l[c+"Bat"]/12})}a=s}),_a=s,e}function bd(t){const e={};if(_.graphMode=="day"||_.graphMode=="today"){const a=Je("%H:%M")(t.date);a&&(a.setMonth(R.date.getMonth()),a.setDate(R.date.getDate()),a.setFullYear(R.date.getFullYear()),e.date=a.getTime())}else{const a=Je("%Y%m%d")(t.date);a&&(e.date=a.getDate())}return Object.entries(t.counter).forEach(a=>{e.gridPush=a[1].exported,e.gridPull=a[1].imported}),Object.entries(t.pv).forEach(([a,s])=>{a=="pv1"&&(e.solarPower=s.exported)}),Object.entries(t.bat).length>0?Object.entries(t.bat).forEach(([a,s])=>{a=="all"&&(e.batIn=s.imported,e.batOut=s.exported)}):(e.batIn=0,e.batOut=0),Object.entries(t.cp).forEach(([a,s])=>{a!="all"?(e[a]=s.imported,e["soc"+a]=s.soc,a in ht||ht.push(a)):e.charging=s.imported}),Object.entries(t.ev).forEach(([a,s])=>{a!="all"&&(e["soc-"+a]=s.soc)}),e.devices=0,Object.entries(t.sh).forEach(([a,s])=>{a!="all"&&(e[a]=s.imported,e.devices+=s.imported,a in ut||ut.push(a))}),e}function yd(t,e){const a={};return a.date=t.date,["gridPull","gridPush","solarPower","batIn","batOut","charging","devices"].concat(ht).concat(ut).forEach(r=>{a[r]=wd(t,e,r)}),a.soc0=qe[0]?t[qe[0]]:0,a.soc1=qe[1]?t[qe[1]]:0,a.selfUsage=a.solarPower-a.gridPush,a.house=a.solarPower+a.gridPull+a.batOut-a.gridPush-a.batIn-a.charging-a.devices,a.inverter=0,a.gridPull+a.batOut+a.solarPower>0?Te.map(r=>Vt(r,a)):Te.map(r=>{a[r+"Pv"]=0,a[r+"Bat"]=0}),a}function wd(t,e,a){return t[a]!==void 0&&e[a]!==void 0&&t[a]>e[a]?12*(t[a]-e[a])/1e3:(t[a]=e[a],0)}function kd(t,e){$.pv.energy=e.solarPower-t.solarPower,$.evuIn.energy=e.gridPull-t.gridPull,$.batOut.energy=e.batOut-t.batOut,$.evuOut.energy=e.gridPush-t.gridPush,$.batIn.energy=e.batIn-t.batIn,$.charging.energy=e.charging-t.charging,$.devices.energy=e.devices-t.devices,$.charging.pvPercentage=Math.round(($.charging.energyPv+$.charging.energyBat)/$.charging.energy*100),$.house.energy=$.evuIn.energy+$.pv.energy+$.batOut.energy-$.evuOut.energy-$.batIn.energy-$.charging.energy-$.devices.energy,A.devices.energy=$.devices.energy,Te.map(a=>{A[a].energyPv=$[a].energyPv,A[a].energyBat=$[a].energyBat,$[a].pvPercentage=Math.round(($[a].energyPv+$[a].energyBat)/$[a].energy*100),A[a].pvPercentage=$[a].pvPercentage})}let He={};const pt=["charging","house","batIn","devices"];function $d(t,e){const a=JSON.parse(e).entries;pt.map(s=>{$[s].energyPv=0,$[s].energyBat=0}),Xe(Sd(a)),sa(He),xd(t,e)}function Sd(t){const e=[];let a={};return He={},t.map(s=>{a=ba(s),e.push(a),pt.map(o=>{$[o].energyPv+=a[o+"Pv"],$[o].energyBat+=a[o+"Bat"]}),Object.keys(a).map(o=>{o!="date"&&(He[o]?He[o]+=a[o]:He[o]=a[o])})}),e}function xd(t,e){JSON.parse(e).entries.map(s=>{ba(s)})}function ba(t){const e={},a=Je("%Y%m%d")(t.date);return a&&(e.date=a.getDate()),Object.entries(t.counter).forEach(o=>{e.gridPush=o[1].energy_exported,e.gridPull=o[1].energy_imported}),Object.entries(t.pv).forEach(([o,r])=>{o=="all"&&(e.solarPower=r.energy_exported)}),Object.entries(t.bat).length>0?Object.entries(t.bat).forEach(([o,r])=>{o=="all"&&(e.batIn=r.energy_imported,e.batOut=r.energy_exported)}):(e.batIn=0,e.batOut=0),Object.entries(t.cp).forEach(([o,r])=>{o!="all"?e[o]=r.energy_imported:e.charging=r.energy_imported}),Object.entries(t.ev).forEach(([o,r])=>{o!="all"&&(e["soc-"+o]=r.soc)}),e.devices=Object.entries(t.sh).reduce((o,r)=>(o+=r[1].energy_imported,o),0),e.selfUsage=e.solarPower-e.gridPush,e.house=e.solarPower+e.gridPull+e.batOut-e.gridPush-e.batIn-e.charging,e.inverter=0,e.gridPull+e.batOut+e.solarPower>0?pt.map(o=>Vt(o,e)):pt.map(o=>{e[o+"Pv"]=0,e[o+"Bat"]=0}),e}let Re={};const gt=["charging","house","batIn","devices"];function Pd(t,e){const a=JSON.parse(e).entries;gt.map(s=>{$[s].energyPv=0,$[s].energyBat=0}),Xe(Md(a)),sa(Re),Cd(t,e)}function Md(t){const e=[];let a={};return Re={},t.map(s=>{a=ya(s),e.push(a),gt.map(o=>{$[o].energyPv+=a[o+"Pv"],$[o].energyBat+=a[o+"Bat"]}),Object.keys(a).map(o=>{o!="date"&&(a[o]<0&&(console.warn(`Negative energy value for ${o} in row ${a.date}. Ignoring the value.`),a[o]=0),Re[o]?Re[o]+=a[o]:Re[o]=a[o])})}),e}function Cd(t,e){JSON.parse(e).entries.map(s=>{ya(s)})}function ya(t){const e={},a=Je("%Y%m%d")(t.date);return a&&(e.date=a.getMonth()+1),Object.entries(t.counter).forEach(o=>{e.gridPush=o[1].energy_exported/1e3,e.gridPull=o[1].energy_imported/1e3}),Object.entries(t.pv).forEach(([o,r])=>{o=="all"&&(e.solarPower=r.energy_exported/1e3)}),Object.entries(t.bat).length>0?Object.entries(t.bat).forEach(([o,r])=>{o=="all"&&(e.batIn=r.energy_imported/1e3,e.batOut=r.energy_exported/1e3)}):(e.batIn=0,e.batOut=0),Object.entries(t.cp).forEach(([o,r])=>{o!="all"?e[o]=r.energy_imported/1e3:e.charging=r.energy_imported/1e3}),Object.entries(t.ev).forEach(([o,r])=>{o!="all"&&(e["soc-"+o]=r.soc)}),e.devices=Object.entries(t.sh).reduce((o,r)=>(r[1].energy_imported>=0?o+=r[1].energy_imported/1e3:console.warn(`Negative energy value for device ${r[0]} in row ${e.date}. Ignoring this value`),o),0),e.selfUsage=e.solarPower-e.gridPush,e.house=e.solarPower+e.gridPull+e.batOut-e.gridPush-e.batIn-e.charging,e.inverter=0,e.gridPull+e.batOut+e.solarPower>0?gt.map(o=>Vt(o,e)):gt.map(o=>{e[o+"Pv"]=0,e[o+"Bat"]=0}),e}class Id{constructor(e){f(this,"id");f(this,"dailyYieldExport",0);f(this,"dailyYieldImport",0);f(this,"exported",0);f(this,"faultState",0);f(this,"faultStr","");f(this,"imported",0);f(this,"power",0);f(this,"soc",0);this.id=e}}class Bd{constructor(){f(this,"dailyExport",0);f(this,"dailyImport",0);f(this,"exported",0);f(this,"imported",0);f(this,"power",0);f(this,"soc",0)}}const pe=J({});J(new Bd);function Vd(t){t in pe?console.info("Duplicate battery message: "+t):(pe[t]=new Id(t),console.info("Added battery "+t))}function Td(){Object.keys(pe).forEach(t=>{delete pe[parseInt(t)]})}function Ld(t,e){const a=Od(t);if(a&&!(a in pe)){console.warn("Invalid battery index received: "+a);return}t=="openWB/bat/config/configured"?re.isBatteryConfigured=e=="true":t=="openWB/bat/get/power"?+e>0?(A.batIn.power=+e,F.batOut.power=0):(A.batIn.power=0,F.batOut.power=-e):t=="openWB/bat/get/soc"?re.batterySoc=+e:t=="openWB/bat/get/daily_exported"?F.batOut.energy=+e:t=="openWB/bat/get/daily_imported"?A.batIn.energy=+e:a&&(t.match(/^openwb\/bat\/[0-9]+\/get\/daily_yield_export$/i)?pe[a].dailyYieldExport=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/daily_yield_import$/i)?pe[a].dailyYieldImport=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/exported$/i)?pe[a].exported=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/fault_state$/i)?pe[a].faultState=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/fault_str$/i)?pe[a].faultStr=e:t.match(/^openwb\/bat\/[0-9]+\/get\/imported$/i)?pe[a].imported=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/power$/i)?pe[a].power=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/soc$/i)&&(pe[a].soc=+e))}function Od(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch{console.warn("Parser error in getIndex for topic "+t)}}function Ad(t,e){t=="openWB/optional/et/active"?Fe.isEtEnabled=JSON.parse(e):t=="openWB/optional/et/get/price"?Fe.etCurrentPrice=parseFloat(e):t=="openWB/optional/et/config/max_price"?Fe.updateEtMaxPrice(parseFloat(e)):t=="openWB/optional/et/provider"&&(Fe.etProvider=JSON.parse(e))}function Wd(t,e){const a=wa(t);if(a&&!(a in T)){console.warn("Invalid chargepoint id received: "+a);return}if(t=="openWB/chargepoint/get/power"?A.charging.power=+e:t=="openWB/chargepoint/get/daily_imported"&&(A.charging.energy=+e),t=="openWB/chargepoint/get/daily_exported")re.cpDailyExported=+e;else if(a){if(t.match(/^openwb\/chargepoint\/[0-9]+\/config$/i))if(T[a]){const s=JSON.parse(e);T[a].name=s.name,T[a].icon=s.name}else console.warn("invalid chargepoint index: "+a);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/state_str$/i))T[a].stateStr=JSON.parse(e);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/fault_str$/i))T[a].faultStr=JSON.parse(e);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/fault_state$/i))T[a].faultState=+e;else if(t.match(/^openWB\/chargepoint\/[0-9]+\/get\/power$/i))T[a].power=+e;else if(t.match(/^openWB\/chargepoint\/[0-9]+\/get\/daily_imported$/i))T[a].dailyYield=+e/1e3;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/plug_state$/i))T[a].isPluggedIn=e=="true";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/charge_state$/i))T[a].isCharging=e=="true";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/manual_lock$/i))T[a].updateIsLocked(e=="true");else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/enabled$/i))T[a].isEnabled=e=="1";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/phases_in_use/i))T[a].phasesInUse=+e;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/current/i))T[a].current=+e;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/log/i)){const s=JSON.parse(e);T[a].chargedSincePlugged=s.imported_since_plugged}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/soc$/i)){const s=JSON.parse(e);T[a].rangeCharged=s.range_charged,T[a].rangeUnit=s.range_unit}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/soc_config$/i))T[a].isSocManual=e=="manual";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/info$/i)){const s=JSON.parse(e);T[a].vehicleName=String(s.name),T[a].updateConnectedVehicle(+s.id)}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/config$/i)){const s=JSON.parse(e);switch(s.chargemode){case"instant_charging":T[a].updateChargeMode(ce.instant_charging);break;case"pv_charging":T[a].updateChargeMode(ce.pv_charging);break;case"scheduled_charging":T[a].updateChargeMode(ce.scheduled_charging);break;case"standby":T[a].updateChargeMode(ce.standby);break;case"stop":T[a].updateChargeMode(ce.stop);break}T[a].chargeTemplate=s.charge_template,T[a].averageConsumption=s.average_consumption}}}function Dd(t,e){const a=wa(t);if(a!=null){if(!(a in X)){const s=new Ja(a);X[a]=s}t.match(/^openwb\/vehicle\/[0-9]+\/name$/i)?(Object.values(T).forEach(s=>{s.connectedVehicle==a&&(s.vehicleName=JSON.parse(e))}),X[a].name=JSON.parse(e)):t.match(/^openwb\/vehicle\/[0-9]+\/get\/soc$/i)?Object.values(T).forEach(s=>{s.connectedVehicle==a&&(s.soc=JSON.parse(e))}):t.match(/^openwb\/vehicle\/[0-9]+\/get\/range$/i)?X[a].range=+e:t.match(/^openwb\/vehicle\/[0-9]+\/charge_template$/i)?X[a].updateChargeTemplateId(+e):t.match(/^openwb\/vehicle\/[0-9]+\/ev_template$/i)&&X[a].updateEvTemplateId(+e)}}function Ed(t,e){if(t.match(/^openwb\/vehicle\/template\/charge_template\/[0-9]+$/i)){const a=t.match(/[0-9]+$/i);if(a){const s=+a[0],o=JSON.parse(e);o.chargemode.scheduled_charging.plans||(o.chargemode.scheduled_charging.plans={}),o.time_charging.plans||(o.time_charging.plans={}),ue[s]=o,Gd(s,o)}}else if(t.match(/^openwb\/vehicle\/template\/charge_template\/[0-9]+\/time_charging\/plans\/[0-9]+$/i)){const a=t.match(/(?:\/)([0-9]+)(?:\/)/g),s=t.match(/[0-9]+$/i);if(a&&s){const o=+a[0].replace(/[^0-9]+/g,""),r=+s[0],l=JSON.parse(e);ue[o].time_charging.plans[r]=l}}else if(t.match(/^openwb\/vehicle\/template\/ev_template\/[0-9]+$/i)){const a=t.match(/[0-9]+$/i);if(a){const s=+a[0],o=JSON.parse(e);xt[s]=o}}}function Gd(t,e){Object.values(T).forEach(a=>{a.chargeTemplate==t&&(a.updateCpPriority(e.prio),a.updateInstantChargeLimitMode(e.chargemode.instant_charging.limit.selected),a.updateInstantTargetCurrent(e.chargemode.instant_charging.current),a.updateInstantTargetSoc(e.chargemode.instant_charging.limit.soc),a.updateInstantMaxEnergy(e.chargemode.instant_charging.limit.amount),a.updateScheduledCharging(e.time_charging.active),a.updatePvFeedInLimit(e.chargemode.pv_charging.feed_in_limit),a.updatePvMinCurrent(e.chargemode.pv_charging.min_current),a.updatePvMaxSoc(e.chargemode.pv_charging.max_soc),a.updatePvMinSoc(e.chargemode.pv_charging.min_soc),a.updatePvMinSocCurrent(e.chargemode.pv_charging.min_soc_current))})}function wa(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch{console.warn("Parser error in getIndex for topic "+t)}}function jd(t,e){t.match(/^openWB\/LegacySmarthome\/config\//i)?Ud(t,e):t.match(/^openWB\/LegacySmarthome\/Devices\//i)&&zd(t,e)}function Ud(t,e){const a=ka(t);a!=null&&(a in N||It(a),t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_configured$/i)?N[a].configured=e!="0":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_name$/i)?N[a].name=e.toString():t.match(/^openWB\/LegacySmarthome\/config\/set\/Devices\/[0-9]+\/mode$/i)?N[a].isAutomatic=e=="0":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_canswitch$/i)?N[a].canSwitch=e=="1":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_temperatur_configured$/i)&&(N[a].tempConfigured=+e))}function zd(t,e){const a=ka(t);if(a==null){console.warn("Smarthome: Missing index in "+t);return}if(a in N||It(a),t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/Watt$/i))N[a].power=+e,Nd("power");else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/RunningTimeToday$/i))N[a].runningTime=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor0$/i))N[a].temp[0]=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor1$/i))N[a].temp[1]=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor2$/i))N[a].temp[2]=+e;else if(t.match(/^openWB\/LegacySmartHome\/Devices\/[0-9]+\/Status$/i))switch(+e){case 10:N[a].status="off";break;case 11:N[a].status="on";break;case 20:N[a].status="detection";break;case 30:N[a].status="timeout";break;default:N[a].status="off"}}function Nd(t){switch(t){case"power":A.devices.power=Object.values(N).filter(e=>e.configured).reduce((e,a)=>e+a.power,0);break;case"energy":A.devices.energy=Object.values(N).filter(e=>e.configured).reduce((e,a)=>e+a.energy,0);break;default:console.error("Unknown category")}}function ka(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch{console.warn("Parser error in getIndex for topic "+t)}}const Fd=["openWB/counter/#","openWB/bat/#","openWB/pv/get/#","openWB/chargepoint/#","openWB/vehicle/#","openWB/general/chargemode_config/pv_charging/#","openWB/optional/et/#","openWB/system/#","openWB/LegacySmartHome/#"];function qd(){qa(Hd),Fd.forEach(t=>{Ce(t)}),de()}function Hd(t,e){const a=e.toString();t.match(/^openwb\/counter\/[0-9]+\//i)?Rd(t,a):t.match(/^openwb\/counter\//i)?Jd(t,a):t.match(/^openwb\/bat\//i)?Ld(t,a):t.match(/^openwb\/pv\//i)?Qd(t,a):t.match(/^openwb\/chargepoint\//i)?Wd(t,a):t.match(/^openwb\/vehicle\/template\//i)?Ed(t,a):t.match(/^openwb\/vehicle\//i)?Dd(t,a):t.match(/^openwb\/general\/chargemode_config\/pv_charging\//i)?Yd(t,a):t.match(/^openwb\/graph\//i)?pd(t,a):t.match(/^openwb\/log\/daily\//i)?vd(t,a):t.match(/^openwb\/log\/monthly\//i)?$d(t,a):t.match(/^openwb\/log\/yearly\//i)?Pd(t,a):t.match(/^openwb\/optional\/et\//i)?Ad(t,a):t.match(/^openwb\/LegacySmartHome\//i)&&jd(t,a)}function Rd(t,e){const a=t.split("/");if(+a[2]==re.evuId)Zd(t,e);else if(a[3]!="config")switch(a[4]){}}function Jd(t,e){if(t.match(/^openwb\/counter\/get\/hierarchy$/i)){const a=JSON.parse(e);if(a.length){Ya(),Td();for(const s of a)s.type=="counter"&&(re.evuId=s.id);$a(a[0])}}else t.match(/^openwb\/counter\/set\/home_consumption$/i)?A.house.power=+e:t.match(/^openwb\/counter\/set\/daily_yield_home_consumption$/i)&&(A.house.energy=+e)}function $a(t){switch(t.type){case"counter":break;case"cp":Qa(t.id);break;case"bat":Vd(t.id);break}t.children.forEach(e=>$a(e))}function Qd(t,e){switch(t){case"openWB/pv/get/power":F.pv.power=-e;break;case"openWB/pv/get/daily_exported":F.pv.energy=+e;break}}function Yd(t,e){const a=t.split("/");if(a.length>0)switch(a[4]){case"bat_prio":re.updatePvBatteryPriority(e=="true");break}}function Zd(t,e){switch(t.split("/")[4]){case"power":+e>0?(F.evuIn.power=+e,A.evuOut.power=0):(F.evuIn.power=0,A.evuOut.power=-e);break;case"daily_imported":F.evuIn.energy=+e;break;case"daily_exported":A.evuOut.energy=+e;break}}const Xd=0,Kd={host:location.hostname,port:location.protocol=="https:"?443:80,endpoint:"/ws",protocol:location.protocol=="https:"?"wss":"ws",clean:!0,connectTimeout:4e3,reconnectPeriod:4e3,clientId:Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,6),username:"openWB",password:"openWB"},Rt={topic:"",qos:Xd};let je;const{host:eu,port:tu,endpoint:au,...Sa}=Kd,nu=`${Sa.protocol}://${eu}:${tu}${au}`;try{je=Jt.connect(nu,Sa),je.on("connect",()=>{console.info("MQTT connection successful")}),je.on("error",t=>{console.error("MQTT connection failed: ",t)})}catch(t){console.error("MQTT connect error: ",t)}function ou(t){je?je.on("message",t):console.error("MqttRegister: MQTT client not available")}function su(t){Rt.topic=t;const{topic:e,qos:a}=Rt;je.subscribe(e,{qos:a},s=>{if(s){console.error("MQTT Subscription error: "+s);return}console.info("MQTT Subscription successful: "+t)})}const mt=J([]);let ru=class xa{constructor(e,a,s,o){f(this,"name");f(this,"children");f(this,"count");f(this,"lastValue");this.name=e,this.children=a,this.count=s,this.lastValue=o}insert(e,a){if(e.length){const s=e.splice(1);if(e[0]==this.name)if(s.length){let o=!1;if(this.children.forEach(r=>{r.name==s[0]&&(r.insert(s,a),o=!0)}),!o){const r=new xa(s[0],[],0,"");r.insert(s,a),this.children.push(r)}}else this.count=this.count+1,this.lastValue=a}}};function lu(t,e){const a=t.split("/");if(a.length){let s=!1;if(mt.forEach(o=>{o.name==a[0]&&(o.insert(a,e),s=!0)}),!s){const o=new ru(a[0],[],0,"");mt.push(o),o.insert(a,e)}}}const iu=["openWB/#"];function cu(){ou(du),iu.forEach(t=>{su(t)})}function du(t,e){lu(t,e.toString())}const uu={class:"row p-0 mb-0 mx-0"},hu={class:"py-2 m-0"},pu={key:0},gu={key:1,style:{"background-color":"white"},class:"p-2"},mu={key:0,class:"col-md-9 m-0 p-0 ps-2"},fu={class:"container-fluid m-0 p-0"},vu=I({__name:"MqttNode",props:{node:{},level:{},hide:{type:Boolean},expandAll:{type:Boolean}},setup(t){const e=t;let a=le(!e.hide),s=le(!1);const o=g(()=>e.node.name),r=g(()=>[...e.node.children].sort((w,M)=>w.name<M.name?-1:1)),l=g(()=>e.node.count>0?"("+e.node.count+")":""),c=g(()=>e.node.children.length),d=g(()=>e.node.lastValue!=""?{"background-color":"lightgoldenrodyellow"}:{"background-color":"lightsteelblue"});function p(){c.value>0&&(a.value=!a.value),e.node.lastValue!=""&&(s.value=!s.value)}return(w,M)=>{const C=Wa("MqttNode",!0);return i(),h("div",uu,[n("div",{class:"col-md m-0 px-2 node",style:H(d.value),onClick:p},[n("p",hu,k(o.value)+k(l.value),1),u(s)?(i(),h("hr",pu)):y("",!0),u(s)?(i(),h("p",gu,[n("code",null,k(e.node.lastValue),1)])):y("",!0)],4),(u(a)||e.expandAll)&&c.value>0?(i(),h("div",mu,[n("div",fu,[(i(!0),h(D,null,q(r.value,(S,P)=>(i(),B(C,{key:P,level:e.level+1,node:S,hide:!0,"expand-all":e.expandAll},null,8,["level","node","expand-all"]))),128))])])):y("",!0)])}}});const _u=E(vu,[["__scopeId","data-v-3dfd535f"]]),Dt=t=>(K("data-v-bf618b70"),t=t(),ee(),t),bu={class:"mqviewer"},yu={class:"row pt-2"},wu={class:"col"},ku=Dt(()=>n("h3",{class:"mqtitle ps-2"},"MQTT Message Viewer",-1)),$u=Dt(()=>n("hr",null,null,-1)),Su=Dt(()=>n("hr",null,null,-1)),xu={key:0},Pu=I({__name:"MQTTViewer",setup(t){Ue(()=>{cu()});const e=le(!1);function a(){e.value=!e.value}const s=g(()=>e.value?"active":"");return(o,r)=>(i(),h("div",bu,[n("div",yu,[n("div",wu,[ku,$u,n("button",{class:z(["btn btn-small btn-outline-primary ms-2",s.value]),onClick:a}," Expand All ",2),Su])]),u(mt)[0]?(i(),h("div",xu,[(i(!0),h(D,null,q(u(mt)[0].children.sort((l,c)=>l.name<c.name?-1:1),(l,c)=>(i(),B(_u,{key:c,node:l,level:1,hide:!0,"expand-all":e.value},null,8,["node","expand-all"]))),128))])):y("",!0)]))}});const Mu=E(Pu,[["__scopeId","data-v-bf618b70"]]),Cu={class:"container-fluid p-0 m-0"},Iu={class:"row p-0 m-0"},Bu=n("button",{class:"btn btn-secondary float-end mt-0 ms-1","data-bs-toggle":"collapse","data-bs-target":"#themesettings"},[n("span",null,[n("i",{class:"fa-solid fa-rectangle-xmark"})])],-1),Vu={class:"row m-0 p-0"},Tu=n("div",{class:"row p-0 m-0"},[n("div",{class:"col-12 mb-3 pe-3 mt-0"},[n("button",{class:"btn btn-sm btn-secondary float-end","data-bs-toggle":"collapse","data-bs-target":"#themesettings"}," Schließen ")])],-1),Lu=I({__name:"ThemeSettings",emits:["resetArcs"],setup(t,{emit:e}){const a=[["Dunkel","dark"],["Hell","light"],["Blau","blue"]],s=[["3 kW","0"],["3,1 kW","1"],["3,14 kW","2"],["3,141 kW","3"],["3141 W","4"]],o=[["Orange","normal"],["Grün/Violett","standard"],["Bunt","advanced"]];return(r,l)=>(i(),h("div",Cu,[n("div",Iu,[m(dt,{"full-width":!0},{title:b(()=>[U(" Look & Feel ")]),buttons:b(()=>[Bu]),default:b(()=>[n("div",Vu,[m(O,{title:"Farbschema",icon:"fa-adjust",infotext:"Hintergrundfarbe"},{default:b(()=>[m(Le,{modelValue:u(v).displayMode,"onUpdate:modelValue":l[0]||(l[0]=c=>u(v).displayMode=c),options:a},null,8,["modelValue"])]),_:1}),m(O,{title:"Grafik: Raster",icon:"fa-th",infotext:"Verwende ein Hintergrundraster in den Grafiken"},{default:b(()=>[m(me,{modelValue:u(v).showGrid,"onUpdate:modelValue":l[1]||(l[1]=c=>u(v).showGrid=c)},null,8,["modelValue"])]),_:1}),m(O,{title:"Variable Bogenlänge",icon:"fa-chart-area",infotext:"Im Graph 'Aktuelle Leistung' können die Bögen immer die volle Länge haben, oder entsprechend des aktuellen Gesamtleistung verkürzt dargestellt werden."},{default:b(()=>[m(me,{modelValue:u(v).showRelativeArcs,"onUpdate:modelValue":l[2]||(l[2]=c=>u(v).showRelativeArcs=c)},null,8,["modelValue"])]),_:1}),u(v).showRelativeArcs?(i(),B(O,{key:0,title:"Bögen zurücksetzen",icon:"fa-undo",infotext:"Durch Click auf den Button wird die Maximallänge der Bögen auf den aktuellen Wert gesetzt."},{default:b(()=>[u(v).showRelativeArcs?(i(),h("button",{key:0,class:"btn btn-secondary",onClick:l[3]||(l[3]=c=>e("resetArcs"))}," Reset ")):y("",!0)]),_:1})):y("",!0),m(O,{title:"Anzahl Dezimalstellen",icon:"fa-sliders-h",infotext:"Alle kW- und kWh-Werte werden mit der gewählten Anzahl an Stellen angezeigt."},{default:b(()=>[m(Ot,{modelValue:u(v).decimalPlaces,"onUpdate:modelValue":l[4]||(l[4]=c=>u(v).decimalPlaces=c),options:s},null,8,["modelValue"])]),_:1}),m(O,{title:"Farbschema Smart-Home-Geräte",icon:"fa-palette",infotext:"Für die Smart-Home-Geräte stehen mehrere Schemata zur Verfügung."},{default:b(()=>[m(Le,{modelValue:u(v).smartHomeColors,"onUpdate:modelValue":l[5]||(l[5]=c=>u(v).smartHomeColors=c),options:o},null,8,["modelValue"])]),_:1}),m(O,{title:"Kompakte Ladepunktliste",icon:"fa-list",infotext:"Zeige eine einzelne Ladepunktliste statt separater Element pro Ladepunkt."},{default:b(()=>[m(me,{modelValue:u(v).simpleCpList,"onUpdate:modelValue":l[6]||(l[6]=c=>u(v).simpleCpList=c)},null,8,["modelValue"])]),_:1}),m(O,{title:"Filter-Buttons",icon:"fa-filter",infotext:"Hauptseite mit Buttons zur Auswahl der Kategorie."},{default:b(()=>[m(me,{modelValue:u(v).showQuickAccess,"onUpdate:modelValue":l[7]||(l[7]=c=>u(v).showQuickAccess=c)},null,8,["modelValue"])]),_:1}),m(O,{title:"Animationen",icon:"fa-film",infotext:"Animationen anzeigen"},{default:b(()=>[m(me,{modelValue:u(v).showAnimations,"onUpdate:modelValue":l[8]||(l[8]=c=>u(v).showAnimations=c)},null,8,["modelValue"])]),_:1}),m(O,{title:"Breite Widgets",icon:"fa-desktop",infotext:"Widgets immer breit machen"},{default:b(()=>[m(me,{modelValue:u(v).preferWideBoxes,"onUpdate:modelValue":l[9]||(l[9]=c=>u(v).preferWideBoxes=c)},null,8,["modelValue"])]),_:1})]),Tu]),_:1})])]))}}),tt=t=>(K("data-v-29239cd3"),t=t(),ee(),t),Ou={class:"container-fluid px-2 m-0 theme-colors"},Au={id:"themesettings",class:"collapse"},Wu={key:1,class:"row py-0 px-0 m-0"},Du={key:2,class:"row py-0 m-0 d-flex justify-content-center"},Eu={key:3,class:"nav nav-tabs nav-justified mx-1 mt-2",role:"tablist"},Gu=Da('<a class="nav-link active" data-bs-toggle="tab" data-bs-target="#showAll" data-v-29239cd3><i class="fa-solid fa-lg fa-circle-info me-1" data-v-29239cd3></i><span class="d-none d-md-inline ms-2" data-v-29239cd3>Alles</span></a><a class="nav-link" data-bs-toggle="tab" data-bs-target="#chargepointlist" data-v-29239cd3><i class="fa-solid fa-lg fa-charging-station" data-v-29239cd3></i><span class="d-none d-md-inline ms-2" data-v-29239cd3>Ladepunkte</span></a>',2),ju={key:0,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#batterylist"},Uu=tt(()=>n("i",{class:"fa-solid fa-lg fa-car-battery"},null,-1)),zu=tt(()=>n("span",{class:"d-none d-md-inline ms-2"},"Speicher",-1)),Nu=[Uu,zu],Fu={key:1,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#smarthomelist"},qu=tt(()=>n("i",{class:"fa-solid fa-lg fa-plug"},null,-1)),Hu=tt(()=>n("span",{class:"d-none d-md-inline ms-2"},"Smart Home",-1)),Ru=[qu,Hu],Ju={key:4,id:"cpContent",class:"tab-content mx-0 pt-1"},Qu={id:"showAll",class:"tab-pane active",role:"tabpanel","aria-labelledby":"showall-tab"},Yu={class:"row py-0 m-0 d-flex justify-content-center"},Zu={id:"chargepointlist",class:"tab-pane",role:"tabpanel","aria-labelledby":"chargepoint-tab"},Xu={class:"row py-0 m-0 d-flex justify-content-center"},Ku={id:"batterylist",class:"tab-pane",role:"tabpanel","aria-labelledby":"battery-tab"},eh={class:"row py-0 m-0 d-flex justify-content-center"},th={id:"smarthomelist",class:"tab-pane",role:"tabpanel","aria-labelledby":"smarthome-tab"},ah={key:0,class:"row py-0 m-0 d-flex justify-content-center"},nh={class:"row p-2 mt-5"},oh={class:"col p-2"},sh=tt(()=>n("hr",null,null,-1)),rh={class:"d-flex justify-content-between"},lh={class:"mx-4"},ih={key:0},ch=I({__name:"ColorsTheme",setup(t){const e=g(()=>[A.evuOut,A.devices,A.charging].concat(Object.values(T).map(l=>l.toPowerItem())).concat(Object.values(N).filter(l=>l.configured&&l.showInGraph)).concat([A.batIn,A.house])),a=le(!1),s=g(()=>Object.values(N).filter(l=>l.configured).length>0);function o(){oa()}function r(){a.value=!a.value}return Ue(()=>{o(),window.addEventListener("resize",tn),qd()}),(l,c)=>(i(),h(D,null,[n("div",Ou,[n("div",Au,[m(Lu)]),m(Tc),y("",!0),(i(),h("div",Wu,[m(hd,null,{item1:b(()=>[m(Wn)]),item2:b(()=>[m(Fo)]),item3:b(()=>[m(ps,{"usage-details":e.value},null,8,["usage-details"])]),_:1})])),u(v).showQuickAccess?y("",!0):(i(),h("div",Du,[m(kt),m($t),s.value?(i(),B(St,{key:0})):y("",!0)])),u(v).showQuickAccess?(i(),h("nav",Eu,[Gu,u(re).isBatteryConfigured?(i(),h("a",ju,Nu)):y("",!0),s.value?(i(),h("a",Fu,Ru)):y("",!0)])):y("",!0),u(v).showQuickAccess?(i(),h("div",Ju,[n("div",Qu,[n("div",Yu,[m(kt),m($t),s.value?(i(),B(St,{key:0})):y("",!0),m(Nc)])]),n("div",Zu,[n("div",Xu,[m(kt)])]),n("div",Ku,[n("div",eh,[m($t)])]),n("div",th,[s.value?(i(),h("div",ah,[m(St)])):y("",!0)])])):y("",!0)]),n("div",nh,[n("div",oh,[sh,n("div",rh,[n("p",lh,"Screen Width: "+k(u(lt).x),1),n("button",{class:"btn btn-sm btn-secondary mx-4",onClick:r}," MQ Viewer ")]),a.value?(i(),h("hr",ih)):y("",!0),a.value?(i(),B(Mu,{key:1})):y("",!0)])])],64))}});const dh=E(ch,[["__scopeId","data-v-29239cd3"]]);const uh={},Pa=t=>(K("data-v-75865e45"),t=t(),ee(),t),hh=Pa(()=>n("nav",{class:"navbar navbar-expand-lg px-3 mb-0"},[n("div",{class:"container-lg"},[n("a",{href:"/",class:"navbar-brand"},[n("span",null,"openWB")]),n("button",{class:"navbar-toggler togglebutton ps-5",type:"button","data-bs-toggle":"collapse","data-bs-target":"#mainNavbar","aria-controls":"mainNavbar","aria-expanded":"false","aria-label":"Toggle navigation"},[n("span",{class:"fa-solid fa-ellipsis-vertical"})]),n("div",{id:"mainNavbar",class:"collapse navbar-collapse justify-content-end"},[n("div",{class:"nav navbar-nav"},[n("a",{id:"navStatus",class:"nav-link",href:"../../settings/#/Status",target:"_parent"},"Status"),n("div",{class:"nav-item dropdown"},[n("a",{id:"loggingDropdown",class:"nav-link",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[U("Auswertungen "),n("i",{class:"fa-solid fa-caret-down"})]),n("div",{class:"dropdown-menu","aria-labelledby":"loggingDropdown"},[n("a",{href:"../../settings/#/Logging/ChargeLog",class:"dropdown-item",target:"_parent"},"Ladeprotokoll"),n("a",{href:"../../settings/#/Logging/Chart",class:"dropdown-item",target:"_parent"},"Diagramme")])]),n("div",{class:"nav-item dropdown"},[n("a",{id:"settingsDropdown",class:"nav-link",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[U("Einstellungen "),n("span",{class:"fa-solid fa-caret-down"})]),n("div",{class:"dropdown-menu","aria-labelledby":"settingsDropdown"},[n("a",{id:"navSettings",class:"nav-link",href:"../../settings/index.html",target:"_parent"},"openWB"),n("a",{class:"nav-link","data-bs-toggle":"collapse","data-bs-target":"#themesettings","aria-expanded":"false","aria-controls":"themeSettings"},[n("span",null,[U("Look&Feel"),n("span",{class:"fa-solid fa-caret-down"})])])])])])])])],-1)),ph=Pa(()=>n("hr",{class:"m-0 p-0 mb-2"},null,-1));function gh(t,e){return i(),h(D,null,[hh,ph],64)}const mh=E(uh,[["render",gh],["__scopeId","data-v-75865e45"]]),fh={id:"app",class:"m-0 p-0"},vh={class:"container-lg p-0"},_h={class:"row p-0 m-0"},bh={class:"col-12 p-0 m-0"},yh=I({__name:"App",setup(t){return(e,a)=>(i(),h("div",fh,[m(mh),n("div",vh,[n("div",_h,[n("div",bh,[m(dh)])])])]))}});const wh=Ea(yh);Ga();wh.mount("#app");
